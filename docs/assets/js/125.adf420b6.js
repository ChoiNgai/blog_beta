(window.webpackJsonp=window.webpackJsonp||[]).push([[125],{500:function(_,v,t){"use strict";t.r(v);var r=t(30),s=Object(r.a)({},(function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h1",{attrs:{id:"基于-flink-的电商用户行为数据分析-【1】-项目整体介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基于-flink-的电商用户行为数据分析-【1】-项目整体介绍"}},[_._v("#")]),_._v(" 基于 flink 的电商用户行为数据分析：【1】 项目整体介绍")]),_._v(" "),t("h2",{attrs:{id:"前言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[_._v("#")]),_._v(" 前言")]),_._v(" "),t("p",[_._v("        愉悦的一周又要开始了，本周菌哥打算用几期文章为大家分享一个之前在B站自学的一个项目——"),t("strong",[_._v("基于flink的电商用户行为数据分析")]),_._v("。本期我们先对项目整体功能和模块做一个介绍。")]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("        正式介绍项目整体之前，我们来探讨一下批处理和流处理技术。")]),_._v(" "),t("h2",{attrs:{id:"批处理-vs-流处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#批处理-vs-流处理"}},[_._v("#")]),_._v(" 批处理 VS 流处理")]),_._v(" "),t("p",[_._v("        批处理和流处理代表了现在大数据处理领域两种完全不同的数据处理方式。")]),_._v(" "),t("p",[_._v('        下面两组分别列出的分别是批处理和流处理的"代表作"。')]),_._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020112220281914.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70#pic_center",alt:""}})]),_._v(" "),t("p",[_._v("左边Hadoop和Spark是“批处理”的代表作，其中Spark可以被认为是"),t("strong",[_._v("批处理")]),_._v("的“"),t("strong",[_._v("巅峰之作")]),_._v("”，已经非常成熟，并且社区也非常广泛，应用的领域也很多。")]),_._v(" "),t("p",[_._v("        右边Storm和Flink是“流处理”的代表作，其中Storm是流处理的“先锋”，但它本身有很多问题。Storm是首次真正意义上实现“流处理”，来一个数据就处理一个。但它随之带来的一个问题就是，在大数据应用场景下，"),t("strong",[_._v("吞吐量不够")]),_._v("。另外如果数据出现"),t("strong",[_._v("乱序")]),_._v("，Storm也处理不了。而Flink的引入，在Storm的基础上，完美的解决了着这两个问题。Flink可以说，是目前“流处理”的一个高峰！")]),_._v(" "),t("p",[_._v("        那具体“批处理”和“流处理”有哪些特点，我们来做一个对比：")]),_._v(" "),t("h3",{attrs:{id:"批处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#批处理"}},[_._v("#")]),_._v(" 批处理")]),_._v(" "),t("ul",[t("li",[_._v("批处理主要操作大容量静态数据集，并在计算过程完成后返回结果。可以认为，处理的是用一个固定时间间隔分组的数据点集合。批处理模式中使用的数据集通常符合下列特征：")])]),_._v(" "),t("p",[_._v("        --   "),t("strong",[_._v("有界")]),_._v("：批处理数据集代表数据的有限集合")]),_._v(" "),t("p",[_._v("        -- "),t("strong",[_._v("持久")]),_._v("：数据通常始终存储在某种类型的持久存储位置中")]),_._v(" "),t("p",[_._v("        -- "),t("strong",[_._v("大量")]),_._v("："),t("font",{attrs:{color:"gray"}},[t("strong",[_._v("批处理操作通常是处理极为海量数据集的唯一方法")])])],1),_._v(" "),t("p"),_._v(" "),t("h3",{attrs:{id:"流处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#流处理"}},[_._v("#")]),_._v(" 流处理")]),_._v(" "),t("ul",[t("li",[_._v("流处理可以对"),t("strong",[_._v("随时")]),_._v("进入系统的数据进行计算。流处理方式"),t("strong",[_._v("无需针对整个数据集执行操作")]),_._v("，而是对通过系统传输的每个数据项执行操作。流处理中的数据集是“"),t("strong",[_._v("无边界")]),_._v("”的，这就产生了几个重要的影响：")])]),_._v(" "),t("p",[_._v("        -- 可以处理"),t("strong",[_._v("几乎无限量")]),_._v("的数据，但"),t("strong",[_._v("同一时间只能处理一条数据")]),_._v("，不同记录间只维持"),t("strong",[_._v("最少量")]),_._v("的状态。")]),_._v(" "),t("p",[_._v("        -- 处理工作是基于"),t("strong",[_._v("事件")]),_._v("的，除非明确停止否则没有“尽头”。")]),_._v(" "),t("p",[_._v("        -- 处理结果"),t("strong",[_._v("立刻可用")]),_._v("，并会随着新数据的抵达"),t("strong",[_._v("继续更新")]),_._v("。")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201122210149257.png#pic_center",alt:""}})]),_._v(" "),t("p",[_._v("        很好，回顾了批处理和流处理的区别之后，我们直接进入项目的整体介绍！")]),_._v(" "),t("p"),_._v(" "),t("h2",{attrs:{id:"项目整体介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目整体介绍"}},[_._v("#")]),_._v(" 项目整体介绍")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201122184126235.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70#pic_center",alt:""}}),_._v("\n        \n        电商平台中的用户行为"),t("strong",[_._v("频繁且较复杂")]),_._v("，系统上线运行一段时间后，可以收集到大量的用户行为数据，进而利用"),t("font",{attrs:{color:" "}},[t("strong",[_._v("大数据技术进行深入挖掘和分析，得到感兴趣的商业指标并增强对风险的控制")])]),_._v("。")],1),_._v(" "),t("p",[_._v("        电商用户行为数据多样，整体可以分为"),t("strong",[_._v("用户行为习惯数据")]),_._v("和"),t("strong",[_._v("业务行为数据")]),_._v("两大类。用户的行为习惯数据包括了"),t("strong",[_._v("用户的登录方式")]),_._v("、"),t("strong",[_._v("上线的时间点及时长")]),_._v("、"),t("strong",[_._v("点击和浏览页面")]),_._v("、"),t("strong",[_._v("页面停留时间")]),_._v("以及"),t("strong",[_._v("页面跳转")]),_._v("等等，我们可以从中进行"),t("strong",[_._v("流量统计和热门商品")]),_._v("的统计，也可以"),t("strong",[_._v("深入挖掘用户")]),_._v("的特征；这些数据往往可以从web服务器日志中直接读取到。而"),t("strong",[_._v("业务行为数据")]),_._v("就是用户在电商平台中针对每个业务（通常是某个具体商品）所作的操作，我们一般会在业务系统中相应的位置"),t("strong",[_._v("埋点")]),_._v("，然后"),t("strong",[_._v("收集日志进行分析")]),_._v("。业务行为数据又可以简单分为两类：一类是能够明显地"),t("strong",[_._v("表现出用户兴趣的行为")]),_._v("，比如对商品的"),t("strong",[_._v("收藏")]),_._v("、"),t("strong",[_._v("喜欢")]),_._v("、"),t("strong",[_._v("评分")]),_._v("和"),t("strong",[_._v("评价")]),_._v("，我们可以从中对数据进行深入分析，得到"),t("strong",[_._v("用户画像")]),_._v("，进而对用户给出"),t("strong",[_._v("个性化的推荐商品列表")]),_._v("，这个过程往往会用到机器学习相关的算法；另一类则是"),t("strong",[_._v("常规的业务操作")]),_._v("，但需要着重关注一些"),t("strong",[_._v("异常状况以做好风控")]),_._v("，比如登录和订单支付。")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201122183400363.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70#pic_center",alt:""}})]),_._v(" "),t("h2",{attrs:{id:"项目主要模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目主要模块"}},[_._v("#")]),_._v(" 项目主要模块")]),_._v(" "),t("p",[_._v("        基于对电商用户行为数据的基本分类，我们可以发现主要有以下三个分析方向：")]),_._v(" "),t("p",[_._v("        1、热门统计")]),_._v(" "),t("p",[_._v("        利用用户的点击浏览行为，进行流量统计、近期热门商品统计等。")]),_._v(" "),t("p",[_._v("        2、偏好统计")]),_._v(" "),t("p",[_._v("        利用用户的偏好行为，比如收藏、喜欢、评分等，进行用户画像分析，给出个性化的商品推荐列表。")]),_._v(" "),t("p",[_._v("        3、风险控制")]),_._v(" "),t("p",[_._v("        利用用户的常规业务行为，比如登录、下单、支付等，分析数据，对异常情况进行报警提示。")]),_._v(" "),t("blockquote",[t("p",[_._v("总结：")]),_._v(" "),t("ul",[t("li",[_._v("统计分析\n-- 点击、浏览\n-- 热门商品、近期热门商品、分类热门商品、流量统计")]),_._v(" "),t("li",[_._v("统计分析\n-- 收藏、喜欢、评分、打标签\n-- 用户画像，推荐列表（结合特征工程和机器学习算法）")]),_._v(" "),t("li",[_._v("风险控制\n-- 下订单、支付、登录\n-- 刷单监控，订单失效监控，恶意登录（短时间内频繁登录失败）监控")])])]),_._v(" "),t("p",[_._v("        大的方面，我们可以将其分为"),t("strong",[_._v("实时统计分析")]),_._v("和"),t("strong",[_._v("业务流程及风险控制")]),_._v("领域")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201122185335960.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70#pic_center",alt:""}})]),_._v(" "),t("p",[_._v("        但本项目限于数据，我们只实现热门统计和风险控制中的部分内容，将包括以下四大模块："),t("strong",[_._v("实时热门商品统计")]),_._v("、"),t("strong",[_._v("实时流量统计")]),_._v("、"),t("strong",[_._v("恶意登录监控")]),_._v("和"),t("strong",[_._v("订单支付失效监控")]),_._v("。")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201122185549389.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70#pic_center",alt:""}})]),_._v(" "),t("p",[_._v("项目模块设计，可以参考这张图：")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201122210429439.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70#pic_center",alt:""}})]),_._v(" "),t("p",[_._v("由于对实时性要求较高，我们会用"),t("strong",[_._v("flink")]),_._v("作为数据处理的框架。在项目中，我们将综合运用"),t("strong",[_._v("flink的各种API")]),_._v("，基于"),t("strong",[_._v("EventTime")]),_._v("去处理基本的业务需求，并且灵活地使用底层的"),t("strong",[_._v("processFunction")]),_._v("，基于"),t("strong",[_._v("状态编程")]),_._v("和"),t("strong",[_._v("CEP")]),_._v("去处理更加复杂的情形。\n        ")]),_._v(" "),t("h2",{attrs:{id:"数据源解析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据源解析"}},[_._v("#")]),_._v(" 数据源解析")]),_._v(" "),t("p",[_._v("        我们准备了一份淘宝用户行为数据集，保存为csv文件。本数据集包含了淘宝上某一天随机一百万用户的所有行为（包括"),t("strong",[_._v("点击")]),_._v("、"),t("strong",[_._v("购买")]),_._v("、"),t("strong",[_._v("收藏")]),_._v("、"),t("strong",[_._v("喜欢")]),_._v("）。数据集的每一行表示一条用户行为，由"),t("strong",[_._v("用户ID")]),_._v("、"),t("strong",[_._v("商品ID")]),_._v("、"),t("strong",[_._v("商品类目ID")]),_._v("、"),t("strong",[_._v("行为类型")]),_._v("和"),t("strong",[_._v("时间戳")]),_._v("组成，并以逗号分隔。关于数据集中每一列的详细描述如下：")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("字段名")]),_._v(" "),t("th",[_._v("数据类型")]),_._v(" "),t("th",[_._v("说明")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("userId")]),_._v(" "),t("td",[_._v("Long")]),_._v(" "),t("td",[_._v("加密后的用户ID")])]),_._v(" "),t("tr",[t("td",[_._v("itemId")]),_._v(" "),t("td",[_._v("Long")]),_._v(" "),t("td",[_._v("加密后的商品ID")])]),_._v(" "),t("tr",[t("td",[_._v("categoryId")]),_._v(" "),t("td",[_._v("Int")]),_._v(" "),t("td",[_._v("加密后的商品所属类别ID")])]),_._v(" "),t("tr",[t("td",[_._v("behavior")]),_._v(" "),t("td",[_._v("String")]),_._v(" "),t("td",[_._v("用户行为类型，包括(‘pv’, ‘’buy, ‘cart’, ‘fav’)")])]),_._v(" "),t("tr",[t("td",[_._v("timestamp")]),_._v(" "),t("td",[_._v("Long")]),_._v(" "),t("td",[_._v("行为发生的时间戳，单位秒")])])])]),_._v(" "),t("p",[_._v("        另外，我们还可以拿到"),t("strong",[_._v("web服务器的日志数据")]),_._v("，这里以apache服务器的一份log为例，每一行日志记录了访问者的IP、userId、访问时间、访问方法以及访问的url，具体描述如下：")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("字段名")]),_._v(" "),t("th",[_._v("数据类型")]),_._v(" "),t("th",[_._v("说明")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("ip")]),_._v(" "),t("td",[_._v("String")]),_._v(" "),t("td",[_._v("访问的 IP")])]),_._v(" "),t("tr",[t("td",[_._v("userId")]),_._v(" "),t("td",[_._v("Long")]),_._v(" "),t("td",[_._v("访问的 user ID")])]),_._v(" "),t("tr",[t("td",[_._v("eventTime")]),_._v(" "),t("td",[_._v("|Long")]),_._v(" "),t("td",[_._v("访问时间")])]),_._v(" "),t("tr",[t("td",[_._v("method")]),_._v(" "),t("td",[_._v("String")]),_._v(" "),t("td",[_._v("访问方法 GET/POST/PUT/DELETE")])]),_._v(" "),t("tr",[t("td",[_._v("url")]),_._v(" "),t("td",[_._v("String")]),_._v(" "),t("td",[_._v("访问的 url")])])])]),_._v(" "),t("p",[_._v("        由于行为数据有限，在实时热门商品统计模块中可以使用UserBehavior数据集，而对于恶意登录监控和订单支付失效监控，我们只以示例数据来做演示。")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201122212822651.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70#pic_center",alt:""}})])])}),[],!1,null,null,null);v.default=s.exports}}]);