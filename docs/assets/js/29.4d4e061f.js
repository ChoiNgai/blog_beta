(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{421:function(s,t,a){"use strict";a.r(t);var e=a(30),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"hive底层原理-explain执行计划详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hive底层原理-explain执行计划详解"}},[s._v("#")]),s._v(" Hive底层原理：explain执行计划详解")]),s._v(" "),a("p",[a("strong",[s._v("导读：不懂hive中的explain，说明hive还没入门，学会explain，能够给我们工作中使用hive带来极大的便利！")])]),s._v(" "),a("h3",{attrs:{id:"理论"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#理论"}},[s._v("#")]),s._v(" 理论")]),s._v(" "),a("blockquote",[a("p",[s._v("本节将介绍 explain 的用法及参数介绍")])]),s._v(" "),a("p",[a("strong",[s._v("HIVE提供了EXPLAIN命令来展示一个查询的执行计划")]),s._v(",这个执行计划对于我们了解底层原理，hive 调优，排查数据倾斜等很有帮助")]),s._v(" "),a("p",[s._v("使用语法如下：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPLAIN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXTENDED")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("CBO"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("AST"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("DEPENDENCY"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AUTHORIZATION")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("LOCKS"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("VECTORIZATION"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ANALYZE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" query\n")])])]),a("p",[s._v("explain 后面可以跟以下可选参数，注意：这几个可选参数不是 hive 每个版本都支持的")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("EXTENDED")]),s._v("：加上 extended 可以输出有关计划的额外信息。这通常是物理信息，例如文件名。这些额外信息对我们用处不大")]),s._v(" "),a("li",[a("strong",[s._v("CBO")]),s._v("：输出由Calcite优化器生成的计划。CBO 从 hive 4.0.0 版本开始支持")]),s._v(" "),a("li",[a("strong",[s._v("AST")]),s._v("：输出查询的抽象语法树。AST 在hive 2.1.0 版本删除了，存在bug，转储AST可能会导致OOM错误，将在4.0.0版本修复")]),s._v(" "),a("li",[a("strong",[s._v("DEPENDENCY")]),s._v("：dependency在EXPLAIN语句中使用会产生有关计划中输入的额外信息。它显示了输入的各种属性")]),s._v(" "),a("li",[a("strong",[s._v("AUTHORIZATION")]),s._v("：显示所有的实体需要被授权执行（如果存在）的查询和授权失败")]),s._v(" "),a("li",[a("strong",[s._v("LOCKS")]),s._v("：这对于了解系统将获得哪些锁以运行指定的查询很有用。LOCKS 从 hive 3.2.0 开始支持")]),s._v(" "),a("li",[a("strong",[s._v("VECTORIZATION")]),s._v("：将详细信息添加到EXPLAIN输出中，以显示为什么未对Map和Reduce进行矢量化。从 Hive 2.3.0 开始支持")]),s._v(" "),a("li",[a("strong",[s._v("ANALYZE")]),s._v("：用实际的行数注释计划。从 Hive 2.2.0 开始支持")])]),s._v(" "),a("p",[s._v("在 hive cli 中输入以下命令(hive 2.3.7)：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("explain")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("得到结果（"),a("strong",[s._v("请逐行看完，即使看不懂也要每行都看")]),s._v("）：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("STAGE DEPENDENCIES:\n  Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("is")]),s._v(" a root stage\n  Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" depends "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" stages: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nSTAGE PLANS:\n  Stage: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    Map Reduce\n      Map Operator Tree:\n          TableScan\n            alias: test1\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v(" Operator\n              expressions: id "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              outputColumnNames: id\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Group")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("By")]),s._v(" Operator\n                aggregations: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mode")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("hash")]),s._v("\n                outputColumnNames: _col0\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                Reduce Output Operator\n                  sort "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(":\n                  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" expressions: _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bigint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      Reduce Operator Tree:\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Group")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("By")]),s._v(" Operator\n          aggregations: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sum")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_col0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mode")]),s._v(": mergepartial\n          outputColumnNames: _col0\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("File")]),s._v(" Output Operator\n            compressed: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(":\n                input format: org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hadoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mapred"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SequenceFileInputFormat\n                output format: org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hadoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("HiveSequenceFileOutputFormat\n                serde: org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hadoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("serde2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lazy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("LazySimpleSerDe\n\n  Stage: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Fetch")]),s._v(" Operator\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("limit")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n      Processor Tree:\n        ListSink\n")])])]),a("p",[s._v("看完以上内容有什么感受，是不是感觉都看不懂，不要着急，下面将会详细讲解每个参数，相信你学完下面的内容之后再看 explain 的查询结果将游刃有余。")]),s._v(" "),a("blockquote",[a("p",[a("strong",[s._v("一个HIVE查询被转换为一个由一个或多个stage组成的序列（有向无环图DAG）。这些stage可以是MapReduce stage，也可以是负责元数据存储的stage，也可以是负责文件系统的操作（比如移动和重命名）的stage")]),s._v("。")])]),s._v(" "),a("p",[s._v("我们将上述结果拆分看，先从最外层开始，包含两个大的部分：")]),s._v(" "),a("ol",[a("li",[s._v("stage dependencies： 各个stage之间的依赖性")]),s._v(" "),a("li",[s._v("stage plan： 各个stage的执行计划")])]),s._v(" "),a("p",[s._v("先看第一部分 stage dependencies ，包含两个 stage，Stage-1 是根stage，说明这是开始的stage，Stage-0 依赖 Stage-1，Stage-1执行完成后执行Stage-0。")]),s._v(" "),a("p",[s._v("再看第二部分 stage plan，里面有一个 Map Reduce，一个MR的执行计划分为两个部分：")]),s._v(" "),a("ol",[a("li",[s._v("Map Operator Tree： MAP端的执行计划树")]),s._v(" "),a("li",[s._v("Reduce Operator Tree： Reduce端的执行计划树")])]),s._v(" "),a("p",[s._v("这两个执行计划树里面包含这条sql语句的 operator：")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("map端第一个操作肯定是加载表，所以就是 "),a("strong",[s._v("TableScan 表扫描操作")]),s._v("，常见的属性：")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("alias： 表名称")]),s._v(" "),a("li",[s._v("Statistics： 表统计信息，包含表中数据条数，数据大小等")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("Select Operator： 选取操作")]),s._v("，常见的属性 ：")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("expressions：需要的字段名称及字段类型")]),s._v(" "),a("li",[s._v("outputColumnNames：输出的列名称")]),s._v(" "),a("li",[s._v("Statistics：表统计信息，包含表中数据条数，数据大小等")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("Group By Operator：分组聚合操作")]),s._v("，常见的属性：")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("aggregations：显示聚合函数信息")]),s._v(" "),a("li",[s._v("mode：聚合模式，值有 hash：随机聚合，就是hash partition；partial：局部聚合；final：最终聚合")]),s._v(" "),a("li",[s._v("keys：分组的字段，如果没有分组，则没有此字段")]),s._v(" "),a("li",[s._v("outputColumnNames：聚合之后输出列名")]),s._v(" "),a("li",[s._v("Statistics： 表统计信息，包含分组聚合之后的数据条数，数据大小等")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("Reduce Output Operator：输出到reduce操作")]),s._v("，常见属性：")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("sort order：值为空 不排序；值为 + 正序排序，值为 - 倒序排序；值为 +-  排序的列为两列，第一列为正序，第二列为倒序")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("Filter Operator：过滤操作")]),s._v("，常见的属性：")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("predicate：过滤条件，如sql语句中的where id>=1，则此处显示(id >= 1)")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("Map Join Operator：join 操作")]),s._v("，常见的属性：")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("condition map：join方式 ，如Inner Join 0 to 1 Left Outer Join0 to 2")]),s._v(" "),a("li",[s._v("keys: join 的条件字段")]),s._v(" "),a("li",[s._v("outputColumnNames： join 完成之后输出的字段")]),s._v(" "),a("li",[s._v("Statistics： join 完成之后生成的数据条数，大小等")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("File Output Operator：文件输出操作")]),s._v("，常见的属性")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("compressed：是否压缩")]),s._v(" "),a("li",[s._v("table：表的信息，包含输入输出文件格式化方式，序列化方式等")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("Fetch Operator 客户端获取数据操作")]),s._v("，常见的属性：")])]),s._v(" "),a("li",[a("ul",[a("li",[s._v("limit，值为 -1 表示不限制条数，其他值为限制的条数")])])])]),s._v(" "),a("p",[s._v("好，学到这里再翻到上面 explain 的查询结果，是不是感觉基本都能看懂了。")]),s._v(" "),a("h3",{attrs:{id:"实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实践"}},[s._v("#")]),s._v(" 实践")]),s._v(" "),a("blockquote",[a("p",[s._v("本节介绍 explain 能够为我们在生产实践中带来哪些便利及解决我们哪些迷惑")])]),s._v(" "),a("h4",{attrs:{id:"_1-join-语句会过滤-null-的值吗"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-join-语句会过滤-null-的值吗"}},[s._v("#")]),s._v(" 1. join 语句会过滤 null 的值吗？")]),s._v(" "),a("p",[s._v("现在，我们在hive cli 输入以下查询计划语句")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user_name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test1 a "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" test2 b "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("问："),a("strong",[s._v("上面这条 join 语句会过滤 id 为 null 的值吗")])]),s._v(" "),a("p",[s._v("执行下面语句：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("explain")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user_name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test1 a "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" test2 b "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("我们来看结果 (为了适应页面展示，仅截取了部分输出信息)：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("TableScan\n alias: a\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n Filter Operator\n    predicate: id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("is")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v(" Operator\n        expressions: id "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        outputColumnNames: _col0\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n        HashTable Sink Operator\n           "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keys")]),s._v(":\n             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n             "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])])]),a("p",[s._v("从上述结果可以看到 "),a("strong",[s._v("predicate: id is not null")]),s._v(" 这样一行，"),a("strong",[s._v("说明 join 时会自动过滤掉关联字段为 null 值的情况，但 left join 或 full join 是不会自动过滤的")]),s._v("，大家可以自行尝试下。")]),s._v(" "),a("h4",{attrs:{id:"_2-group-by-分组语句会进行排序吗"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-group-by-分组语句会进行排序吗"}},[s._v("#")]),s._v(" 2. group by 分组语句会进行排序吗？")]),s._v(" "),a("p",[s._v("看下面这条sql")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("group")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("问："),a("strong",[s._v("group by 分组语句会进行排序吗")])]),s._v(" "),a("p",[s._v("直接来看 explain 之后结果 (为了适应页面展示，仅截取了部分输出信息)")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v(" TableScan\n    alias: test1\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v(" Operator\n        expressions: id "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user_name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        outputColumnNames: id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user_name\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Group")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("By")]),s._v(" Operator\n           aggregations: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keys")]),s._v(": id "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mode")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("hash")]),s._v("\n           outputColumnNames: _col0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _col1\n           "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n           Reduce Output Operator\n             "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("key")]),s._v(" expressions: _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n             sort "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n             Map"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("reduce "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("partition")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("columns")]),s._v(": _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n             "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("108")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n             "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("value")]),s._v(" expressions: _col1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])])]),a("p",[s._v("我们看 Group By Operator，里面有 keys: id (type: int) 说明按照 id 进行分组的，再往下看还有 sort order: + ，"),a("strong",[s._v("说明是按照 id 字段进行正序排序的")]),s._v("。")]),s._v(" "),a("h4",{attrs:{id:"_3-哪条sql执行效率高呢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-哪条sql执行效率高呢"}},[s._v("#")]),s._v(" 3. 哪条sql执行效率高呢？")]),s._v(" "),a("p",[s._v("观察两条sql语句")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user_name\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    test1 a\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" test2 b "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user_name\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" test1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" a\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" test2 b "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[a("strong",[s._v("这两条sql语句输出的结果是一样的，但是哪条sql执行效率高呢")]),s._v("\n有人说第一条sql执行效率高，因为第二条sql有子查询，子查询会影响性能"),a("br"),s._v("\n有人说第二条sql执行效率高，因为先过滤之后，在进行join时的条数减少了，所以执行效率就高了")]),s._v(" "),a("p",[s._v("到底哪条sql效率高呢，我们直接在sql语句前面加上 explain，看下执行计划不就知道了嘛")]),s._v(" "),a("p",[s._v("在第一条sql语句前加上 explain，得到如下结果")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("hive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("explain")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user_name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test1 a "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" test2 b "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nOK\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Explain")]),s._v("\nSTAGE DEPENDENCIES:\n  Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("is")]),s._v(" a root stage\n  Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" depends "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" stages: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n  Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" depends "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" stages: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n\nSTAGE PLANS:\n  Stage: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n    Map Reduce "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Local")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Work")]),s._v("\n      Alias "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Map "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Local")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Tables")]),s._v(":\n        $hdt$_0:a\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Fetch")]),s._v(" Operator\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("limit")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n      Alias "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Map "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Local")]),s._v(" Operator Tree:\n        $hdt$_0:a\n          TableScan\n            alias: a\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n            Filter Operator\n              predicate: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v(" Operator\n                expressions: id "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                outputColumnNames: _col0\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                HashTable Sink Operator\n                  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keys")]),s._v(":\n                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  Stage: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n    Map Reduce\n      Map Operator Tree:\n          TableScan\n            alias: b\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n            Filter Operator\n              predicate: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v(" Operator\n                expressions: id "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user_name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                outputColumnNames: _col0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _col1\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                Map "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Join")]),s._v(" Operator\n                  condition map:\n                       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Inner")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Join")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n                  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keys")]),s._v(":\n                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                  outputColumnNames: _col0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _col2\n                  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v(" Operator\n                    expressions: _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _col2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                    outputColumnNames: _col0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _col1\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("File")]),s._v(" Output Operator\n                      compressed: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(":\n                          input format: org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hadoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mapred"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SequenceFileInputFormat\n                          output format: org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hadoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("HiveSequenceFileOutputFormat\n                          serde: org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hadoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("serde2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lazy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("LazySimpleSerDe\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Local")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Work")]),s._v(":\n        Map Reduce "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Local")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Work")]),s._v("\n\n  Stage: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Fetch")]),s._v(" Operator\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("limit")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n      Processor Tree:\n        ListSink\n")])])]),a("p",[s._v("在第二条sql语句前加上 explain，得到如下结果")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("hive "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("explain")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user_name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("  test1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("join")]),s._v(" test2 b "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nOK\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Explain")]),s._v("\nSTAGE DEPENDENCIES:\n  Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("is")]),s._v(" a root stage\n  Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" depends "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" stages: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n  Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" depends "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" stages: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n\nSTAGE PLANS:\n  Stage: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n    Map Reduce "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Local")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Work")]),s._v("\n      Alias "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Map "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Local")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Tables")]),s._v(":\n        $hdt$_0:test1\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Fetch")]),s._v(" Operator\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("limit")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n      Alias "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" Map "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Local")]),s._v(" Operator Tree:\n        $hdt$_0:test1\n          TableScan\n            alias: test1\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n            Filter Operator\n              predicate: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v(" Operator\n                expressions: id "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                outputColumnNames: _col0\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                HashTable Sink Operator\n                  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keys")]),s._v(":\n                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  Stage: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n    Map Reduce\n      Map Operator Tree:\n          TableScan\n            alias: b\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("75")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n            Filter Operator\n              predicate: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n              "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v(" Operator\n                expressions: id "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user_name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                outputColumnNames: _col0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _col1\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                Map "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Join")]),s._v(" Operator\n                  condition map:\n                       "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Inner")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Join")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n                  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keys")]),s._v(":\n                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                  outputColumnNames: _col0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _col2\n                  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v(" Operator\n                    expressions: _col0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _col2 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(": string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                    outputColumnNames: _col0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _col1\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("File")]),s._v(" Output Operator\n                      compressed: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Statistics")]),s._v(": Num "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rows")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Data")]),s._v(" size: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" Basic stats: COMPLETE "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Column")]),s._v(" stats: NONE\n                      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(":\n                          input format: org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hadoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mapred"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("SequenceFileInputFormat\n                          output format: org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hadoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("HiveSequenceFileOutputFormat\n                          serde: org"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hadoop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("serde2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lazy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("LazySimpleSerDe\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Local")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Work")]),s._v(":\n        Map Reduce "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Local")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Work")]),s._v("\n\n  Stage: Stage"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Fetch")]),s._v(" Operator\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("limit")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n      Processor Tree:\n        ListSink\n")])])]),a("p",[s._v("大家有什么发现，除了表别名不一样，其他的执行计划完全一样，都是先进行 where 条件过滤，在进行 join 条件关联。"),a("strong",[s._v("说明 hive 底层会自动帮我们进行优化，所以这两条sql语句执行效率是一样的")]),s._v("。")])])}),[],!1,null,null,null);t.default=n.exports}}]);