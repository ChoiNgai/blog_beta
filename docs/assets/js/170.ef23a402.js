(window.webpackJsonp=window.webpackJsonp||[]).push([[170],{538:function(a,t,s){"use strict";s.r(t);var r=s(30),e=Object(r.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("Â Â Â Â Â Â Â Â ä¹‹å‰åˆ†äº«è¿‡ä¸€ç¯‡åšå®¢ï¼ŒðŸ‘‰"),s("a",{attrs:{href:"https://alice.blog.csdn.net/article/details/106337941",target:"_blank",rel:"noopener noreferrer"}},[a._v("ä¸ä¼šè¿™20ä¸ªSparkçƒ­é—¨æŠ€æœ¯ç‚¹ï¼Œä½ æ•¢å‡ºåŽ»é¢è¯•å¤§æ•°æ®å—?"),s("OutboundLink")],1),a._v("ï¼Œé‚£ä¸€ç¯‡ç¡®å®žæ˜¯éžå¸¸ç²¾åŽï¼Œæç‚¼å‡ºäº†éžå¸¸é‡è¦åŒæ ·éžå¸¸é«˜é¢‘çš„SparkæŠ€æœ¯ç‚¹ï¼Œä¹Ÿç®—æ˜¯æ”¶åˆ°äº†ä¸€äº›æœ‹å‹ä»¬çš„å¥½è¯„ã€‚æœ¬ç¯‡åšå®¢ï¼Œåšä¸»æ‰“ç®—å†å‡ºä¸ªç•ªå¤–ç¯‡ï¼Œä¹Ÿå°±æ˜¯å†ä¸ºå¤§å®¶åˆ†äº«ä¸€äº›Sparké¢è¯•é¢˜ï¼Œæ•¢é—®å„ä½å‡†å¤‡å¥½äº†ä¹ˆ~")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200608220400797.jpg?",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})]),a._v(" "),s("hr"),a._v(" "),s("h2",{attrs:{id:"_1ã€spark-applicationåœ¨æ²¡æœ‰èŽ·å¾—è¶³å¤Ÿçš„èµ„æº-jobå°±å¼€å§‹æ‰§è¡Œäº†-å¯èƒ½ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜å‘ç”Ÿ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1ã€spark-applicationåœ¨æ²¡æœ‰èŽ·å¾—è¶³å¤Ÿçš„èµ„æº-jobå°±å¼€å§‹æ‰§è¡Œäº†-å¯èƒ½ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜å‘ç”Ÿ"}},[a._v("#")]),a._v(" 1ã€Spark Applicationåœ¨æ²¡æœ‰èŽ·å¾—è¶³å¤Ÿçš„èµ„æºï¼Œjobå°±å¼€å§‹æ‰§è¡Œäº†ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä»€ä¹ˆé—®é¢˜å‘ç”Ÿ?")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â æ‰§è¡Œè¯¥jobæ—¶å€™é›†ç¾¤èµ„æºä¸è¶³ï¼Œå¯¼è‡´æ‰§è¡Œjobç»“æŸä¹Ÿæ²¡æœ‰åˆ†é…è¶³å¤Ÿçš„èµ„æºï¼Œåˆ†é…äº†éƒ¨åˆ†Executorï¼Œè¯¥jobå°±å¼€å§‹æ‰§è¡Œtaskï¼Œåº”è¯¥æ˜¯taskçš„è°ƒåº¦çº¿ç¨‹å’ŒExecutorèµ„æºç”³è¯·æ˜¯å¼‚æ­¥çš„ï¼›å¦‚æžœæƒ³ç­‰å¾…ç”³è¯·å®Œæ‰€æœ‰çš„èµ„æºå†æ‰§è¡Œjobçš„ï¼šéœ€è¦å°†"),s("code",[a._v("spark.scheduler.maxRegisteredResourcesWaitingTime")]),a._v("è®¾ç½®çš„å¾ˆå¤§ï¼›"),s("code",[a._v("spark.scheduler.minRegisteredResourcesRatio")]),a._v(" è®¾ç½®ä¸º1ï¼Œä½†æ˜¯åº”è¯¥ç»“åˆå®žé™…è€ƒè™‘ï¼Œå¦åˆ™å¾ˆå®¹æ˜“å‡ºçŽ°é•¿æ—¶é—´åˆ†é…ä¸åˆ°èµ„æºï¼Œjobä¸€ç›´ä¸èƒ½è¿è¡Œçš„æƒ…å†µã€‚")]),a._v(" "),s("h2",{attrs:{id:"_2ã€driverçš„åŠŸèƒ½æ˜¯ä»€ä¹ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2ã€driverçš„åŠŸèƒ½æ˜¯ä»€ä¹ˆ"}},[a._v("#")]),a._v(" 2ã€driverçš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿ")]),a._v(" "),s("ul",[s("li",[a._v("ä¸€ä¸ªSparkä½œä¸šè¿è¡Œæ—¶åŒ…æ‹¬ä¸€ä¸ªDriverè¿›ç¨‹ï¼Œä¹Ÿæ˜¯ä½œä¸šçš„ä¸»è¿›ç¨‹ï¼Œå…·æœ‰mainå‡½æ•°ï¼Œå¹¶ä¸”æœ‰SparkContextçš„å®žä¾‹ï¼Œæ˜¯ç¨‹åºçš„äººå£ç‚¹ï¼›")]),a._v(" "),s("li",[a._v("åŠŸèƒ½ï¼šè´Ÿè´£å‘é›†ç¾¤"),s("strong",[a._v("ç”³è¯·èµ„æº")]),a._v("ï¼Œ"),s("strong",[a._v("å‘masteræ³¨å†Œä¿¡æ¯ï¼Œè´Ÿè´£äº†ä½œä¸šçš„è°ƒåº¦ï¼Œè´Ÿè´£ä½œä¸šçš„è§£æžã€ç”ŸæˆStageå¹¶è°ƒåº¦Task")]),a._v("åˆ°Executorä¸Šã€‚åŒ…æ‹¬DAGSchedulerï¼ŒTaskScheduler")])]),a._v(" "),s("h2",{attrs:{id:"_3ã€sparkä¸­workçš„ä¸»è¦å·¥ä½œæ˜¯ä»€ä¹ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3ã€sparkä¸­workçš„ä¸»è¦å·¥ä½œæ˜¯ä»€ä¹ˆ"}},[a._v("#")]),a._v(" 3ã€Sparkä¸­Workçš„ä¸»è¦å·¥ä½œæ˜¯ä»€ä¹ˆï¼Ÿ")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â ä¸»è¦åŠŸèƒ½ï¼šç®¡ç†å½“å‰èŠ‚ç‚¹å†…å­˜ï¼ŒCPUçš„ä½¿ç”¨çŠ¶å†µï¼ŒæŽ¥æ”¶masteråˆ†é…è¿‡æ¥çš„èµ„æºæŒ‡ä»¤ï¼Œé€šè¿‡ExecutorRunnerå¯åŠ¨ç¨‹åºåˆ†é…ä»»åŠ¡ã€‚")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â workerå°±ç±»ä¼¼äºŽåŒ…å·¥å¤´ï¼Œç®¡ç†åˆ†é…æ–°è¿›ç¨‹ï¼Œåšè®¡ç®—çš„æœåŠ¡ï¼Œç›¸å½“äºŽprocessæœåŠ¡ã€‚")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â éœ€è¦æ³¨æ„çš„æ˜¯ï¼š")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â 1ï¼‰workerä¼šä¸ä¼šæ±‡æŠ¥å½“å‰ä¿¡æ¯ç»™masterï¼Ÿ"),s("strong",[a._v("workerå¿ƒè·³ç»™masterä¸»è¦åªæœ‰workidï¼Œå®ƒä¸ä¼šå‘é€èµ„æºä¿¡æ¯ä»¥å¿ƒè·³çš„æ–¹å¼ç»™master")]),a._v("ï¼Œmasteråˆ†é…çš„æ—¶å€™å°±çŸ¥é“workï¼Œåªæœ‰å‡ºçŽ°æ•…éšœçš„æ—¶å€™æ‰ä¼šå‘é€èµ„æºã€‚")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â 2ï¼‰workerä¸ä¼šè¿è¡Œä»£ç ï¼Œå…·ä½“è¿è¡Œçš„æ˜¯Executoræ˜¯å¯ä»¥è¿è¡Œå…·ä½“appliactionå†™çš„ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œæ“ä½œä»£ç çš„èŠ‚ç‚¹ï¼Œå®ƒä¸ä¼šè¿è¡Œç¨‹åºçš„ä»£ç çš„ã€‚")]),a._v(" "),s("h2",{attrs:{id:"_4ã€sparkä¸ºä»€ä¹ˆæ¯”mapreduceå¿«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4ã€sparkä¸ºä»€ä¹ˆæ¯”mapreduceå¿«"}},[a._v("#")]),a._v(" 4ã€Sparkä¸ºä»€ä¹ˆæ¯”mapreduceå¿«ï¼Ÿ")]),a._v(" "),s("ol",[s("li",[a._v("sparkæ˜¯åŸºäºŽå†…å­˜è¿›è¡Œæ•°æ®å¤„ç†çš„ï¼ŒMapReduceæ˜¯åŸºäºŽç£ç›˜è¿›è¡Œæ•°æ®å¤„ç†çš„")]),a._v(" "),s("li",[a._v("sparkä¸­å…·æœ‰DAGæœ‰å‘æ— çŽ¯å›¾ï¼ŒDAGæœ‰å‘æ— çŽ¯å›¾åœ¨æ­¤è¿‡ç¨‹ä¸­å‡å°‘äº†shuffleä»¥åŠè½åœ°ç£ç›˜çš„æ¬¡æ•°")]),a._v(" "),s("li",[s("strong",[a._v("sparkæ˜¯ç²—ç²’åº¦èµ„æºç”³è¯·")]),a._v("ï¼Œä¹Ÿå°±æ˜¯å½“æäº¤spark applicationçš„æ—¶å€™ï¼Œapplicationä¼šå°†æ‰€æœ‰çš„èµ„æºç”³è¯·å®Œæ¯•ï¼Œå¦‚æžœç”³è¯·ä¸åˆ°èµ„æºå°±ç­‰å¾…ï¼Œå¦‚æžœç”³è¯·åˆ°èµ„æºæ‰æ‰§è¡Œapplicationï¼Œtaskåœ¨æ‰§è¡Œçš„æ—¶å€™å°±ä¸éœ€è¦è‡ªå·±åŽ»ç”³è¯·èµ„æºï¼Œtaskæ‰§è¡Œå¿«ï¼Œå½“æœ€åŽä¸€ä¸ªtaskæ‰§è¡Œå®Œä¹‹åŽtaskæ‰ä¼šè¢«é‡Šæ”¾ã€‚è€Œ"),s("strong",[a._v("MapReduceæ˜¯ç»†ç²’åº¦èµ„æºç”³è¯·")]),a._v("ï¼Œå½“æäº¤applicationçš„æ—¶å€™ï¼Œtaskæ‰§è¡Œæ—¶ï¼Œè‡ªå·±ç”³è¯·èµ„æºï¼Œè‡ªå·±é‡Šæ”¾èµ„æºï¼Œtaskæ‰§è¡Œå®Œæ¯•ä¹‹åŽï¼Œèµ„æºç«‹å³ä¼šè¢«é‡Šæ”¾ï¼Œtaskæ‰§è¡Œçš„æ…¢ï¼Œapplicationæ‰§è¡Œçš„ç›¸å¯¹æ¯”è¾ƒæ…¢ã€‚")])]),a._v(" "),s("h2",{attrs:{id:"_5ã€mapreduceå’Œsparkçš„éƒ½æ˜¯å¹¶è¡Œè®¡ç®—-é‚£ä¹ˆä»–ä»¬æœ‰ä»€ä¹ˆç›¸åŒå’ŒåŒºåˆ«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5ã€mapreduceå’Œsparkçš„éƒ½æ˜¯å¹¶è¡Œè®¡ç®—-é‚£ä¹ˆä»–ä»¬æœ‰ä»€ä¹ˆç›¸åŒå’ŒåŒºåˆ«"}},[a._v("#")]),a._v(" 5ã€Mapreduceå’ŒSparkçš„éƒ½æ˜¯å¹¶è¡Œè®¡ç®—ï¼Œé‚£ä¹ˆä»–ä»¬æœ‰ä»€ä¹ˆç›¸åŒå’ŒåŒºåˆ«ï¼Ÿ")]),a._v(" "),s("ul",[s("li",[a._v("hadoopçš„ä¸€ä¸ªä½œä¸šç§°ä¸ºjobï¼Œjobé‡Œé¢åˆ†ä¸ºmap taskå’Œreduce taskï¼Œæ¯ä¸ªtaskéƒ½æ˜¯åœ¨è‡ªå·±çš„è¿›ç¨‹ä¸­è¿è¡Œçš„ï¼Œå½“taskç»“æŸæ—¶ï¼Œè¿›ç¨‹ä¹Ÿä¼šç»“æŸã€‚")]),a._v(" "),s("li",[a._v("sparkç”¨æˆ·æäº¤çš„ä»»åŠ¡æˆä¸ºapplicationï¼Œä¸€ä¸ªapplicationå¯¹åº”ä¸€ä¸ªsparkcontextï¼Œappä¸­å­˜åœ¨å¤šä¸ªjobï¼Œæ¯è§¦å‘ä¸€æ¬¡actionæ“ä½œå°±ä¼šäº§ç”Ÿä¸€ä¸ªjobã€‚è¿™äº›jobå¯ä»¥å¹¶è¡Œæˆ–ä¸²è¡Œæ‰§è¡Œï¼Œæ¯ä¸ªjobä¸­æœ‰å¤šä¸ªstageï¼Œstageæ˜¯shuffleè¿‡ç¨‹ä¸­DAGSchaduleré€šè¿‡RDDä¹‹é—´çš„ä¾èµ–å…³ç³»åˆ’åˆ†jobè€Œæ¥çš„ï¼Œæ¯ä¸ªstageé‡Œé¢æœ‰å¤šä¸ªtaskï¼Œç»„æˆtasksetæœ‰TaskSchaduleråˆ†å‘åˆ°å„ä¸ªexecutorä¸­æ‰§è¡Œï¼Œexecutorçš„ç”Ÿå‘½å‘¨æœŸæ˜¯å’Œappä¸€æ ·çš„ï¼Œå³ä½¿æ²¡æœ‰jobè¿è¡Œä¹Ÿæ˜¯å­˜åœ¨çš„ï¼Œæ‰€ä»¥taskå¯ä»¥å¿«é€Ÿå¯åŠ¨è¯»å–å†…å­˜è¿›è¡Œè®¡ç®—ã€‚")]),a._v(" "),s("li",[a._v("hadoopçš„jobåªæœ‰mapå’Œreduceæ“ä½œï¼Œè¡¨è¾¾èƒ½åŠ›æ¯”è¾ƒæ¬ ç¼ºè€Œä¸”åœ¨mrè¿‡ç¨‹ä¸­ä¼šé‡å¤çš„è¯»å†™hdfsï¼Œ"),s("strong",[a._v("é€ æˆå¤§é‡çš„ioæ“ä½œï¼Œå¤šä¸ªjobéœ€è¦è‡ªå·±ç®¡ç†å…³ç³»")]),a._v("ã€‚ è€Œsparkçš„è¿­ä»£è®¡ç®—éƒ½æ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œçš„ï¼ŒAPIä¸­æä¾›äº†å¤§é‡çš„RDDæ“ä½œå¦‚joinï¼Œgroupbyç­‰ï¼Œè€Œä¸”"),s("strong",[a._v("é€šè¿‡DAGå›¾å¯ä»¥å®žçŽ°è‰¯å¥½çš„å®¹é”™")]),a._v("ã€‚")])]),a._v(" "),s("h2",{attrs:{id:"_6ã€sparkåº”ç”¨ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹æ˜¯ä»€ä¹ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6ã€sparkåº”ç”¨ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹æ˜¯ä»€ä¹ˆ"}},[a._v("#")]),a._v(" 6ã€Sparkåº”ç”¨ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ")]),a._v(" "),s("ol",[s("li",[a._v("æž„å»ºSpark Applicationçš„è¿è¡ŒçŽ¯å¢ƒï¼ˆå¯åŠ¨SparkContextï¼‰ï¼ŒSparkContextå‘èµ„æºç®¡ç†å™¨ï¼ˆå¯ä»¥æ˜¯Standaloneã€Mesosæˆ–YARNï¼‰æ³¨å†Œå¹¶ç”³è¯·è¿è¡ŒExecutorèµ„æºï¼›")]),a._v(" "),s("li",[a._v("èµ„æºç®¡ç†å™¨åˆ†é…Executorèµ„æºå¹¶å¯åŠ¨StandaloneExecutorBackendï¼ŒExecutorè¿è¡Œæƒ…å†µå°†éšç€å¿ƒè·³å‘é€åˆ°èµ„æºç®¡ç†å™¨ä¸Šï¼›")]),a._v(" "),s("li",[a._v("SparkContextæž„å»ºæˆDAGå›¾ï¼Œå°†DAGå›¾åˆ†è§£æˆStageï¼Œå¹¶æŠŠTasksetå‘é€ç»™Task Schedulerã€‚Executorå‘SparkContextç”³è¯·Taskï¼ŒTask Schedulerå°†Taskå‘æ”¾ç»™Executorè¿è¡ŒåŒæ—¶SparkContextå°†åº”ç”¨ç¨‹åºä»£ç å‘æ”¾ç»™Executorã€‚")]),a._v(" "),s("li",[a._v("Taskåœ¨Executorä¸Šè¿è¡Œï¼Œè¿è¡Œå®Œæ¯•é‡Šæ”¾æ‰€æœ‰èµ„æºã€‚")])]),a._v(" "),s("h2",{attrs:{id:"_7ã€spark-on-yarn-cluster-æ¨¡å¼ä¸‹-applicationmasterå’Œdriveræ˜¯åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¹ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7ã€spark-on-yarn-cluster-æ¨¡å¼ä¸‹-applicationmasterå’Œdriveræ˜¯åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¹ˆ"}},[a._v("#")]),a._v(" 7ã€spark on yarn Cluster æ¨¡å¼ä¸‹ï¼ŒApplicationMasterå’Œdriveræ˜¯åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¹ˆï¼Ÿ")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â æ˜¯,driver ä½äºŽApplicationMasterè¿›ç¨‹ä¸­ã€‚è¯¥è¿›ç¨‹è´Ÿè´£ç”³è¯·èµ„æºï¼Œè¿˜è´Ÿè´£ç›‘æŽ§ç¨‹åºã€èµ„æºçš„åŠ¨æ€æƒ…å†µã€‚")]),a._v(" "),s("h2",{attrs:{id:"_8ã€spark-on-yarn-æ¨¡å¼æœ‰å“ªäº›ä¼˜ç‚¹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8ã€spark-on-yarn-æ¨¡å¼æœ‰å“ªäº›ä¼˜ç‚¹"}},[a._v("#")]),a._v(" 8ã€Spark on Yarn æ¨¡å¼æœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿ")]),a._v(" "),s("ol",[s("li",[a._v("ä¸Žå…¶ä»–è®¡ç®—æ¡†æž¶å…±äº«é›†ç¾¤èµ„æºï¼ˆeg.Sparkæ¡†æž¶ä¸ŽMapReduceæ¡†æž¶åŒæ—¶è¿è¡Œï¼Œå¦‚æžœä¸ç”¨Yarnè¿›è¡Œèµ„æºåˆ†é…ï¼ŒMapReduceåˆ†åˆ°çš„å†…å­˜èµ„æºä¼šå¾ˆå°‘ï¼Œæ•ˆçŽ‡ä½Žä¸‹ï¼‰ï¼›èµ„æºæŒ‰éœ€åˆ†é…ï¼Œè¿›è€Œæé«˜é›†ç¾¤èµ„æºåˆ©ç”¨ç­‰ã€‚")]),a._v(" "),s("li",[a._v("ç›¸è¾ƒäºŽSparkè‡ªå¸¦çš„Standaloneæ¨¡å¼ï¼ŒYarnçš„èµ„æºåˆ†é…æ›´åŠ ç»†è‡´")]),a._v(" "),s("li",[a._v("Applicationéƒ¨ç½²ç®€åŒ–ï¼Œä¾‹å¦‚Sparkï¼ŒStormç­‰å¤šç§æ¡†æž¶çš„åº”ç”¨ç”±å®¢æˆ·ç«¯æäº¤åŽï¼Œç”±Yarnè´Ÿè´£èµ„æºçš„ç®¡ç†å’Œè°ƒåº¦ï¼Œåˆ©ç”¨Containerä½œä¸ºèµ„æºéš”ç¦»çš„å•ä½ï¼Œä»¥å®ƒä¸ºå•ä½åŽ»ä½¿ç”¨å†…å­˜,cpuç­‰ã€‚")]),a._v(" "),s("li",[a._v("Yarné€šè¿‡é˜Ÿåˆ—çš„æ–¹å¼ï¼Œç®¡ç†åŒæ—¶è¿è¡Œåœ¨Yarné›†ç¾¤ä¸­çš„å¤šä¸ªæœåŠ¡ï¼Œå¯æ ¹æ®ä¸åŒç±»åž‹çš„åº”ç”¨ç¨‹åºè´Ÿè½½æƒ…å†µï¼Œè°ƒæ•´å¯¹åº”çš„èµ„æºä½¿ç”¨é‡ï¼Œå®žçŽ°èµ„æºå¼¹æ€§ç®¡ç†ã€‚")])]),a._v(" "),s("h2",{attrs:{id:"_9ã€sparkä¸­çš„rddæ˜¯ä»€ä¹ˆ-æœ‰å“ªäº›ç‰¹æ€§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9ã€sparkä¸­çš„rddæ˜¯ä»€ä¹ˆ-æœ‰å“ªäº›ç‰¹æ€§"}},[a._v("#")]),a._v(" 9ã€sparkä¸­çš„RDDæ˜¯ä»€ä¹ˆï¼Œæœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â RDDï¼ˆResilient Distributed Datasetï¼‰å«åšåˆ†å¸ƒå¼æ•°æ®é›†ï¼Œæ˜¯sparkä¸­æœ€åŸºæœ¬çš„æ•°æ®æŠ½è±¡ï¼Œå®ƒä»£è¡¨ä¸€ä¸ªä¸å¯å˜ï¼Œå¯åˆ†åŒºï¼Œé‡Œé¢çš„å…ƒç´ å¯ä»¥å¹¶è¡Œè®¡ç®—çš„é›†åˆã€‚")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â äº”å¤§ç‰¹æ€§ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("A list of partitionsï¼šä¸€ä¸ªåˆ†åŒºåˆ—è¡¨ï¼ŒRDDä¸­çš„æ•°æ®éƒ½å­˜å‚¨åœ¨ä¸€ä¸ªåˆ†åŒºåˆ—è¡¨ä¸­")]),a._v(" "),s("li",[a._v("A function for computing each splitï¼šä½œç”¨åœ¨æ¯ä¸€ä¸ªåˆ†åŒºä¸­çš„å‡½æ•°")]),a._v(" "),s("li",[a._v("A list of dependencies on other RDDsï¼šä¸€ä¸ªRDDä¾èµ–äºŽå…¶ä»–å¤šä¸ªRDDï¼Œè¿™ä¸ªç‚¹å¾ˆé‡è¦ï¼ŒRDDçš„å®¹é”™æœºåˆ¶å°±æ˜¯ä¾æ®è¿™ä¸ªç‰¹æ€§è€Œæ¥çš„")]),a._v(" "),s("li",[a._v("Optionally,a Partitioner for key-value RDDs(eg:to say that the RDD is hash-partitioned)ï¼šå¯é€‰çš„ï¼Œé’ˆå¯¹äºŽkvç±»åž‹çš„RDDæ‰æœ‰è¿™ä¸ªç‰¹æ€§ï¼Œä½œç”¨æ˜¯å†³å®šäº†æ•°æ®çš„æ¥æºä»¥åŠæ•°æ®å¤„ç†åŽçš„åŽ»å‘")]),a._v(" "),s("li",[a._v("å¯é€‰é¡¹ï¼Œæ•°æ®æœ¬åœ°æ€§ï¼Œæ•°æ®ä½ç½®æœ€ä¼˜")])]),a._v(" "),s("h2",{attrs:{id:"_10ã€sparkå¦‚ä½•é˜²æ­¢å†…å­˜æº¢å‡º"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_10ã€sparkå¦‚ä½•é˜²æ­¢å†…å­˜æº¢å‡º"}},[a._v("#")]),a._v(" 10ã€sparkå¦‚ä½•é˜²æ­¢å†…å­˜æº¢å‡ºï¼Ÿ")]),a._v(" "),s("p",[s("strong",[a._v("driverç«¯çš„å†…å­˜æº¢å‡º ï¼š")])]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â å¯ä»¥å¢žå¤§driverçš„å†…å­˜å‚æ•°ï¼šspark.driver.memory (default 1g)")]),a._v(" "),s("p",[s("strong",[a._v("mapè¿‡ç¨‹äº§ç”Ÿå¤§é‡å¯¹è±¡å¯¼è‡´å†…å­˜æº¢å‡ºï¼š")])]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â å…·ä½“åšæ³•å¯ä»¥åœ¨ä¼šäº§ç”Ÿå¤§é‡å¯¹è±¡çš„mapæ“ä½œä¹‹å‰è°ƒç”¨repartitionæ–¹æ³•ï¼Œåˆ†åŒºæˆæ›´å°çš„å—ä¼ å…¥mapã€‚")]),a._v(" "),s("p",[s("strong",[a._v("æ•°æ®ä¸å¹³è¡¡å¯¼è‡´å†…å­˜æº¢å‡ºï¼š")])]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â æ•°æ®ä¸å¹³è¡¡é™¤äº†æœ‰å¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡ºå¤–ï¼Œä¹Ÿæœ‰å¯èƒ½å¯¼è‡´æ€§èƒ½çš„é—®é¢˜ï¼Œè§£å†³æ–¹æ³•å’Œä¸Šé¢è¯´çš„ç±»ä¼¼ï¼Œå°±æ˜¯è°ƒç”¨repartitioné‡æ–°åˆ†åŒºã€‚")]),a._v(" "),s("p",[s("strong",[a._v("shuffleåŽå†…å­˜æº¢å‡ºï¼š")])]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â shuffleå†…å­˜æº¢å‡ºçš„æƒ…å†µå¯ä»¥è¯´éƒ½æ˜¯shuffleåŽï¼Œå•ä¸ªæ–‡ä»¶è¿‡å¤§å¯¼è‡´çš„ã€‚åœ¨Sparkä¸­ï¼Œjoinï¼ŒreduceByKeyè¿™ä¸€ç±»åž‹çš„è¿‡ç¨‹ï¼Œéƒ½ä¼šæœ‰shuffleçš„è¿‡ç¨‹ï¼Œåœ¨shuffleçš„ä½¿ç”¨ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªpartitionerï¼Œå¤§éƒ¨åˆ†Sparkä¸­çš„shuffleæ“ä½œï¼Œé»˜è®¤çš„partitioneréƒ½æ˜¯HashPatitionerï¼Œé»˜è®¤å€¼æ˜¯çˆ¶RDDä¸­æœ€å¤§çš„åˆ†åŒºæ•°,è¿™ä¸ªå‚æ•°é€šè¿‡spark.default.parallelismæŽ§åˆ¶(åœ¨spark-sqlä¸­ç”¨spark.sql.shuffle.partitions) ï¼Œ spark.default.parallelismå‚æ•°åªå¯¹HashPartitioneræœ‰æ•ˆï¼Œæ‰€ä»¥å¦‚æžœæ˜¯åˆ«çš„Partitioneræˆ–è€…è‡ªå·±å®žçŽ°çš„Partitionerå°±ä¸èƒ½ä½¿ç”¨spark.default.parallelismè¿™ä¸ªå‚æ•°æ¥æŽ§åˆ¶shuffleçš„å¹¶å‘é‡äº†ã€‚å¦‚æžœæ˜¯åˆ«çš„partitionerå¯¼è‡´çš„shuffleå†…å­˜æº¢å‡ºï¼Œå°±éœ€è¦ä»Žpartitionerçš„ä»£ç å¢žåŠ partitionsçš„æ•°é‡ã€‚")]),a._v(" "),s("p",[s("strong",[a._v("standaloneæ¨¡å¼ä¸‹èµ„æºåˆ†é…ä¸å‡åŒ€å¯¼è‡´å†…å­˜æº¢å‡ºï¼š")])]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â è¿™ç§æƒ…å†µçš„è§£å†³æ–¹æ³•å°±æ˜¯åŒæ—¶é…ç½®â€“executor-coresæˆ–è€…spark.executor.coreså‚æ•°ï¼Œç¡®ä¿Executorèµ„æºåˆ†é…å‡åŒ€ã€‚ä½¿ç”¨rdd.persist(StorageLevel.MEMORY_AND_DISK_SER)ä»£æ›¿rdd.cache()ã€‚")]),a._v(" "),s("blockquote",[s("p",[s("font",{attrs:{color:"black"}},[s("strong",[a._v("rdd.cache")]),a._v("()å’Œ"),s("strong",[a._v("rdd.persist")]),a._v("(Storage.MEMORY_ONLY)æ˜¯ç­‰ä»·çš„ï¼Œåœ¨å†…å­˜ä¸è¶³çš„æ—¶å€™rdd.cache()çš„æ•°æ®ä¼šä¸¢å¤±ï¼Œå†æ¬¡ä½¿ç”¨çš„æ—¶å€™ä¼šé‡ç®—ï¼Œè€Œrdd.persist(StorageLevel.MEMORY_AND_DISK_SER)åœ¨å†…å­˜ä¸è¶³çš„æ—¶å€™ä¼šå­˜å‚¨åœ¨ç£ç›˜ï¼Œé¿å…é‡ç®—ï¼Œåªæ˜¯æ¶ˆè€—ç‚¹IOæ—¶é—´")])],1)]),a._v(" "),s("h2",{attrs:{id:"_11ã€sparkä¸­cacheå’Œpersistçš„åŒºåˆ«"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_11ã€sparkä¸­cacheå’Œpersistçš„åŒºåˆ«"}},[a._v("#")]),a._v(" 11ã€sparkä¸­cacheå’Œpersistçš„åŒºåˆ«ï¼Ÿ")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â cacheï¼šç¼“å­˜æ•°æ®ï¼Œé»˜è®¤æ˜¯ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå…¶æœ¬è´¨è¿˜æ˜¯è°ƒç”¨persistã€‚")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â persist:ç¼“å­˜æ•°æ®ï¼Œæœ‰ä¸°å¯Œçš„æ•°æ®ç¼“å­˜ç­–ç•¥ã€‚æ•°æ®å¯ä»¥ä¿å­˜åœ¨å†…å­˜ä¹Ÿå¯ä»¥ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œä½¿ç”¨çš„æ—¶å€™æŒ‡å®šå¯¹åº”çš„ç¼“å­˜çº§åˆ«å°±å¯ä»¥äº†ã€‚")]),a._v(" "),s("h2",{attrs:{id:"_12ã€sparkæ‰‹å†™wordcountç¨‹åº"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_12ã€sparkæ‰‹å†™wordcountç¨‹åº"}},[a._v("#")]),a._v(" 12ã€Sparkæ‰‹å†™WordCountç¨‹åº")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â è¿™ä¸ªå¸¸å‡ºçŽ°åœ¨ç¬”è¯•é˜¶æ®µï¼Œæ‰‹å†™WordCountç®—æ˜¯ä¸€é¡¹åŸºæœ¬æŠ€èƒ½ã€‚")]),a._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//åˆ›å»ºSparkConfå¹¶è®¾ç½®Appåç§°å’Œmasteråœ°å€")]),a._v("\nval conf"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("SparkConf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setAppName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("â€œwcâ€"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setMaster")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("â€œLocal"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("â€"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//åˆ›å»ºSparkContextï¼Œè¯¥å¯¹è±¡æ˜¯æäº¤Spark Appçš„å…¥å£")]),a._v("\nval sc"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("SparkContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//ä½¿ç”¨scåˆ›å»ºRDDå¹¶æ‰§è¡Œç›¸åº”çš„transformationå’Œaction")]),a._v("\nval result"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("textFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("â€œè¾“å…¥æ–‡ä»¶çš„è·¯å¾„â€"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nVal rdd2"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("flatmap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[a._v("x")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("split")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("â€œ â€"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("reduceBykey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("saveAsTextFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("â€œè¾“å‡ºæ–‡ä»¶è·¯å¾„â€"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//å…³é—­é“¾æŽ¥")]),a._v("\nsc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("stop")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("h2",{attrs:{id:"_13ã€sparkä¸­åˆ›å»ºrddçš„æ–¹å¼æ€»ç»“3ç§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_13ã€sparkä¸­åˆ›å»ºrddçš„æ–¹å¼æ€»ç»“3ç§"}},[a._v("#")]),a._v(" 13ã€Sparkä¸­åˆ›å»ºRDDçš„æ–¹å¼æ€»ç»“3ç§")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â 1ã€ä»Žé›†åˆä¸­åˆ›å»ºRDDï¼›")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("val rdd "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nval rdd "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("makeRDD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("p",[a._v("Â Â Â Â Â Â Â Â 2ã€ä»Žå¤–éƒ¨å­˜å‚¨åˆ›å»ºRDDï¼›")]),a._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("val rdd"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("textFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"hdfs://node01:8020/data/test"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("p",[a._v("Â Â Â Â Â Â Â Â 3ã€ä»Žå…¶ä»–RDDåˆ›å»ºã€‚")]),a._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("val rdd1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("parallelize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("Array")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nval rdd2 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("rdd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[a._v("x")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("h2",{attrs:{id:"_14ã€å¸¸ç”¨ç®—å­"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_14ã€å¸¸ç”¨ç®—å­"}},[a._v("#")]),a._v(" 14ã€å¸¸ç”¨ç®—å­")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â è¿™ä¸ªæ¶‰åŠåˆ°çš„ç®—å­å°±æ¯”è¾ƒå¤šäº†ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥åŽ»çœ‹çœ‹åšä¸»çš„è¿™ä¸¤ç¯‡åšå®¢:")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/weixin_44318830/article/details/104495531",target:"_blank",rel:"noopener noreferrer"}},[a._v("Sparkä¹‹ã€RDDç¼–ç¨‹ã€‘è¯¦ç»†è®²è§£(No2)â€”â€”ã€ŠTransformationè½¬æ¢ç®—å­ã€‹"),s("OutboundLink")],1)]),a._v(" "),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/weixin_44318830/article/details/104497091",target:"_blank",rel:"noopener noreferrer"}},[a._v("Sparkä¹‹ã€RDDç¼–ç¨‹ã€‘è¯¦ç»†è®²è§£(No3)â€”â€”ã€ŠActionè¡ŒåŠ¨ç®—å­ã€‹"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â ç»å¯¹ä¸ä¼šè®©ä½ å¤±æœ›çš„~")]),a._v(" "),s("h2",{attrs:{id:"_15ã€ä»€ä¹ˆæ˜¯å®½çª„ä¾èµ–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_15ã€ä»€ä¹ˆæ˜¯å®½çª„ä¾èµ–"}},[a._v("#")]),a._v(" 15ã€ä»€ä¹ˆæ˜¯å®½çª„ä¾èµ–")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â çª„ä¾èµ–æŒ‡çš„æ˜¯æ¯ä¸€ä¸ªçˆ¶RDDçš„Partitionæœ€å¤šè¢«å­RDDçš„ä¸€ä¸ªPartitionä½¿ç”¨ã€‚\nÂ Â Â Â Â Â Â Â å®½ä¾èµ–æŒ‡çš„æ˜¯å¤šä¸ªå­RDDçš„Partitionä¼šä¾èµ–åŒä¸€ä¸ªçˆ¶RDDçš„Partitionï¼Œä¼šå¼•èµ·shuffleã€‚")]),a._v(" "),s("h2",{attrs:{id:"_16ã€ä»»åŠ¡åˆ’åˆ†çš„å‡ ä¸ªé‡è¦è§’è‰²"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_16ã€ä»»åŠ¡åˆ’åˆ†çš„å‡ ä¸ªé‡è¦è§’è‰²"}},[a._v("#")]),a._v(" 16ã€ä»»åŠ¡åˆ’åˆ†çš„å‡ ä¸ªé‡è¦è§’è‰²")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â RDDä»»åŠ¡åˆ‡åˆ†ä¸­é—´åˆ†ä¸ºï¼šApplicationã€Jobã€Stageå’ŒTask")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â 1ï¼‰Applicationï¼šåˆå§‹åŒ–ä¸€ä¸ªSparkContextå³ç”Ÿæˆä¸€ä¸ªApplicationï¼›")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â 2ï¼‰Jobï¼šä¸€ä¸ªActionç®—å­å°±ä¼šç”Ÿæˆä¸€ä¸ªJobï¼›")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â 3ï¼‰Stageï¼šæ ¹æ®RDDä¹‹é—´çš„ä¾èµ–å…³ç³»çš„ä¸åŒå°†Jobåˆ’åˆ†æˆä¸åŒçš„Stageï¼Œé‡åˆ°ä¸€ä¸ªå®½ä¾èµ–åˆ™åˆ’åˆ†ä¸€ä¸ªStageï¼›")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â 4ï¼‰Taskï¼šStageæ˜¯ä¸€ä¸ªTaskSetï¼Œå°†Stageåˆ’åˆ†çš„ç»“æžœå‘é€åˆ°ä¸åŒçš„Executoræ‰§è¡Œå³ä¸ºä¸€ä¸ªTask")]),a._v(" "),s("h2",{attrs:{id:"_17ã€sparksqlä¸­rddã€dataframeã€datasetä¸‰è€…çš„åŒºåˆ«ä¸Žè”ç³»"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_17ã€sparksqlä¸­rddã€dataframeã€datasetä¸‰è€…çš„åŒºåˆ«ä¸Žè”ç³»"}},[a._v("#")]),a._v(" 17ã€SparkSQLä¸­RDDã€DataFrameã€DataSetä¸‰è€…çš„åŒºåˆ«ä¸Žè”ç³»?")]),a._v(" "),s("p",[s("font",{attrs:{color:"blue",size:"5"}},[s("strong",[a._v("RDD")])])],1),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼›ä¸å¯å˜ã€å¯åˆ†åŒºã€å…ƒç´ å¯ä»¥å¹¶è¡Œè®¡ç®—çš„é›†åˆã€‚")]),a._v(" "),s("p",[s("strong",[a._v("ä¼˜ç‚¹ï¼š")])]),a._v(" "),s("ul",[s("li",[a._v("RDDç¼–è¯‘æ—¶ç±»åž‹å®‰å…¨ï¼šç¼–è¯‘æ—¶èƒ½æ£€æŸ¥å‡ºç±»åž‹é”™è¯¯ï¼›")]),a._v(" "),s("li",[a._v("é¢å‘å¯¹è±¡çš„ç¼–ç¨‹é£Žæ ¼ï¼šç›´æŽ¥é€šè¿‡ç±»åç‚¹çš„æ–¹å¼æ“ä½œæ•°æ®ã€‚")])]),a._v(" "),s("p",[s("strong",[a._v("ç¼ºç‚¹ï¼š")])]),a._v(" "),s("ul",[s("li",[a._v("åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ€§èƒ½å¼€é”€å¾ˆå¤§ï¼Œå¤§é‡çš„ç½‘ç»œä¼ è¾“ï¼›")]),a._v(" "),s("li",[a._v("æž„å»ºå¯¹è±¡å ç”¨äº†å¤§é‡çš„heapå †å†…å­˜ï¼Œå¯¼è‡´é¢‘ç¹çš„GCï¼ˆç¨‹åºè¿›è¡ŒGCæ—¶ï¼Œæ‰€æœ‰ä»»åŠ¡éƒ½æ˜¯æš‚åœï¼‰")])]),a._v(" "),s("p",[s("font",{attrs:{color:"blue",size:"5"}},[s("strong",[a._v("DataFrame")])])],1),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â DataFrameä»¥RDDä¸ºåŸºç¡€çš„åˆ†å¸ƒå¼æ•°æ®é›†ã€‚")]),a._v(" "),s("p",[s("strong",[a._v("ä¼˜ç‚¹ï¼š")])]),a._v(" "),s("ul",[s("li",[a._v("DataFrameå¸¦æœ‰å…ƒæ•°æ®schemaï¼Œæ¯ä¸€åˆ—éƒ½å¸¦æœ‰åç§°å’Œç±»åž‹ã€‚")]),a._v(" "),s("li",[a._v("DataFrameå¼•å…¥äº†off-heapï¼Œæž„å»ºå¯¹è±¡ç›´æŽ¥ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„å†…å­˜ï¼Œä¸ä¼šå¯¼è‡´é¢‘ç¹GCã€‚")]),a._v(" "),s("li",[a._v("DataFrameå¯ä»¥ä»Žå¾ˆå¤šæ•°æ®æºæž„å»ºï¼›")]),a._v(" "),s("li",[a._v("DataFrameæŠŠå†…éƒ¨å…ƒç´ çœ‹æˆRowå¯¹è±¡ï¼Œè¡¨ç¤ºä¸€è¡Œè¡Œçš„æ•°æ®")]),a._v(" "),s("li",[a._v("DataFrame=RDD+schema")])]),a._v(" "),s("p",[s("strong",[a._v("ç¼ºç‚¹")]),a._v("ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("ç¼–è¯‘æ—¶ç±»åž‹ä¸å®‰å…¨ï¼›")]),a._v(" "),s("li",[a._v("ä¸å…·æœ‰é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é£Žæ ¼ã€‚")])]),a._v(" "),s("p",[s("font",{attrs:{color:"blue",size:"5"}},[s("strong",[a._v("Dataset")])])],1),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â DataSetåŒ…å«äº†DataFrameçš„åŠŸèƒ½ï¼ŒSpark2.0ä¸­ä¸¤è€…ç»Ÿä¸€ï¼ŒDataFrameè¡¨ç¤ºä¸ºDataSet[Row]ï¼Œå³DataSetçš„å­é›†ã€‚")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â ï¼ˆ1ï¼‰DataSetå¯ä»¥åœ¨ç¼–è¯‘æ—¶æ£€æŸ¥ç±»åž‹ï¼›")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â ï¼ˆ2ï¼‰å¹¶ä¸”æ˜¯é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æŽ¥å£ã€‚")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â ï¼ˆDataSet ç»“åˆäº† RDD å’Œ DataFrame çš„ä¼˜ç‚¹ï¼Œå¹¶å¸¦æ¥çš„ä¸€ä¸ªæ–°çš„æ¦‚å¿µ Encoderã€‚å½“åºåˆ—åŒ–æ•°æ®æ—¶ï¼ŒEncoder äº§ç”Ÿå­—èŠ‚ç ä¸Ž off-heap è¿›è¡Œäº¤äº’ï¼Œèƒ½å¤Ÿè¾¾åˆ°æŒ‰éœ€è®¿é—®æ•°æ®çš„æ•ˆæžœï¼Œè€Œä¸ç”¨ååºåˆ—åŒ–æ•´ä¸ªå¯¹è±¡ã€‚ï¼‰ã€‚")]),a._v(" "),s("p",[s("font",{attrs:{color:"blue",size:"5"}},[s("strong",[a._v("ä¸‰è€…ä¹‹é—´çš„è½¬æ¢ï¼š")])])],1),a._v(" "),s("p",[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200608231051390.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})]),a._v(" "),s("h2",{attrs:{id:"_18ã€è‡ªå®šä¹‰å‡½æ•°çš„è¿‡ç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_18ã€è‡ªå®šä¹‰å‡½æ•°çš„è¿‡ç¨‹"}},[a._v("#")]),a._v(" 18ã€è‡ªå®šä¹‰å‡½æ•°çš„è¿‡ç¨‹")]),a._v(" "),s("p",[a._v("Â Â Â Â Â Â Â Â 1ï¼‰åˆ›å»ºDataFrame")]),a._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("scala"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" val df "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" spark"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("read"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("json")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/export/spark/examples/people.json"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\ndf"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("spark"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("DataFrame "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("age"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" bigint"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" name"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])])]),s("p",[a._v("Â Â Â Â Â Â Â Â 2ï¼‰æ‰“å°æ•°æ®")]),a._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("scala"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("show")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" age"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("   name"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("null")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("Michael"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("   Andy"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("19")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" Justin"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n")])])]),s("p",[a._v("Â Â Â Â Â Â Â Â 3ï¼‰æ³¨å†ŒUDFï¼ŒåŠŸèƒ½ä¸ºåœ¨æ•°æ®å‰æ·»åŠ å­—ç¬¦ä¸²")]),a._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("scala"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" spark"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("udf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("register")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"addName"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[a._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=>")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Name:"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nres5"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("spark"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("expressions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("UserDefinedFunction "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("UserDefinedFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("function1"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("StringType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("Some")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("StringType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("p",[a._v("Â Â Â Â Â Â Â Â 4ï¼‰åˆ›å»ºä¸´æ—¶è¡¨")]),a._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("scala"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" df"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("createOrReplaceTempView")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"people"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("p",[a._v("Â Â Â Â Â Â Â Â 5ï¼‰åº”ç”¨UDF")]),a._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[a._v("scala"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" spark"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sql")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Select addName(name), age from people"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("show")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),s("span",{pre:!0,attrs:{class:"token constant"}},[a._v("UDF")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("addName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" age"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("     Name"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("Michael"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("null")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("        Name"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("Andy"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("      Name"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("Justin"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("19")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("\n")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);