(window.webpackJsonp=window.webpackJsonp||[]).push([[128],{503:function(t,s,a){"use strict";a.r(s);var n=a(30),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"åŸºäº-flink-çš„ç”µå•†ç”¨æˆ·è¡Œä¸ºæ•°æ®åˆ†æ-ã€4ã€‘æ¶æ„ç™»å½•ç›‘æ§"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŸºäº-flink-çš„ç”µå•†ç”¨æˆ·è¡Œä¸ºæ•°æ®åˆ†æ-ã€4ã€‘æ¶æ„ç™»å½•ç›‘æ§"}},[t._v("#")]),t._v(" åŸºäº flink çš„ç”µå•†ç”¨æˆ·è¡Œä¸ºæ•°æ®åˆ†æï¼šã€4ã€‘æ¶æ„ç™»å½•ç›‘æ§")]),t._v(" "),a("h2",{attrs:{id:"å‰è¨€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[t._v("#")]),t._v(" å‰è¨€")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â åœ¨ä¸Šä¸€æœŸå†…å®¹ä¸­ï¼ŒèŒå“¥å·²ç»ä¸ºå¤§å®¶ä»‹ç»äº†å®æ—¶çƒ­é—¨å•†å“ç»Ÿè®¡æ¨¡å—çš„åŠŸèƒ½å¼€å‘çš„è¿‡ç¨‹(ğŸ‘‰"),a("a",{attrs:{href:"https://alice.blog.csdn.net/article/details/110212749",target:"_blank",rel:"noopener noreferrer"}},[t._v("åŸºäºflinkçš„ç”µå•†ç”¨æˆ·è¡Œä¸ºæ•°æ®åˆ†æã€3ã€‘| å®æ—¶æµé‡ç»Ÿè®¡"),a("OutboundLink")],1),t._v("ï¼‰ã€‚æœ¬æœŸæ–‡ç« ï¼Œæˆ‘ä»¬éœ€è¦å­¦ä¹ çš„æ˜¯"),a("strong",[t._v("æ¶æ„ç™»å½•ç›‘æ§")]),t._v("æ¨¡å—åŠŸèƒ½çš„å¼€å‘è¿‡ç¨‹ã€‚")]),t._v(" "),a("h2",{attrs:{id:"æ¨¡å—åˆ›å»ºå’Œæ•°æ®å‡†å¤‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ¨¡å—åˆ›å»ºå’Œæ•°æ®å‡†å¤‡"}},[t._v("#")]),t._v(" æ¨¡å—åˆ›å»ºå’Œæ•°æ®å‡†å¤‡")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â ç»§ç»­åœ¨"),a("code",[t._v("UserBehaviorAnalysis")]),t._v("ä¸‹æ–°å»ºä¸€ä¸ª maven moduleä½œä¸ºå­é¡¹ç›®ï¼Œå‘½åä¸º"),a("code",[t._v("LoginFailDetect")]),t._v("ã€‚åœ¨è¿™ä¸ªå­æ¨¡å—ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šç”¨åˆ°flinkçš„"),a("code",[t._v("CEP")]),t._v("åº“æ¥å®ç°"),a("strong",[t._v("äº‹ä»¶æµçš„æ¨¡å¼åŒ¹é…")]),t._v("ï¼Œæ‰€ä»¥éœ€è¦åœ¨pomæ–‡ä»¶ä¸­å¼•å…¥CEPçš„ç›¸å…³ä¾èµ–ï¼š")]),t._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.flink"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("flink-cep-scala_${scala.binary.version}"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("${flink.version}"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("Â Â Â Â Â Â Â Â åŒæ ·ï¼Œåœ¨src/main/ç›®å½•ä¸‹ï¼Œå°†é»˜è®¤æºæ–‡ä»¶ç›®å½•javaæ”¹åä¸ºscalaã€‚")]),t._v(" "),a("p"),t._v(" "),a("h2",{attrs:{id:"ä»£ç å®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä»£ç å®ç°"}},[t._v("#")]),t._v(" ä»£ç å®ç°")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â å¯¹äºç½‘ç«™è€Œè¨€ï¼Œ"),a("strong",[t._v("ç”¨æˆ·ç™»å½•å¹¶ä¸æ˜¯é¢‘ç¹çš„ä¸šåŠ¡æ“ä½œ")]),t._v("ã€‚å¦‚æœä¸€ä¸ªç”¨æˆ·çŸ­æ—¶é—´å†…é¢‘ç¹ç™»å½•å¤±è´¥ï¼Œå°±æœ‰å¯èƒ½æ˜¯å‡ºç°äº†ç¨‹åºçš„æ¶æ„æ”»å‡»ï¼Œæ¯”å¦‚å¯†ç æš´åŠ›ç ´è§£ã€‚å› æ­¤æˆ‘ä»¬è€ƒè™‘ï¼Œåº”è¯¥å¯¹ç”¨æˆ·çš„ç™»å½•å¤±è´¥åŠ¨ä½œè¿›è¡Œç»Ÿè®¡ï¼Œå…·ä½“æ¥è¯´ï¼Œ"),a("strong",[t._v("å¦‚æœåŒä¸€ç”¨æˆ·ï¼ˆå¯ä»¥æ˜¯ä¸åŒIPï¼‰åœ¨2ç§’ä¹‹å†…è¿ç»­ä¸¤æ¬¡ç™»å½•å¤±è´¥ï¼Œå°±è®¤ä¸ºå­˜åœ¨æ¶æ„ç™»å½•çš„é£é™©ï¼Œè¾“å‡ºç›¸å…³çš„ä¿¡æ¯è¿›è¡ŒæŠ¥è­¦æç¤º")]),t._v("ã€‚è¿™æ˜¯ç”µå•†ç½‘ç«™ã€ä¹Ÿæ˜¯å‡ ä¹æ‰€æœ‰ç½‘ç«™"),a("strong",[t._v("é£æ§")]),t._v("çš„åŸºæœ¬ä¸€ç¯ã€‚")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ€è€ƒä¸€ä¸‹è§£å†³æ–¹æ¡ˆï¼š")]),t._v(" "),a("blockquote",[a("ul",[a("li",[a("p",[t._v("åŸºæœ¬éœ€æ±‚\n-- ç”¨æˆ·åœ¨çŸ­æ—¶é—´å†…é¢‘ç¹ç™»å½•å¤±è´¥ï¼Œæœ‰ç¨‹åºæ¶æ„æ”»å‡»çš„å¯èƒ½\n-- åŒä¸€ç”¨æˆ·ï¼ˆå¯ä»¥æ˜¯ä¸åŒIPï¼‰åœ¨2ç§’å†…è¿ç»­ä¸¤æ¬¡ç™»å½•å¤±è´¥ï¼Œéœ€è¦æŠ¥è­¦")])]),t._v(" "),a("li",[a("p",[t._v("è§£å†³æ€è·¯\n-- å°†ç”¨æˆ·çš„ç™»å½•å¤±è´¥è¡Œä¸ºå­˜å…¥ ListStateï¼Œè®¾å®šå®šæ—¶å™¨2ç§’åè§¦å‘ï¼ŒæŸ¥çœ‹ ListState ä¸­æœ‰å‡ æ¬¡å¤±è´¥ç™»å½•\n-- æ›´åŠ å‡†ç¡®çš„æ£€æµ‹ï¼Œå¯ä»¥ä½¿ç”¨ "),a("strong",[t._v("CEP")]),t._v(" åº“å®ç°äº‹ä»¶æµçš„"),a("strong",[t._v("æ¨¡å¼åŒ¹é…")])])])])]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â æ—¢ç„¶ç°åœ¨æ€è·¯æ¸…æ¥šäº†ï¼Œé‚£æˆ‘ä»¬å°±å°è¯•å°†æ–¹æ¡ˆè½åœ°ã€‚")]),t._v(" "),a("h2",{attrs:{id:"çŠ¶æ€ç¼–ç¨‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€ç¼–ç¨‹"}},[t._v("#")]),t._v(" çŠ¶æ€ç¼–ç¨‹")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â ç”±äºåŒæ ·å¼•å…¥äº†æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°ï¼Œæœ€ç®€å•çš„æ–¹æ³•å…¶å®ä¸ä¹‹å‰çš„çƒ­é—¨ç»Ÿè®¡ç±»ä¼¼ï¼Œåªéœ€è¦"),a("strong",[t._v("æŒ‰ç…§ç”¨æˆ·IDåˆ†æµ")]),t._v("ï¼Œç„¶åé‡åˆ°ç™»å½•å¤±è´¥çš„äº‹ä»¶æ—¶å°†å…¶ä¿å­˜åœ¨"),a("strong",[t._v("ListState")]),t._v("ä¸­ï¼Œç„¶å"),a("strong",[t._v("è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨")]),t._v("ï¼Œ2ç§’åè§¦å‘ã€‚å®šæ—¶å™¨è§¦å‘æ—¶"),a("strong",[t._v("æ£€æŸ¥çŠ¶æ€ä¸­çš„ç™»å½•å¤±è´¥äº‹ä»¶ä¸ªæ•°")]),t._v("ï¼Œå¦‚æœå¤§äºç­‰äº2ï¼Œé‚£ä¹ˆå°±"),a("strong",[t._v("è¾“å‡ºæŠ¥è­¦ä¿¡æ¯")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â åœ¨src/main/scalaä¸‹åˆ›å»º"),a("code",[t._v("LoginFail.scala")]),t._v("æ–‡ä»¶ï¼Œæ–°å»ºä¸€ä¸ªå•ä¾‹å¯¹è±¡ã€‚å®šä¹‰æ ·ä¾‹ç±»"),a("code",[t._v("LoginEvent")]),t._v("ï¼Œè¿™æ˜¯è¾“å…¥çš„ç™»å½•äº‹ä»¶æµã€‚ç™»å½•æ•°æ®æœ¬åº”è¯¥ä»UserBehavioræ—¥å¿—é‡Œæå–ï¼Œç”±äºUserBehavior.csvä¸­æ²¡æœ‰åšç›¸å…³åŸ‹ç‚¹ï¼Œæˆ‘ä»¬ä»å¦ä¸€ä¸ªæ–‡ä»¶"),a("code",[t._v("LoginLog.csv")]),t._v("ä¸­è¯»å–ç™»å½•æ•°æ®ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128154915810.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70",alt:"LoginLog.csv"}})]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("object")]),t._v(" LoginFailOne "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¾“å…¥çš„ç™»å½•äº‹ä»¶æ ·ä¾‹ç±»")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" userId"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ip"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("eventType"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("eventTime"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¾“å‡ºçš„æŠ¥è­¦ä¿¡æ¯æ ·ä¾‹ç±»")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" userId"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("firstFailTime"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lastFailTime"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("warningMsg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Unit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºæµç¯å¢ƒ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" env"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" StreamExecutionEnvironment "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" StreamExecutionEnvironment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getExecutionEnvironment\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®å¹¶è¡Œåº¦")]),t._v("\n    env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("setParallelism"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®æ—¶é—´ç‰¹å¾ä¸ºäº‹ä»¶æ—¶é—´")]),t._v("\n    env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("setStreamTimeCharacteristic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TimeCharacteristic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EventTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¯»å–csvæ–‡ä»¶")]),t._v("\n    env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readTextFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"G:\\\\LoginLog.csv"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å°†æ–‡ä»¶ä¸­çš„æ•°æ®å°è£…æˆæ ·ä¾‹ç±»")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" dataArray"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("toLong"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dataArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dataArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dataArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("toLong"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½® WaterMark æ°´å°")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("assignTimestampsAndWatermarks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" BoundedOutOfOrdernessTimestampExtractor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("seconds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" extractTimestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä»¥ç”¨æˆ·idä¸ºkeyï¼Œè¿›è¡Œåˆ†ç»„")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("keyBy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¡ç®—å‡ºåŒä¸€ä¸ªç”¨æˆ·2ç§’å†…è¿ç»­ç™»å½•å¤±è´¥è¶…è¿‡2æ¬¡çš„æŠ¥è­¦ä¿¡æ¯")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("process"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" LoginWarning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("print"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  æ‰§è¡Œç¨‹åº")]),t._v("\n    env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"login fail job"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è‡ªå®šä¹‰å¤„ç†å‡½æ•°ï¼Œä¿ç•™ä¸Šä¸€æ¬¡ç™»å½•å¤±è´¥çš„äº‹ä»¶ï¼Œå¹¶å¯ä»¥æ³¨å†Œå®šæ—¶å™¨    [é”®çš„ç±»å‹ï¼Œè¾“å…¥å…ƒç´ çš„ç±»å‹ï¼Œè¾“å‡ºå…ƒç´ çš„ç±»å‹]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" LoginWarning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("maxFailTimes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" KeyedProcessFunction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®šä¹‰  ä¿å­˜ç™»å½•å¤±è´¥äº‹ä»¶çš„çŠ¶æ€")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lazy")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" loginFailState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ListState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" getRuntimeContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getListState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" ListStateDescriptor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loginfail-state"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" classOf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" processElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ctx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" KeyedProcessFunction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("#Context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" out"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Collector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Unit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ¤æ–­å½“å‰ç™»å½•çŠ¶æ€æ˜¯å¦ä¸º fail")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventType "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fail"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ¤æ–­å­˜æ”¾å¤±è´¥äº‹ä»¶çš„stateæ˜¯å¦æœ‰å€¼ï¼Œæ²¡æœ‰å€¼åˆ™åˆ›å»ºä¸€ä¸ª2ç§’åçš„å®šæ—¶å™¨")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("loginFailState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hasNext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ³¨å†Œä¸€ä¸ªå®šæ—¶å™¨ï¼Œè®¾ç½®åœ¨ 2ç§’ ä¹‹å")]),t._v("\n          ctx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timerService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("registerEventTimeTimer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000L")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æŠŠæ–°çš„å¤±è´¥äº‹ä»¶æ·»åŠ åˆ°  state")]),t._v("\n        loginFailState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœç™»å½•æˆåŠŸï¼Œæ¸…ç©ºçŠ¶æ€é‡æ–°å¼€å§‹")]),t._v("\n        loginFailState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clear"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" onTimer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("timestamp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ctx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" KeyedProcessFunction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("#OnTimerContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" out"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Collector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Unit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è§¦å‘å®šæ—¶å™¨çš„æ—¶å€™ï¼Œæ ¹æ®çŠ¶æ€çš„å¤±è´¥ä¸ªæ•°å†³å®šæ˜¯å¦è¾“å‡ºæŠ¥è­¦")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" allLoginFailEvents"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ListBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" ListBuffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" iter"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" loginFailState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// éå†çŠ¶æ€ä¸­çš„æ•°æ®ï¼Œå°†æ•°æ®å­˜æ”¾è‡³ ListBuffer")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" iter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hasNext "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        allLoginFailEvents "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" iter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//åˆ¤æ–­ç™»å½•å¤±è´¥äº‹ä»¶ä¸ªæ•°ï¼Œå¦‚æœå¤§äºç­‰äº maxFailTimes ï¼Œè¾“å‡ºæŠ¥è­¦ä¿¡æ¯")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("allLoginFailEvents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" maxFailTimes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("collect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("allLoginFailEvents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          allLoginFailEvents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("head"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          allLoginFailEvents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("last"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"åœ¨2ç§’ä¹‹å†…è¿ç»­ç™»å½•å¤±è´¥"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" allLoginFailEvents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"æ¬¡"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¸…ç©ºçŠ¶æ€")]),t._v("\n      loginFailState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clear"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ç¨‹åºè¿è¡Œç»“æœï¼š\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128155457574.png",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}}),t._v("\næˆ‘ä»¬å¯ä»¥åˆ°"),a("code",[t._v("LoginLog.csv")]),t._v("æ¥éªŒè¯ç»“æœ")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128155618696.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70",alt:""}})]),t._v(" "),a("p",[t._v("è²Œä¼¼çœ‹åˆ°è¿™é‡Œæ„Ÿè§‰æˆ‘ä»¬çš„ç¨‹åºå†™çš„æ²¡æœ‰é”™ï¼Œäº‹å®çœŸçš„æ˜¯è¿™æ ·çš„å—ï¼Ÿ")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128155940179.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70#pic_center",alt:""}})]),t._v(" "),a("p",[t._v("é‚£å¥½ï¼Œç°åœ¨æˆ‘æ”¹ä¸€ä¸ªæ•°æ®ï¼ŒæŠŠ"),a("code",[t._v("1558430844")]),t._v("ç§’çš„ç™»å½•çŠ¶æ€æ”¹æˆ"),a("code",[t._v("success")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128160109499.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70",alt:""}})]),t._v(" "),a("p",[t._v("ç„¶åé‡æ–°è¿è¡Œä¸€ä¸‹ç¨‹åºï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020112816023894.png",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128160309863.png#pic_center",alt:""}})]),t._v(" "),a("p",[t._v("æˆ‘äº†ä¸ªä¹–ä¹–ï¼Œä»€ä¹ˆæƒ…å†µï¼Œç°åœ¨è¿ç»“æœéƒ½æ²¡äº†ï¼Ÿ")]),t._v(" "),a("p",[t._v("ä»”ç»†çœ‹ä»£ç ï¼Œæ‰å‘ç°æˆ‘ä»¬çš„æ€è·¯æ˜¯æ²¡é”™çš„ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ é€»è¾‘Bug !\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128160437197.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})]),t._v(" "),a("p",[t._v("ä¸ç®¡ä¸€ä¸ªç”¨æˆ·ä¹‹å‰è¿ç»­ç™»å½•å¤±è´¥å¤šå°‘æ¬¡ï¼Œåªè¦ä¸­é—´æˆåŠŸä¸€æ¬¡ï¼Œä¹‹å‰çš„è®°å½•å°±è¢«æ¸…ç©ºäº†ï¼")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020112816064128.png#pic_center",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})]),t._v(" "),a("h2",{attrs:{id:"çŠ¶æ€ç¼–ç¨‹çš„æ”¹è¿›"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#çŠ¶æ€ç¼–ç¨‹çš„æ”¹è¿›"}},[t._v("#")]),t._v(" çŠ¶æ€ç¼–ç¨‹çš„æ”¹è¿›")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â ä¸Šä¸€èŠ‚çš„ä»£ç å®ç°ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ"),a("strong",[t._v("ç›´æ¥æŠŠæ¯æ¬¡ç™»å½•å¤±è´¥çš„æ•°æ®å­˜èµ·æ¥ã€è®¾ç½®å®šæ—¶å™¨ä¸€æ®µæ—¶é—´åå†è¯»å–ï¼Œè¿™ç§åšæ³•å°½ç®¡ç®€å•ï¼Œä½†å’Œæˆ‘ä»¬å¼€å§‹çš„éœ€æ±‚è¿˜æ˜¯ç•¥æœ‰å·®å¼‚çš„")]),t._v("ã€‚è¿™ç§åšæ³•"),a("font",{attrs:{color:"Tomato"}},[a("strong",[t._v("åªèƒ½éš”2ç§’ä¹‹åå»åˆ¤æ–­ä¸€ä¸‹è¿™æœŸé—´æ˜¯å¦æœ‰å¤šæ¬¡å¤±è´¥ç™»å½•ï¼Œè€Œä¸æ˜¯åœ¨ä¸€æ¬¡ç™»å½•å¤±è´¥ä¹‹åã€å†ä¸€æ¬¡ç™»å½•å¤±è´¥æ—¶å°±ç«‹åˆ»æŠ¥è­¦")])]),t._v("ã€‚è¿™ä¸ªéœ€æ±‚å¦‚æœä¸¥æ ¼å®ç°èµ·æ¥ï¼Œç›¸å½“äºè¦åˆ¤æ–­ä»»æ„ç´§é‚»çš„äº‹ä»¶ï¼Œæ˜¯å¦ç¬¦åˆæŸç§æ¨¡å¼ã€‚")],1),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â äºæ˜¯æˆ‘ä»¬å¯ä»¥æƒ³åˆ°ï¼Œè¿™ä¸ªéœ€æ±‚å…¶å®å¯ä»¥ä¸ç”¨å®šæ—¶å™¨è§¦å‘ï¼Œç›´æ¥åœ¨çŠ¶æ€ä¸­å­˜å–ä¸Šä¸€æ¬¡ç™»å½•å¤±è´¥çš„äº‹ä»¶ï¼Œæ¯æ¬¡éƒ½åšåˆ¤æ–­å’Œæ¯”å¯¹ï¼Œå°±å¯ä»¥å®ç°æœ€åˆçš„éœ€æ±‚ã€‚")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â ä¸ŠèŠ‚çš„ä»£ç MatchFunctionä¸­åˆ æ‰onTimerï¼ŒprocessElementæ”¹ä¸ºï¼š")]),t._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è‡ªå®šä¹‰å¤„ç†å‡½æ•°ï¼Œä¿ç•™ä¸Šä¸€æ¬¡ç™»å½•å¤±è´¥çš„äº‹ä»¶    [é”®çš„ç±»å‹ï¼Œè¾“å…¥å…ƒç´ çš„ç±»å‹ï¼Œè¾“å‡ºå…ƒç´ çš„ç±»å‹]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" LoginWarning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("maxFailTimes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" KeyedProcessFunction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®šä¹‰  ä¿å­˜ç™»å½•å¤±è´¥äº‹ä»¶çš„çŠ¶æ€")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lazy")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" loginFailState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ListState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" getRuntimeContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getListState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" ListStateDescriptor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"loginfail-state"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" classOf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" processElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ctx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" KeyedProcessFunction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("#Context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" out"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Collector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Unit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é¦–å…ˆæŒ‰ç…§typeåšç­›é€‰ï¼Œå¦‚æœsuccessç›´æ¥æ¸…ç©ºï¼Œå¦‚æœfailå†åšå¤„ç†")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventType "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fail"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å…ˆè·å–ä¹‹å‰å¤±è´¥çš„äº‹ä»¶")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" iter"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" loginFailState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("iter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hasNext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœä¹‹å‰å·²ç»æœ‰å¤±è´¥çš„äº‹ä»¶ï¼Œå°±åšåˆ¤æ–­ï¼Œå¦‚æœæ²¡æœ‰å°±æŠŠå½“å‰å¤±è´¥äº‹ä»¶ä¿å­˜è¿›state")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" firstFailEvent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" LoginEvent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" iter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ¤æ–­ä¸¤æ¬¡å¤±è´¥äº‹ä»¶é—´éš”å°äº2ç§’ï¼Œè¾“å‡ºæŠ¥è­¦ä¿¡æ¯")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" firstFailEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("collect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("firstFailEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"åœ¨2ç§’å†…è¿ç»­ä¸¤æ¬¡ç™»å½•å¤±è´¥ã€‚"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ›´æ–°æœ€è¿‘ä¸€æ¬¡çš„ç™»å½•å¤±è´¥äº‹ä»¶ï¼Œä¿å­˜åœ¨çŠ¶æ€é‡Œ")]),t._v("\n          loginFailState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clear"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n          loginFailState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ç™»å½•å¤±è´¥ï¼Œä¹‹å‰æŠŠå½“å‰è®°å½• ä¿å­˜è‡³ state")]),t._v("\n          loginFailState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("add"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“å‰ç™»å½•çŠ¶æ€ ä¸ä¸º failï¼Œåˆ™ç›´æ¥æ¸…é™¤çŠ¶æ€")]),t._v("\n        loginFailState"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clear"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("è¿™æ¬¡æˆ‘ä»¬åŸºäºä¸Šè¿°å·²ç»ä¿®æ”¹è¿‡çš„"),a("code",[t._v("LoginLog.csv")]),t._v("æ–‡ä»¶ï¼Œé‡æ–°è¿è¡Œç¨‹åºï¼Œå‘ç°æ­¤æ—¶æ˜¯æœ‰ç»“æœçš„ã€‚\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128162727206.png",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}}),t._v("\né‚£ç°åœ¨çš„ç¨‹åºè¿˜ä¼šæœ‰Bugå—ï¼Ÿ")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128163330923.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70#pic_center",alt:""}})]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â å½“ç„¶è¿˜æœ‰ä¼šï¼Œä¾‹å¦‚æˆ‘ä»¬å»æ‰äº†å®šæ—¶å™¨ï¼Œå¦‚æœè¿è¡Œè¿‡ç¨‹ä¸­"),a("strong",[t._v("æ•°æ®å¤„ç†ä¹±åº")]),t._v("ï¼ŒåŒä¸€ä¸ªç”¨æˆ·æ¯æ¬¡ç™»å½•å¤±è´¥çš„æ—¶é—´ç›¸å·®è·ç¦»è¿‡å¤§ï¼Œå¯èƒ½å¾ˆé•¿ä¸€æ®µæ—¶é—´éƒ½ä¸ä¼šæœ‰è¯¥ç”¨æˆ·çš„æŠ¥è­¦ä¿¡æ¯ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å…¶ä»–çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ”¾åœ¨ä¸‹é¢ä¸€å°èŠ‚æ¥è¯´ï¼")]),t._v(" "),a("h2",{attrs:{id:"cepç¼–ç¨‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cepç¼–ç¨‹"}},[t._v("#")]),t._v(" CEPç¼–ç¨‹")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â ä¸Šä¸€èŠ‚æˆ‘ä»¬é€šè¿‡å¯¹çŠ¶æ€ç¼–ç¨‹çš„æ”¹è¿›ï¼Œå»æ‰äº†å®šæ—¶å™¨ï¼Œåœ¨process functionä¸­åšäº†æ›´å¤šçš„é€»è¾‘å¤„ç†ï¼Œå®ç°äº†æœ€åˆçš„éœ€æ±‚ã€‚ä¸è¿‡è¿™ç§æ–¹æ³•é‡Œæœ‰å¾ˆå¤šçš„æ¡ä»¶åˆ¤æ–­ï¼Œè€Œæˆ‘ä»¬ç›®å‰ä»…ä»…å®ç°çš„æ˜¯æ£€æµ‹â€œ"),a("strong",[t._v("è¿ç»­2æ¬¡ç™»å½•å¤±è´¥")]),t._v("â€ï¼Œè¿™æ˜¯æœ€ç®€å•çš„æƒ…å½¢ã€‚å¦‚æœéœ€è¦æ£€æµ‹æ›´å¤šæ¬¡ï¼Œ"),a("strong",[t._v("å†…éƒ¨é€»è¾‘æ˜¾ç„¶ä¼šå˜å¾—éå¸¸å¤æ‚")]),t._v("ã€‚é‚£æœ‰ä»€ä¹ˆæ–¹å¼å¯ä»¥æ–¹ä¾¿åœ°å®ç°å‘¢ï¼Ÿ")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â å¾ˆå¹¸è¿ï¼Œflinkä¸ºæˆ‘ä»¬æä¾›äº†"),a("strong",[t._v("CEP")]),a("code",[t._v("ï¼ˆComplex Event Processingï¼Œå¤æ‚äº‹ä»¶å¤„ç†ï¼‰")]),t._v("åº“ï¼Œç”¨äº"),a("strong",[t._v("åœ¨æµä¸­ç­›é€‰ç¬¦åˆæŸç§å¤æ‚æ¨¡å¼çš„äº‹ä»¶")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â ä¸ºäº†æ‹…å¿ƒå°ä¼™ä¼´ä»¬å¯¹äº "),a("strong",[t._v("CEP")]),t._v("  è¿™ä¸ª â€œæ–°äº‹ç‰©â€æ„Ÿåˆ°é™Œç”Ÿï¼Œæˆ‘ä»¬å…ˆæ¥è¡¥ä¸€è¡¥"),a("code",[t._v("CEP")]),t._v("çš„å†…å®¹ï¼")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128165340132.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70#pic_center",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})]),t._v(" "),a("h3",{attrs:{id:"ä»€ä¹ˆæ˜¯å¤æ‚äº‹ä»¶å¤„ç†cep"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯å¤æ‚äº‹ä»¶å¤„ç†cep"}},[t._v("#")]),t._v(" ä»€ä¹ˆæ˜¯å¤æ‚äº‹ä»¶å¤„ç†CEP")]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("å¤æ‚äº‹ä»¶å¤„ç†ï¼ˆComplex Event Processingï¼ŒCEPï¼‰")]),t._v(" "),a("li",[t._v("Flink CEPæ˜¯åœ¨ Flink ä¸­å®ç°çš„å¤æ‚äº‹ä»¶å¤„ç†ï¼ˆCEPï¼‰åº“")]),t._v(" "),a("li",[t._v("CEP å…è®¸"),a("strong",[t._v("åœ¨æ— ä¼‘æ­¢çš„äº‹ä»¶æµä¸­æ£€æµ‹äº‹ä»¶æ¨¡å¼ï¼Œè®©æˆ‘ä»¬æœ‰æœºä¼šæŒæ¡æ•°æ®ä¸­é‡è¦çš„éƒ¨åˆ†")])]),t._v(" "),a("li",[t._v("ä¸€ä¸ªæˆ–å¤šä¸ªç”±ç®€å•äº‹ä»¶æ„æˆçš„äº‹ä»¶æµé€šè¿‡ä¸€å®šçš„è§„åˆ™åŒ¹é…ï¼Œç„¶åè¾“å‡ºç”¨æˆ·æƒ³å¾—åˆ°çš„æ•°æ® â€”â€” æ»¡è¶³è§„åˆ™çš„å¤æ‚äº‹ä»¶")])])]),t._v(" "),a("h3",{attrs:{id:"cepç‰¹ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cepç‰¹ç‚¹"}},[t._v("#")]),t._v(" CEPç‰¹ç‚¹")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â å¦‚æœæˆ‘ä»¬æƒ³ä»ä¸€å †å›¾å½¢ä¸­æ‰¾åˆ°ç¬¦åˆé¢„æœŸçš„ç»“æœï¼Œå°±å¯ä»¥æ ¹æ®æŸä¸ªè§„åˆ™å»è¿›è¡ŒåŒ¹é…ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128170043245.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70",alt:""}})]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("ç›®æ ‡ï¼šä»æœ‰åºçš„ç®€å•äº‹ä»¶æµä¸­å‘ç°ä¸€äº›é«˜é˜¶ç‰¹å¾")]),t._v(" "),a("li",[t._v("è¾“å…¥ï¼šä¸€ä¸ªæˆ–å¤šä¸ªç”±ç®€å•äº‹ä»¶æ„æˆçš„äº‹ä»¶æµ")]),t._v(" "),a("li",[t._v("å¤„ç†ï¼šè¯†åˆ«ç®€å•äº‹ä»¶ä¹‹é—´çš„å†…åœ¨è”ç³»ï¼Œå¤šä¸ªç¬¦åˆä¸€å®šè§„åˆ™çš„ç®€å•äº‹ä»¶æ„æˆå¤æ‚äº‹ä»¶")]),t._v(" "),a("li",[t._v("è¾“å‡ºï¼šæ»¡è¶³è§„åˆ™çš„å¤æ‚äº‹ä»¶")])])]),t._v(" "),a("h3",{attrs:{id:"pattern-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pattern-api"}},[t._v("#")]),t._v(" Pattern API")]),t._v(" "),a("blockquote",[a("ul",[a("li",[a("strong",[t._v("å¤„ç†äº‹ä»¶çš„è§„åˆ™ï¼Œè¢«å«åšâ€œæ¨¡å¼â€ï¼ˆPatternï¼‰")])]),t._v(" "),a("li",[a("strong",[t._v("Flink CEP æä¾›äº† Pattern APIï¼Œç”¨äºå¯¹è¾“å…¥æµæ•°æ®è¿›è¡Œå¤æ‚äº‹ä»¶è§„åˆ™å®šä¹‰ï¼Œç”¨æ¥æå–ç¬¦åˆè§„åˆ™çš„äº‹ä»¶åºåˆ—")]),t._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128171319466.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})]),t._v(" "),a("li",[a("strong",[t._v("ä¸ªä½“æ¨¡å¼ï¼ˆIndividual Patternsï¼‰")]),t._v("\n-- ç»„æˆå¤æ‚è§„åˆ™çš„æ¯ä¸€ä¸ªå•ç‹¬çš„æ¨¡å¼å®šä¹‰ï¼Œå°±æ˜¯â€œä¸ªä½“æ¨¡å¼â€\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128171015161.png",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})]),t._v(" "),a("li",[a("strong",[t._v("ç»„åˆæ¨¡å¼ï¼ˆCombining Patternsï¼Œä¹Ÿå«æ¨¡å¼åºåˆ—ï¼‰")]),t._v("\n-- å¾ˆå¤šä¸ªä½“æ¨¡å¼ç»„åˆèµ·æ¥ï¼Œå°±å½¢æˆäº†æ•´ä¸ªçš„æ¨¡å¼åºåˆ—\n-- æ¨¡å¼åºåˆ—å¿…é¡»ä»¥ä¸€ä¸ªâ€œåˆå§‹æ¨¡å¼â€å¼€å§‹ï¼š\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128171230259.png",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})]),t._v(" "),a("li",[a("strong",[t._v("æ¨¡å¼ç»„ï¼ˆGroups of patternsï¼‰")]),t._v("\n-- å°†ä¸€ä¸ªæ¨¡å¼åºåˆ—ä½œä¸ºæ¡ä»¶åµŒå¥—åœ¨ä¸ªä½“æ¨¡å¼é‡Œï¼Œæˆä¸ºä¸€ç»„æ¨¡å¼")])])]),t._v(" "),a("h3",{attrs:{id:"ä¸ªä½“æ¨¡å¼-individual-patterns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ªä½“æ¨¡å¼-individual-patterns"}},[t._v("#")]),t._v(" ä¸ªä½“æ¨¡å¼ï¼ˆIndividual Patternsï¼‰")]),t._v(" "),a("ul",[a("li",[t._v("ä¸ªä½“æ¨¡å¼å¯ä»¥åŒ…æ‹¬â€œå•ä¾‹ï¼ˆsingletonï¼‰æ¨¡å¼â€å’Œâ€œå¾ªç¯ï¼ˆloopingï¼‰æ¨¡å¼â€")]),t._v(" "),a("li",[t._v("å•ä¾‹æ¨¡å¼åªæ¥æ”¶ä¸€ä¸ªäº‹ä»¶ï¼Œè€Œå¾ªç¯æ¨¡å¼å¯ä»¥æ¥æ”¶å¤šä¸ª")])]),t._v(" "),a("blockquote",[a("p",[t._v("â˜… é‡è¯ï¼ˆQuantifierï¼‰")]),t._v(" "),a("ul",[a("li",[t._v("å¯ä»¥åœ¨ä¸€ä¸ªä¸ªä½“æ¨¡å¼åè¿½åŠ é‡è¯ï¼Œä¹Ÿå°±æ˜¯æŒ‡å®šå¾ªç¯æ¬¡æ•°\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128171908448.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})])])]),t._v(" "),a("h3",{attrs:{id:"ä¸ªä½“æ¨¡å¼çš„æ¡ä»¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ªä½“æ¨¡å¼çš„æ¡ä»¶"}},[t._v("#")]),t._v(" ä¸ªä½“æ¨¡å¼çš„æ¡ä»¶")]),t._v(" "),a("blockquote",[a("p",[t._v("â˜… æ¡ä»¶ï¼ˆConditionï¼‰\n-- æ¯ä¸ªæ¨¡å¼éƒ½éœ€è¦æŒ‡å®šè§¦å‘æ¡ä»¶ï¼Œä½œä¸ºæ¨¡å¼æ˜¯å¦æ¥å—äº‹ä»¶è¿›å…¥çš„åˆ¤æ–­ä¾æ®\n-- CEP ä¸­çš„ä¸ªä½“æ¨¡å¼ä¸»è¦é€šè¿‡è°ƒç”¨ "),a("code",[t._v(".where()")]),t._v(" ."),a("code",[t._v("or()")]),t._v(" å’Œ "),a("code",[t._v(".until()")]),t._v("æ¥æŒ‡å®šæ¡ä»¶\n-- æŒ‰ä¸åŒçš„è°ƒç”¨æ–¹å¼ï¼Œå¯ä»¥åˆ†æˆä»¥ä¸‹å‡ ç±»\n"),a("br"),t._v("\nâ˜…ç®€å•æ¡ä»¶ï¼ˆSimple Conditionï¼‰\n-- é€šè¿‡ "),a("code",[t._v(".where()")]),t._v("æ–¹æ³•å¯¹äº‹ä»¶ä¸­çš„å­—æ®µè¿›è¡Œåˆ¤æ–­ç­›é€‰ï¼Œå†³å®šæ˜¯å¦æ¥å—è¯¥äº‹ä»¶\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128172239106.png",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}}),t._v("\nâ˜…ç»„åˆæ¡ä»¶ï¼ˆCombining Conditionï¼‰\n-- å°†ç®€å•æ¡ä»¶è¿›è¡Œåˆå¹¶ï¼›"),a("code",[t._v(".or()")]),t._v(" æ–¹æ³•è¡¨ç¤ºæˆ–é€»è¾‘ç›¸è¿ï¼Œ"),a("code",[t._v("where")]),t._v("çš„ç›´æ¥ç»„åˆå°±æ˜¯ AND\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128172458733.png",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}}),t._v("\nâ˜… ç»ˆæ­¢æ¡ä»¶ï¼ˆStop Conditionï¼‰\n-- å¦‚æœä½¿ç”¨äº† "),a("code",[t._v("oneOrMore")]),t._v(" æˆ–è€… "),a("code",[t._v("oneOrMore.optional")]),t._v("ï¼Œå»ºè®®ä½¿ç”¨ "),a("code",[t._v(".until()")]),t._v("ä½œä¸ºç»ˆæ­¢æ¡ä»¶ï¼Œä»¥ä¾¿æ¸…ç†çŠ¶æ€\n"),a("br"),t._v("\nâ˜… è¿­ä»£æ¡ä»¶ï¼ˆIterative Conditionï¼‰\n-- èƒ½å¤Ÿå¯¹æ¨¡å¼ä¹‹å‰æ‰€æœ‰æ¥æ”¶çš„äº‹ä»¶è¿›è¡Œå¤„ç†\n-- è°ƒç”¨"),a("code",[t._v(".where( (value, ctx) => {...} )")]),t._v("ï¼Œå¯ä»¥è°ƒç”¨ "),a("code",[t._v("ctx.getEventsForPattern(â€œnameâ€)")]),t._v("\næç¤ºï¼š nameå¯ä»¥æ˜¯å½“å‰ä¸ªä½“æ¨¡å¼çš„åç§°ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥å°†ä¹‹å‰åŒ¹é…å¥½çš„äº‹ä»¶ä»çŠ¶æ€ä¸­éƒ½æ‹¿å‡ºæ¥ï¼Œå†åšå…·ä½“çš„åˆ¤æ–­ï¼Œä½¿ç”¨ã€‚ä¸€èˆ¬åœ¨æ¯”è¾ƒå¤æ‚çš„åœºæ™¯æ‰ä¼šç”¨åˆ°ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"æ¨¡å¼åºåˆ—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ¨¡å¼åºåˆ—"}},[t._v("#")]),t._v(" æ¨¡å¼åºåˆ—")]),t._v(" "),a("blockquote",[a("ul",[a("li",[a("strong",[t._v("ä¸åŒçš„â€œè¿‘é‚»â€æ¨¡å¼")]),t._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128173500269.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})]),t._v(" "),a("li",[a("strong",[t._v("ä¸¥æ ¼è¿‘é‚»")]),t._v("ï¼ˆStrict Contiguityï¼‰\n-- æ‰€æœ‰äº‹ä»¶æŒ‰ç…§ä¸¥æ ¼çš„é¡ºåºå‡ºç°ï¼Œä¸­é—´æ²¡æœ‰ä»»ä½•ä¸åŒ¹é…çš„äº‹ä»¶ï¼Œç”± "),a("strong",[t._v(".next()")]),t._v(" æŒ‡å®š\n-- ä¾‹å¦‚å¯¹äºæ¨¡å¼"),a("code",[t._v("a next b")]),t._v("ï¼Œäº‹ä»¶åºåˆ— "),a("code",[t._v("[a, c, b1, b2]")]),t._v("æ²¡æœ‰åŒ¹é…")]),t._v(" "),a("li",[a("strong",[t._v("å®½æ¾è¿‘é‚»")]),t._v("ï¼ˆ Relaxed Contiguity ï¼‰\n-- å…è®¸ä¸­é—´å‡ºç°ä¸åŒ¹é…çš„äº‹ä»¶ï¼Œç”± "),a("strong",[t._v(".followedBy()")]),t._v(" æŒ‡å®š\n-- ä¾‹å¦‚å¯¹äºæ¨¡å¼"),a("code",[t._v("a followedBy b")]),t._v("ï¼Œäº‹ä»¶åºåˆ—"),a("code",[t._v("[a, c, b1, b2] åŒ¹é…ä¸º {a, b1}")])]),t._v(" "),a("li",[a("strong",[t._v("éç¡®å®šæ€§å®½æ¾è¿‘é‚»")]),t._v("ï¼ˆ Non-Deterministic Relaxed Contiguity ï¼‰\n-- è¿›ä¸€æ­¥æ”¾å®½æ¡ä»¶ï¼Œä¹‹å‰å·²ç»åŒ¹é…è¿‡çš„äº‹ä»¶ä¹Ÿå¯ä»¥å†æ¬¡ä½¿ç”¨ï¼Œç”±  "),a("strong",[t._v(".followedByAny()")]),t._v("  æŒ‡å®š\n-- ä¾‹å¦‚å¯¹äºæ¨¡å¼"),a("code",[t._v("a followedByAny b")]),t._v("ï¼Œäº‹ä»¶åºåˆ— "),a("code",[t._v("[a, c, b1, b2]")]),t._v(" åŒ¹é…ä¸º"),a("code",[t._v("{a, b1}ï¼Œ{a, b2}")]),t._v(" "),a("br")]),t._v(" "),a("li",[t._v("é™¤ä»¥ä¸Šæ¨¡å¼åºåˆ—å¤–ï¼Œè¿˜å¯ä»¥å®šä¹‰â€œ"),a("strong",[t._v("ä¸å¸Œæœ›å‡ºç°æŸç§è¿‘é‚»å…³ç³»")]),t._v("â€ï¼š\n-- "),a("strong",[t._v(".notNext()")]),t._v("  â€”â€” ä¸æƒ³è®©æŸä¸ªäº‹ä»¶ä¸¥æ ¼ç´§é‚»å‰ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿ\n-- "),a("strong",[t._v(".notFollowedBy()")]),t._v(" â€”â€” ä¸æƒ³è®©æŸä¸ªäº‹ä»¶åœ¨ä¸¤ä¸ªäº‹ä»¶ä¹‹é—´å‘ç”Ÿ")]),t._v(" "),a("li",[t._v("éœ€è¦æ³¨æ„ï¼š\n-- æ‰€æœ‰æ¨¡å¼åºåˆ—å¿…é¡»ä»¥ "),a("strong",[t._v(".begin()")]),t._v(" å¼€å§‹\n-- æ¨¡å¼åºåˆ—ä¸èƒ½ä»¥ "),a("strong",[t._v(".notFollowedBy()")]),t._v(" ç»“æŸ\n-- "),a("strong",[t._v("â€œnotâ€ ç±»å‹çš„æ¨¡å¼ä¸èƒ½è¢« optional æ‰€ä¿®é¥°")]),t._v("\n-- æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä¸ºæ¨¡å¼æŒ‡å®š"),a("strong",[t._v("æ—¶é—´çº¦æŸ")]),t._v("ï¼Œç”¨æ¥è¦æ±‚åœ¨å¤šé•¿æ—¶é—´å†…åŒ¹é…æœ‰æ•ˆ\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020112817540698.png",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})])])]),t._v(" "),a("h3",{attrs:{id:"æ¨¡å¼çš„æ£€æµ‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ¨¡å¼çš„æ£€æµ‹"}},[t._v("#")]),t._v(" æ¨¡å¼çš„æ£€æµ‹")]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("æŒ‡å®šè¦æŸ¥æ‰¾çš„æ¨¡å¼åºåˆ—åï¼Œå°±å¯ä»¥å°†å…¶åº”ç”¨äºè¾“å…¥æµä»¥æ£€æµ‹æ½œåœ¨åŒ¹é…")]),t._v(" "),a("li",[t._v("è°ƒç”¨ CEP.pattern()ï¼Œç»™å®šè¾“å…¥æµå’Œæ¨¡å¼ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ª PatternStream\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128175533723.png",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})])])]),t._v(" "),a("h3",{attrs:{id:"åŒ¹é…äº‹ä»¶çš„æå–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŒ¹é…äº‹ä»¶çš„æå–"}},[t._v("#")]),t._v(" åŒ¹é…äº‹ä»¶çš„æå–")]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("åˆ›å»º "),a("code",[t._v("PatternStream")]),t._v(" ä¹‹åï¼Œå°±å¯ä»¥åº”ç”¨"),a("code",[t._v("select")]),t._v("æˆ–è€… "),a("code",[t._v("flatselect")]),t._v("æ–¹æ³•ï¼Œä»æ£€æµ‹åˆ°çš„äº‹ä»¶åºåˆ—ä¸­æå–äº‹ä»¶äº†")]),t._v(" "),a("li",[t._v("select() æ–¹æ³•éœ€è¦è¾“å…¥ä¸€ä¸ª select function ä½œä¸ºå‚æ•°ï¼Œæ¯ä¸ªæˆåŠŸåŒ¹é…çš„äº‹ä»¶åºåˆ—éƒ½ä¼šè°ƒç”¨å®ƒ")]),t._v(" "),a("li",[t._v("select() ä»¥ä¸€ä¸ª "),a("code",[t._v("Map[Stringï¼ŒIterable [IN]]")]),t._v("æ¥æ¥æ”¶åŒ¹é…åˆ°çš„äº‹ä»¶åºåˆ—ï¼Œå…¶ä¸­ key å°±æ˜¯æ¯ä¸ªæ¨¡å¼çš„åç§°ï¼Œè€Œ value å°±æ˜¯æ‰€æœ‰æ¥æ”¶åˆ°çš„äº‹ä»¶çš„ "),a("strong",[t._v("Iterable")]),t._v(" ç±»å‹")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128180142848.png?,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70",alt:""}})])]),t._v(" "),a("h3",{attrs:{id:"è¶…æ—¶äº‹ä»¶çš„æå–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è¶…æ—¶äº‹ä»¶çš„æå–"}},[t._v("#")]),t._v(" è¶…æ—¶äº‹ä»¶çš„æå–")]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("å½“ä¸€ä¸ªæ¨¡å¼é€šè¿‡ "),a("code",[t._v("within")]),t._v(" å…³é”®å­—å®šä¹‰äº†æ£€æµ‹çª—å£æ—¶é—´æ—¶ï¼Œéƒ¨åˆ†äº‹ä»¶åºåˆ—å¯èƒ½å› ä¸ºè¶…è¿‡çª—å£é•¿åº¦è€Œè¢«ä¸¢å¼ƒï¼›ä¸ºäº†èƒ½å¤Ÿå¤„ç†è¿™äº›è¶…æ—¶çš„éƒ¨åˆ†åŒ¹é…ï¼Œ"),a("code",[t._v("select")]),t._v("å’Œ"),a("code",[t._v("flatSelect API")]),t._v(" è°ƒç”¨å…è®¸æŒ‡å®šè¶…æ—¶å¤„ç†ç¨‹åºã€‚")]),t._v(" "),a("li",[t._v("è¶…æ—¶å¤„ç†ç¨‹åºä¼šæ¥æ”¶åˆ°ç›®å‰ä¸ºæ­¢ç”±æ¨¡å¼åŒ¹é…åˆ°çš„æ‰€æœ‰äº‹ä»¶ï¼Œç”±ä¸€ä¸ª "),a("code",[t._v("OutputTag")]),t._v("å®šä¹‰æ¥æ”¶åˆ°çš„è¶…æ—¶äº‹ä»¶åºåˆ—ã€‚\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128180447522.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})])])]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦åŸºäº"),a("strong",[t._v("CEP")]),t._v("æ¥å®Œæˆè¿™ä¸ªæ¨¡å—çš„å®ç°ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128181336976.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDMxODgzMA==,size_16,color_FFFFFF,t_70#pic_center",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â ç›¸å…³çš„pomæ–‡ä»¶æˆ‘ä»¬å·²ç»åœ¨æœ€å¼€å§‹çš„æ—¶å€™åˆ°å¯¼å…¥äº†ï¼Œç°åœ¨åœ¨src/main/scalaä¸‹ç»§ç»­åˆ›å»º"),a("code",[t._v("LoginFailWithCep.scala")]),t._v("æ–‡ä»¶ï¼Œæ–°å»ºä¸€ä¸ªå•ä¾‹å¯¹è±¡ã€‚æ ·ä¾‹ç±»"),a("code",[t._v("LoginEvent")]),t._v("ç”±äºåœ¨LoginFail.scalaå·²ç»å®šä¹‰ï¼Œæˆ‘ä»¬åœ¨åŒä¸€ä¸ªæ¨¡å—ä¸­å°±ä¸éœ€è¦å†å®šä¹‰ã€‚")]),t._v(" "),a("p",[t._v("Â Â Â Â Â Â Â Â å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-scala extra-class"},[a("pre",{pre:!0,attrs:{class:"language-scala"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("object")]),t._v(" LoginFailWithCep "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¾“å…¥çš„ç™»å½•äº‹ä»¶æ ·ä¾‹ç±»")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" eventType"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" eventTime"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¾“å‡ºçš„æŠ¥è­¦ä¿¡æ¯æ ·ä¾‹ç±»")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" firstFailTime"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" lastFailTime"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" warningMsg"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Unit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1ã€åˆ›å»ºæµç¯å¢ƒ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" env"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" StreamExecutionEnvironment "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" StreamExecutionEnvironment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getExecutionEnvironment\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®å¹¶è¡Œåº¦")]),t._v("\n    env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("setParallelism"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®æ—¶é—´ç‰¹å¾ä¸ºäº‹ä»¶æ—¶é—´")]),t._v("\n    env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("setStreamTimeCharacteristic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TimeCharacteristic"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EventTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ„å»ºæ•°æ®")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" loginEventStream"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" KeyedStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readTextFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"G:\\\\idea arc\\\\BIGDATA\\\\project\\\\src\\\\main\\\\resources\\\\LoginLog.csv"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å°†æ–‡ä»¶ä¸­çš„æ•°æ®å°è£…æˆæ ·ä¾‹ç±»")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" dataArray"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("split"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('","')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("toLong"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dataArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dataArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dataArray"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("toLong"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®æ°´å°ï¼Œé˜²æ­¢æ•°æ®ä¹±åº")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("assignTimestampsAndWatermarks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" BoundedOutOfOrdernessTimestampExtractor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("seconds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" extractTimestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Long")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä»¥ç”¨æˆ·idä¸ºkeyï¼Œè¿›è¡Œåˆ†ç»„")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("keyBy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®šä¹‰åŒ¹é…çš„æ¨¡å¼")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" loginFailPattern"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Pattern"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Pattern"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("begin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"begin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("where"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventType "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fail"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"next"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("where"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventType "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"fail"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("within"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("seconds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é€šè¿‡ within å…³é”®å­—å®šä¹‰äº†æ£€æµ‹çª—å£æ—¶é—´æ—¶é—´")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å°† pattern åº”ç”¨åˆ° è¾“å…¥æµ ä¸Šï¼Œå¾—åˆ°ä¸€ä¸ª pattern stream")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" patternStream"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" PatternStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CEP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pattern"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("loginEventStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("loginFailPattern"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”¨ select æ–¹æ³•æ£€å‡º ç¬¦åˆæ¨¡å¼çš„äº‹ä»¶åºåˆ—")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" loginFailDataStream"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" DataStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" patternStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("select"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" LoginFailMatch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å°†åŒ¹é…åˆ°çš„ç¬¦åˆæ¡ä»¶çš„äº‹ä»¶æ‰“å°å‡ºæ¥")]),t._v("\n    loginFailDataStream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("print"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"warning"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰§è¡Œç¨‹åº")]),t._v("\n    env"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("execute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"login fail with cep job"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è‡ªå®šä¹‰ pattern select function")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“æ£€æµ‹åˆ°å®šä¹‰å¥½çš„æ¨¡å¼åºåˆ—æ—¶å°±ä¼šè°ƒç”¨ï¼Œè¾“å‡ºæŠ¥è­¦ä¿¡æ¯")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" LoginFailMatch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" PatternSelectFunction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" select"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("map"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("List"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("LoginEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Warning "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä» map ä¸­å¯ä»¥æŒ‰ç…§æ¨¡å¼çš„åç§°æå–å¯¹åº”çš„ç™»å½•å¤±è´¥äº‹ä»¶")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" firstFail"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" LoginEvent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"begin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("val")]),t._v(" secondFail"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" LoginEvent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"next"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("iterator"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n         \n      Warning"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" firstFail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("userId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("firstFail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("secondFail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"åœ¨2ç§’å†…è¿ç»­2æ¬¡ç™»å½•å¤±è´¥ã€‚"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("è¿è¡Œç»“æœï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20201128190916185.png",alt:""}})]),t._v(" "),a("p",[t._v("å¯ä»¥å‘ç°ä¹Ÿæ˜¯ç¬¦åˆæˆ‘ä»¬é¢„æœŸçš„æ•ˆæœ~")])])}),[],!1,null,null,null);s.default=e.exports}}]);