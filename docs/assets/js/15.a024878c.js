(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{406:function(t,s,a){"use strict";a.r(s);var e=a(30),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"hive-åˆ†æå‡½æ•°è¿›é˜¶æŒ‡å—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hive-åˆ†æå‡½æ•°è¿›é˜¶æŒ‡å—"}},[t._v("#")]),t._v(" Hive åˆ†æå‡½æ•°è¿›é˜¶æŒ‡å—")]),t._v(" "),a("p",[t._v("[æ•°æ®ä»“åº“ä¸Pythonå¤§æ•°æ®](javascript:void(0)ğŸ˜‰ "),a("em",[t._v("2020-05-27")])]),t._v(" "),a("p",[t._v("ä»¥ä¸‹æ–‡ç« æ¥æºäºå¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½ ï¼Œä½œè€…æ–Œè¿ª")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=Mzg3NjIyNjQwMg==&mid=2247487212&idx=1&sn=f0480567f8b91f8d94d0953e6c27baf8&chksm=cf343ce1f843b5f7940d4e9db7619f085b4e48e7be6d3ba28b8f3f1030d6548337696df02dc5&mpshare=1&scene=1&srcid=0726mhr6LTVvfc19f95uueAS&sharer_sharetime=1627236514990&sharer_shareid=fe705087c00f630c1298600646872540&key=7459898629dc7ce463a856ad1a0306f7fc870392cc205dd9bb00383f97df7e200ba44f6bd4c4a064446bbf90c618eea6dd8ac6c5c974074138f1b2e0f59f433add93ce630f87bea15a9ae38a307932458bd634001f1094968d789e213570428e39e4394b96c66d45f88128f2b6e7dcce9a9414e4f0d9ba194e7a71d158ef4ba5&ascene=1&uin=OTA2MDU2Nzc3&devicetype=Windows+10+x64&version=63030073&lang=zh_CN&exportkey=A1iwbm2PseHPVSOB74PuDGc%3D&pass_ticket=AJSYPF%2FDRZ5Dbgdei0x8CrxCiEvRpI%2BkjCKzB%2B%2F84htSssI1Paw1OxXHAexDSAzx&wx_header=0&fontgear=2#",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"http://wx.qlogo.cn/mmhead/Q3auHgzwzM5M7lLKEAiaomE2bdU1AnqO5cps0UN6CZ9wQbmjgnSYM0g/0",alt:"å¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½"}}),a("strong",[t._v("å¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½")]),t._v("æœ¬å…¬ä¼—å·ä½œè€…æ¥è‡ªç”µè§†çŒ«MoreTVå¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½å›¢é˜Ÿï¼ŒæŒç»­å…³æ³¨ä¸šå†…å¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½æŠ€æœ¯ã€è¡Œä¸šåŠ¨æ€ï¼Œæ¯å‘¨è¾“å‡º2ç¯‡ä»¥ä¸Šå¤§æ•°æ®ã€æ¨èç³»ç»Ÿã€ç®—æ³•ã€æœºå™¨å­¦ä¹ ã€AIç›¸å…³åŸåˆ›æ–‡ç« ï¼"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=Mzg3NjIyNjQwMg==&mid=2247487154&idx=1&sn=8513992a5f7aabe7f63e9e83fad050ef&chksm=cf343cbff843b5a9e502263b3017182681c8f249122e40ececb57e32364f262f3e4a29f84996&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcItFKic3u5LTdvOzOIofLIYfZaCa7qgbgibrYJcicLWriaAsLfJptk4DaAXQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[a("strong",[t._v("ä½œè€…ä¸¨æ–Œè¿ª")])]),t._v(" "),a("p",[t._v("ä½œä¸ºä¸€åSQL BOY/GIRLï¼šåœ¨å†™SQLçš„æ¼«æ¼«è·¯ä¸Šï¼Œçª—å£å‡½æ•°çŠ¹å¦‚ä¸€æŠŠæŠ«è†æ–©æ£˜çš„åˆ©å‰‘ï¼Œå¸®åŠ©ä½œè€…è§£å†³äº†å¾ˆå¤šç¹çå¤æ‚çš„éœ€æ±‚ï¼Œåœ¨æ­¤å¯¹çª—å£å‡½æ•°è¡¨ç¤ºæ„Ÿè°¢ã€‚")]),t._v(" "),a("p",[t._v("æœ¬æ–‡åœ¨ä»‹ç»äº†çª—å£å‡½æ•°çš„åŒæ—¶ï¼Œç€é‡ä»‹ç»Hiveçª—å£å‡½æ•°çš„ä½¿ç”¨ï¼Œå¸Œæœ›è¯»è€…åœ¨çœ‹å®Œæœ¬ç¯‡æ–‡ç« ä¹‹åï¼Œå¯¹çª—å£å‡½æ•°çš„ä½¿ç”¨èƒ½å¤Ÿæœ‰æ‰€æŒæ¡ã€‚")]),t._v(" "),a("p",[t._v("å€¼å¾—æ³¨æ„çš„æ˜¯æœ¬æ–‡ä¸­çš„ä¾‹å­ä½¿ç”¨çš„æ˜¯HQLï¼ˆHive SQLï¼‰ï¼Œæœ¬æ–‡éœ€è¦ä¸€å®šçš„SQLåŸºç¡€ï¼Œå¦‚æœæƒ³äº†è§£åŸºç¡€SQLï¼Œè¯·ç§»æ­¥ï¼š"),a("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=Mzg3NjIyNjQwMg==&mid=2247485812&idx=2&sn=721cb0b0051d745db0eaef599192c272&chksm=cf343b79f843b26fa7fe0c983646d48f362eab90458288c8508fa7670ef22a971aade2d312b0&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("SQL å¼€å‘è§„èŒƒä¸ä¼˜åŒ–æŠ€å·§"),a("OutboundLink")],1),a("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzI1NjM1ODEyMg==&mid=2247483959&idx=1&sn=23f9ee016dca61c2e78a5b6e8f8b1eae&chksm=ea26a1b2dd5128a4bcd8a3d425876e8ec8ed2698899fb12c60a128dbad2d5eb7d68ab3998b76&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("ä¸¤ä¸ªé—®é¢˜")])]),t._v(" "),a("p",[t._v("å¯¹äºæ•°æ®å·¥ä½œè€…æ¥è¯´ï¼Œçª—å£å‡½æ•°æˆ–å¤šæˆ–å°‘éƒ½ä½¿ç”¨è¿‡ï¼Œä½†æ˜¯å¯èƒ½æ²¡æœ‰ç³»ç»Ÿçš„å»æ€»ç»“å®ƒçš„ç”¨æ³•ã€‚")]),t._v(" "),a("p",[t._v("å¦‚æœè¯»è€…å¯¹äºçª—å£å‡½æ•°æœ‰ä¸€ç‚¹äº†è§£çš„è¯ï¼Œä¸å¦¨å…ˆçœ‹çœ‹é’ˆå¯¹ä¸‹è¡¨çš„ä¸¤ä¸ªé—®é¢˜ï¼Œå¦‚ä½•ä½¿ç”¨SQLå»è§£å†³ï¼›"),a("strong",[t._v("å¦‚æœè¯»è€…å¯¹äºçª—å£å‡½æ•°ä¸€ç‚¹éƒ½ä¸äº†è§£ï¼Œé‚£è¯·æ‚¨ç›´æ¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†ï¼Œç›´æ¥ä»"),a("strong",[a("strong",[t._v("ä»€ä¹ˆæ˜¯çª—å£å‡½æ•°")])]),t._v("å¼€å§‹é˜…è¯»ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcIicbiae5r1XUcq2vLdzja1Tia0ZgibaLtkBU1w0ON8bsJghibdmXdiaIFHokw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[t._v("é’ˆå¯¹ä¸Šé¢ä¸€å¼ å­¦ç”Ÿæˆç»©è¡¨(class)ï¼Œæœ‰year-å­¦å¹´ï¼Œclass-è¯¾ç¨‹ï¼Œstudent-å­¦ç”Ÿï¼Œscore-åˆ†æ•°è¿™å››ä¸ªå­—æ®µï¼Œè¯·çœ‹é—®é¢˜ï¼š")]),t._v(" "),a("p",[a("em",[t._v("é—®é¢˜1ï¼šæ¯å¹´æ¯é—¨å­¦ç§‘æ’åç¬¬ä¸€çš„å­¦ç”Ÿæ˜¯ï¼Ÿ")])]),t._v(" "),a("p",[a("em",[t._v("é—®é¢˜2ï¼šæ¯å¹´æ€»æˆç»©éƒ½æœ‰æ‰€æå‡çš„å­¦ç”Ÿæ˜¯ï¼Ÿ")])]),t._v(" "),a("p",[t._v("å¯¹äºé—®é¢˜1æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œæ—¢å¯ä»¥ä½¿ç”¨èšåˆå‡½æ•°æ¥ç»Ÿè®¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨çª—å£å‡½æ•°æ¥ç»Ÿè®¡ï¼Œå…¶ä¸­çª—å£å‡½æ•°ç»™äº†ä¸¤ç§è§£æ³•ï¼š")]),t._v(" "),a("ul",[a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("--ä½¿ç”¨èšåˆå‡½æ•°select a.year,a.class,b.studentfrom(select year,class,max(score) as max_scorefrom classgroup by year,class) a join class b on a.year = b.year and a.class = b.class and a.max_score = b.scoreorder by a.year\n")])])]),a("p",[t._v("æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼Œå¦‚æœæœ‰ç›¸åŒæˆç»©çš„è¯éƒ½ä¼šä¿ç•™ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcIpiaCCkMVzPiaGC01YhpwXfCPesWV60aTKwd5lgw9WYibv5ibiaJyuE65Vcg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("ul",[a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("--ä½¿ç”¨çª—å£å‡½æ•°maxselect a.year,a.class,a.studentfrom(select year,class,score,student,max(score) over (partition by year,class) as max_score --å¢åŠ ä¸€åˆ—ä¸ºèšåˆåçš„æœ€é«˜åˆ†    from `class`) a where a.score = max_score  --ä¿ç•™ä¸æœ€é«˜åˆ†ç›¸åŒçš„è®°å½•æ•° \n")])])]),a("p",[t._v("æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼ŒåŒæ ·çš„å¦‚æœæœ‰ç›¸åŒè®°å½•ä¹Ÿä¼šä¿ç•™ä¸‹æ¥ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcI6N9fZLHvq3H5X4pKj8XeV1wYah5O0NuOHpqYOy3TJScdQ55oBicHrbw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("ul",[a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("--ä½¿ç”¨çª—å£å‡½æ•°first_valueselect distinct year,class,first_value(student) over (partition by year,class order by score desc) as studentfrom class\n")])])]),a("p",[t._v("æ‰§è¡Œç»“æœï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœæœ‰ç›¸åŒæˆç»©ï¼Œåªä¼šå–ä¸€æ¡è®°å½•ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcIKs7oB5S08fiaMMMD6viaJacgbicvPiavr4aV5ic2rBOtvHkrxVibBf2RlS1g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[t._v("å¯¹æ¯”ä¸¤ç§å†™æ³•å¯ä»¥å‘ç°ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("â€¢ ä½¿ç”¨çª—å£å‡½æ•°çš„SQLä»£ç é‡å°‘")])]),t._v(" "),a("p",[a("strong",[t._v("â€¢ é¿å…äº†ä¸åŸè¡¨çš„join")])]),t._v(" "),a("p",[t._v("å¯¹äºé—®é¢˜2ï¼Œæ˜¯ä¸€ä¸ªç›¸å¯¹å¤æ‚ä½†æ˜¯æ¯”è¾ƒå¸¸è§çš„éœ€æ±‚ï¼Œ"),a("strong",[t._v("æ— æ³•åªä½¿ç”¨èšåˆå‡½æ•°æ¥ç»Ÿè®¡ï¼Œåªèƒ½é…åˆçª—å£å‡½æ•°æ¥ç»Ÿè®¡ã€‚")])]),t._v(" "),a("ul",[a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li"),t._v(" "),a("li")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("select studentfrom(  select year,student  ,if((sum_score - lag(sum_score,1,0)   over   (    partition by student     order by year  )) > 0,1,0) as flag  ,(sum_score - lag(sum_score,1,0)   over   (partition by student   order by year  )) as flag1  --æŒ‰ç…§studentè¿›è¡Œåˆ†åŒºå¹¶è¿›è¡Œyearæ­£åºæ’åº  --ï¼Œæ‰¾åˆ°æ¯ä¸ªå­¦ç”Ÿçš„ä¸Šä¸€æ¡å­¦å¹´æ€»æˆç»©  --ï¼Œå¹¶ä¸å½“å¹´æˆç»©ç›¸å‡ï¼Œå¦‚æœå°äº  --ï¼Œåˆ™å°†flagå€¼ç½®ä¸º1ï¼Œå¦åˆ™ç½®ä¸º0  from  (    select year,student    ,sum(score) as sum_score     --æŒ‰ç…§å­¦å¹´å’Œå­¦ç”Ÿè¿›è¡Œæˆç»©æ±‡æ€»    from class    group by year,student  ) a ) b group by studenthaving avg(flag) = 1 --å¹³å‡å€¼ä¸º1åˆ™ä»£è¡¨æ˜¯æ¯å¹´éƒ½æœ‰å¢é•¿\n")])])]),a("p",[t._v("æ‰§è¡Œç»“æœï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_jpg/cge06IdYQydF9cXeWKNTs10PeDAk1ibcIGfCK1Z45p6jGJ4FPNDWsefK3QJLg3kOiaF8E2rDC9UGObdxEic0LAZqA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[t._v("é€šè¿‡ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ï¼Œå¯ä»¥å¯¹çª—å£å‡½æ•°çš„ç‰¹å¾åšä¸€ä¸ªç®€å•çš„å°ç»“ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("â€¢ èšåˆå‡½æ•°å¯ä»¥ä½œä¸ºçª—å£å‡½æ•°ä½¿ç”¨")])]),t._v(" "),a("p",[a("strong",[t._v("â€¢ å…·æœ‰è®¡ç®—å’Œå–å€¼çš„åŠŸèƒ½")])]),t._v(" "),a("p",[a("strong",[t._v("â€¢ ä¸æ”¹å˜è®°å½•æ•°")])]),t._v(" "),a("p",[a("strong",[t._v("ä»€ä¹ˆæ˜¯çª—å£å‡½æ•°")])]),t._v(" "),a("p",[t._v("ç›¸ä¿¡çœ‹äº†ä¸Šé¢çš„ä¸¤ä¸ªé—®é¢˜åï¼Œå¯¹çª—å£å‡½æ•°çš„ä½¿ç”¨æœ‰ä¸€ä¸ªå¤§æ¦‚çš„äº†è§£ã€‚ä¸‹é¢ä»ç†è®ºæ–¹é¢æ¥è¯¦ç»†äº†è§£ä¸‹çª—å£å‡½æ•°ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQye9IR2ddRibJCAe9fbFSiaon5cTg6333Q1Yib27hmP1Knw11O45grZkF0icvpVwqZGNTbQF6DqEDZ1vuQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[t._v("ç†è®º")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQye9IR2ddRibJCAe9fbFSiaon5cTg6333Q1Yib27hmP1Knw11O45grZkF0icvpVwqZGNTbQF6DqEDZ1vuQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[t._v("çª—å£å‡½æ•°ä¹Ÿç§°ä¸ºOLAPï¼ˆOnline Analytical Processingï¼‰å‡½æ•°ï¼Œæ˜¯å¯¹ä¸€ç»„å€¼è¿›è¡Œæ“ä½œï¼Œ"),a("strong",[t._v("ä¸éœ€è¦ä½¿ç”¨Group byå­å¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œè¿˜èƒ½åœ¨åŒä¸€è¡Œè¿”å›åŸæ¥è¡Œçš„åˆ—å’Œä½¿ç”¨èšåˆå‡½æ•°å¾—åˆ°çš„èšåˆåˆ—")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("é‚£ä¸ºä»€ä¹ˆå«çª—å£å‡½æ•°å‘¢ï¼Ÿ"),a("strong",[t._v("å› ä¸ºçª—å£å‡½æ•°å°†è¡¨ä»¥çª—å£ä¸ºå•ä½è¿›è¡Œåˆ†å‰²ï¼Œå¹¶åœ¨å…¶ä¸­è¿›è¡Œå„ç§åˆ†ææ“ä½œï¼Œä¸ºäº†è®©å¤§å®¶å¿«é€Ÿå½¢æˆç›´è§‚å°è±¡ï¼Œæ‰èµ·äº†è¿™æ ·ä¸€ä¸ªå®¹æ˜“ç†è§£çš„åç§°")]),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"sqlè¯­æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sqlè¯­æ³•"}},[t._v("#")]),t._v(" SQLè¯­æ³•")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("çª—å£å‡½æ•°"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("åˆ—æ¸…å•"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("æ’åºç”¨æ¸…å•åˆ—"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ASC")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESC")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ROWS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" RANGE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("èŒƒå›´æ¡ä»¶"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œçª—å£å‡½æ•°çš„è¯­æ³•åˆ†ä¸º"),a("strong",[t._v("å››ä¸ªéƒ¨åˆ†")]),t._v("ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("å‡½æ•°å­å¥")]),t._v("ï¼šæŒ‡æ˜å…·ä½“æ“ä½œï¼Œå¦‚sum-æ±‚å’Œï¼Œfirst_value-å–ç¬¬ä¸€ä¸ªå€¼ï¼›")]),t._v(" "),a("p",[a("strong",[t._v("partition byå­å¥")]),t._v("ï¼šæŒ‡æ˜åˆ†åŒºå­—æ®µï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™å°†æ‰€æœ‰æ•°æ®ä½œä¸ºä¸€ä¸ªåˆ†åŒºï¼›")]),t._v(" "),a("p",[a("strong",[t._v("order byå­å¥")]),t._v("ï¼šæŒ‡æ˜äº†æ¯ä¸ªåˆ†åŒºæ’åºçš„å­—æ®µå’Œæ–¹å¼,ä¹Ÿæ˜¯å¯é€‰çš„ï¼Œæ²¡æœ‰å°±æ˜¯æŒ‰ç…§è¡¨ä¸­çš„é¡ºåºï¼›")]),t._v(" "),a("p",[a("strong",[t._v("çª—å£å­å¥")]),t._v("ï¼šæŒ‡æ˜ç›¸å¯¹å½“å‰è®°å½•çš„è®¡ç®—èŒƒå›´ï¼Œå¯ä»¥å‘ä¸Šï¼ˆprecedingï¼‰ï¼Œå¯ä»¥å‘ä¸‹ï¼ˆfollowingï¼‰,ä¹Ÿå¯ä»¥ä½¿ç”¨betweenæŒ‡æ˜ï¼Œä¸Šä¸‹è¾¹ç•Œçš„å€¼ï¼Œæ²¡æœ‰çš„è¯é»˜è®¤ä¸ºå½“å‰åˆ†åŒºã€‚æœ‰äº›åœºæ™¯æ¯”è¾ƒç‰¹æ®Šï¼Œåæ–‡ä¼šè®²åˆ°è¿™ç§åœºæ™¯ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("çª—å£å‡½æ•°åˆ†ç±»")])]),t._v(" "),a("p",[t._v("ä¸‹é¢çš„æ€ç»´å¯¼å›¾åŸºæœ¬åŒ…å«äº†Hiveæ‰€æœ‰çš„çª—å£å‡½æ•°ï¼ŒæŒ‰ç…§çª—å£å‡½æ•°çš„åŠŸèƒ½åˆ†ä¸ºï¼š"),a("strong",[t._v("è®¡ç®—ã€å–å€¼ã€æ’åºã€åºåˆ—")]),t._v("å››ç§ï¼Œå‰ä¸‰ç§çš„ä½¿ç”¨åœºæ™¯æ¯”è¾ƒå¸¸è§ï¼Œå®¹æ˜“ç†è§£ï¼Œæœ€åä¸€ç§(åºåˆ—)çš„ä½¿ç”¨åœºæ™¯æ¯”è¾ƒå°‘ã€‚")]),t._v(" "),a("p",[a("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=Mzg3NjIyNjQwMg==&mid=2247483677&idx=1&sn=32ddbe9c8747d9cf9a821162bb9de27f&chksm=cf343310f843ba0626f8623283dd4a23dc480788d818f53713ab038f2fd8f2152f08c985507a&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("ç‚¹å‡»è·³è½¬ï¼šSQLåˆ†æå‡½æ•°ï¼Œçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=Mzg3NjIyNjQwMg==&mid=2247483677&idx=1&sn=32ddbe9c8747d9cf9a821162bb9de27f&chksm=cf343310f843ba0626f8623283dd4a23dc480788d818f53713ab038f2fd8f2152f08c985507a&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcICp9QiaiaQiciam7kfT56wFbvwYnvnRIKT2dYIb1icgr6JCAnAPMbaVRLYsw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}}),a("OutboundLink")],1)]),t._v(" "),a("p",[a("strong",[t._v("çª—å£å‡½æ•°ä½¿ç”¨åœºæ™¯")])]),t._v(" "),a("p",[t._v("ä»‹ç»äº†è¿™ä¹ˆå¤šï¼Œé‚£çª—å£å‡½æ•°åˆ°åº•å¯ä»¥å¸®æˆ‘ä»¬åšä»€ä¹ˆå‘¢ï¼Ÿ")]),t._v(" "),a("p",[t._v("ç»“åˆå®é™…åœºæ™¯çœ‹çœ‹æ€ä¹ˆç”¨çª—å£å‡½æ•°æ¥è§£å†³é—®é¢˜ã€‚ä¸‹é¢é’ˆå¯¹ä¸åŒçš„ä½¿ç”¨åœºæ™¯ï¼Œå°†çª—å£å‡½æ•°çš„ä½¿ç”¨å‘ˆç°ç»™å¤§å®¶ã€‚æ‰€æœ‰ä¾‹å­çš„æ•°æ®å‡æ¥è‡ªä¸‹å›¾è¿™å¼ è¡¨ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcICHo52KzPaicTUdOibCVITANWCMGfITDUMiaOYQ6Q8VgM8LUQXeEHjibzDQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("h2",{attrs:{id:"ç”¨äºè¾…åŠ©è®¡ç®—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç”¨äºè¾…åŠ©è®¡ç®—"}},[t._v("#")]),t._v(" ç”¨äºè¾…åŠ©è®¡ç®—")]),t._v(" "),a("p",[t._v("ä¸»è¦çš„ç”¨æ³•æ˜¯åœ¨åŸæœ‰è¡¨çš„åŸºç¡€ä¸Šï¼Œå¢åŠ ä¸€åˆ—èšåˆåçš„å€¼ï¼Œè¾…ä»¥åç»­çš„è®¡ç®—ã€‚")]),t._v(" "),a("p",[t._v("ä¾‹å¦‚ï¼šç»Ÿè®¡å‡ºä¸åŒäº§å“ç±»å‹å”®ä»·æœ€é«˜çš„äº§å“ã€‚")]),t._v(" "),a("p",[t._v("å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--ä½¿ç”¨çª—å£å‡½æ•°max")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("product_type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("product_name\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" product_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("product_type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sale_price\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("over")]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("partition")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" product_type\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" max_sale_price \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--å¢åŠ ä¸€åˆ—ä¸ºèšåˆåçš„æœ€é«˜å”®ä»·")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" product\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" a \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sale_price "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("max_sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--ä¿ç•™ä¸æœ€é«˜å”®ä»·ç›¸åŒçš„è®°å½•æ•°")]),t._v("\n")])])]),a("p",[t._v("æ‰§è¡Œç»“æœï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcI3adFGbmpiaIIbvNYky0AGtonazRjGuSa2C00tsr0zzqia76oZBWS6bTA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[a("strong",[t._v("å‡ ä¹æ‰€æœ‰çš„çª—å£å‡½æ•°éƒ½å¯ä»¥ç”¨äºè¾…åŠ©è®¡ç®—")]),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"ç´¯ç§¯è®¡ç®—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç´¯ç§¯è®¡ç®—"}},[t._v("#")]),t._v(" ç´¯ç§¯è®¡ç®—")]),t._v(" "),a("p",[t._v("æ ‡å‡†èšåˆå‡½æ•°ä½œä¸ºçª—å£å‡½æ•°é…åˆorder byä½¿ç”¨ï¼Œå¯ä»¥å®ç°ç´¯ç§¯è®¡ç®—ã€‚")]),t._v(" "),a("p",[t._v("ä¾‹å¦‚ï¼šsumçª—å£å‡½æ•°é…åˆorder byï¼Œå¯ä»¥å®ç°ç´¯ç§¯å’Œã€‚")]),t._v(" "),a("p",[t._v("å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" product_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("product_name\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("product_type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sale_price\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("SUM")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v(" \n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" product_id\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" current_sum\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("æ‰§è¡Œç»“æœï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcI06f8ibfW9GhjWhVeiaevDKKicgvqgoQkHZYHibFKHX4QqZAEKg0vqhSGjA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[t._v("ç›¸åº”çš„AVGçª—å£å‡½æ•°é…åˆorder byï¼Œå¯ä»¥å®ç°ç´¯ç§¯å¹³å‡ï¼Œmaxå¯ä»¥å®ç°ç´¯ç§¯æœ€å¤§å€¼ï¼Œminå¯ä»¥å®ç°ç´¯ç§¯æœ€å°å€¼ï¼Œcountåˆ™å¯ä»¥å®ç°ç´¯ç§¯è®¡æ•°ã€‚æ³¨æ„ï¼Œ"),a("strong",[t._v("åªæœ‰è®¡ç®—ç±»çš„çª—å£å‡½æ•°å¯ä»¥å®ç°ç´¯ç§¯è®¡ç®—")]),t._v("ã€‚")]),t._v(" "),a("p",[a("em",[t._v("è¿™é‡Œæå‡ºä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆå¢åŠ äº†order byå°±å¯ä»¥å®ç°ç´¯ç§¯è®¡ç®—å‘¢ï¼Ÿè¯»è€…å¯ä»¥åœé¡¿æ€è€ƒä¸€ä¸‹ï¼")])]),t._v(" "),a("p",[a("strong",[t._v("ç­”æ¡ˆé©¬ä¸Šæ­æ™“")]),t._v("ï¼šæ ‡å‡†èšåˆå‡½æ•°ä½œä¸ºçª—å£å‡½æ•°ä½¿ç”¨çš„æ—¶å€™ï¼Œåœ¨æŒ‡æ˜order byçš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰Windowå­å¥ï¼Œåˆ™Windowå­å¥é»˜è®¤ä¸ºï¼šRANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW(ä¸Šè¾¹ç•Œä¸é™åˆ¶ï¼Œä¸‹è¾¹ç•Œåˆ°å½“å‰è¡Œ)ã€‚")]),t._v(" "),a("h2",{attrs:{id:"ç§»åŠ¨è®¡ç®—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç§»åŠ¨è®¡ç®—"}},[t._v("#")]),t._v(" ç§»åŠ¨è®¡ç®—")]),t._v(" "),a("p",[t._v("ç§»åŠ¨è®¡ç®—æ˜¯åœ¨åˆ†åŒºå’Œæ’åºçš„åŸºç¡€ä¸Šï¼Œå¯¹è®¡ç®—èŒƒå›´è¿›ä¸€æ­¥åšå‡ºé™å®šã€‚")]),t._v(" "),a("p",[t._v("ä¾‹å¦‚ï¼šæŒ‰ç…§äº§å“IDæ’åºï¼Œå°†æœ€è¿‘3æ¡çš„é”€å”®ä»·æ ¼è¿›è¡Œæ±‡æ€»å¹³å‡ã€‚")]),t._v(" "),a("p",[t._v("å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" product_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("product_name\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sale_price\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AVG")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("over")]),t._v(" \n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" \n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" product_id \n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("rows")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("preceding")]),t._v(" \n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" moving_avg\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("rows 2 precedingçš„æ„æ€å°±æ˜¯â€œæˆªæ­¢åˆ°ä¹‹å‰2è¡Œâ€ã€‚ä¹Ÿå°±æ˜¯å°†ä½œä¸ºæ±‡æ€»å¯¹è±¡çš„è®°å½•é™å®šä¸ºå¦‚ä¸‹çš„"),a("strong",[t._v("æœ€é è¿‘çš„3è¡Œ")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcIxpUYLAyickJTxAnOBbKklaZv0Tar9Kv7olibGgPt5Pxl7L8JIp0ltZvA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[t._v("ä½¿ç”¨å…³é”®å­—FOLLOWING(â€œä¹‹åâ€ï¼‰æ›¿æ¢PRECEDINGï¼Œå°±å¯ä»¥æŒ‡å®š"),a("strong",[t._v("æˆªæ­¢åˆ°ä¹‹å~è¡Œ")]),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"å–ä»»ä¸€å­—æ®µå€¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å–ä»»ä¸€å­—æ®µå€¼"}},[t._v("#")]),t._v(" å–ä»»ä¸€å­—æ®µå€¼")]),t._v(" "),a("p",[t._v("å–å€¼çš„çª—å£å‡½æ•°æœ‰ï¼š"),a("strong",[t._v("first_value/last_valueã€lag/lead")]),t._v("ï¼Œå…¶ä¸­first_valueå’Œlagåœ¨å¼€ç¯‡çš„ä¾‹å­ä¸­å·²ç»ä½¿ç”¨åˆ°äº†ï¼Œè¿™é‡Œå°±ä¸ä¸¾ä¾‹è¯´æ˜äº†ã€‚åªç»†åŒ–è¯´æ˜ä¸‹ä»–ä»¬çš„è¯­æ³•ã€‚")]),t._v(" "),a("p",[t._v("first_value(å­—æ®µå)-å–å‡ºåˆ†åŒºä¸­çš„ç¬¬ä¸€æ¡è®°å½•çš„ä»»æ„ä¸€ä¸ªå­—æ®µçš„å€¼ï¼Œå¯ä»¥æ’åºä¹Ÿå¯ä»¥ä¸æ’åºï¼Œæ­¤å¤„ä¹Ÿå¯ä»¥è¿›ä¸€æ­¥æŒ‡æ˜Windowå­å¥ã€‚")]),t._v(" "),a("p",[t._v("lag(å­—æ®µå,N,é»˜è®¤å€¼)-å–å‡ºå½“å‰è¡Œä¹‹ä¸Šçš„ç¬¬Næ¡è®°å½•çš„ä»»æ„ä¸€ä¸ªå­—æ®µçš„å€¼ï¼Œè¿™é‡Œçš„Nå’Œé»˜è®¤å€¼éƒ½æ˜¯å¯é€‰çš„ï¼Œé»˜è®¤Nä¸º1ï¼Œé»˜è®¤å€¼ä¸ºnullã€‚")]),t._v(" "),a("h2",{attrs:{id:"æ’åº"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ’åº"}},[t._v("#")]),t._v(" æ’åº")]),t._v(" "),a("p",[t._v("æ’åºå¯¹åº”çš„å››ä¸ªçª—å£å‡½æ•°ä¸ºï¼š"),a("strong",[t._v("rankã€dense_rankã€row_numberã€ntitle")])]),t._v(" "),a("p",[t._v("rankï¼šè®¡ç®—æ’åºæ—¶ï¼Œå¦‚æœå­˜åœ¨ç›¸åŒä½æ¬¡çš„è®°å½•ï¼Œåˆ™ä¼šè·³è¿‡ä¹‹åçš„ä½æ¬¡ã€‚")]),t._v(" "),a("p",[t._v("e.g. æœ‰ä¸‰æ¡è®°å½•æ’åœ¨ç¬¬1ä½æ—¶ï¼š1ä½ã€1ä½ã€1ä½ã€4ä½......")]),t._v(" "),a("p",[t._v("dense_rankï¼šè®¡ç®—æ’åºæ—¶ï¼Œå³ä½¿å­˜åœ¨ç›¸åŒä½æ¬¡çš„è®°å½•ï¼Œä¹Ÿä¸ä¼šè·³è¿‡ä¹‹åçš„ä½æ¬¡ã€‚")]),t._v(" "),a("p",[t._v("e.g. æœ‰ä¸‰æ¡è®°å½•æ’åœ¨ç¬¬1ä½æ—¶ï¼š1ä½ã€1ä½ã€1ä½ã€2ä½......")]),t._v(" "),a("p",[t._v("row_numberï¼šèµ‹äºˆå”¯ä¸€çš„è¿ç»­ä½æ¬¡ã€‚")]),t._v(" "),a("p",[t._v("e.g. æœ‰ä¸‰æ¡è®°å½•æ’åœ¨ç¬¬1ä½æ—¶ï¼š1ä½ã€2ä½ã€3ä½ã€4ä½...")]),t._v(" "),a("p",[t._v("ntitleï¼šç”¨äºå°†åˆ†ç»„æ•°æ®æŒ‰ç…§é¡ºåºåˆ‡åˆ†æˆnç‰‡ï¼Œè¿”å›å½“å‰åˆ‡ç‰‡å€¼")]),t._v(" "),a("p",[t._v("e.g. å¯¹äºä¸€ç»„æ•°å­—ï¼ˆ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼‰ï¼Œntile(2)åˆ‡ç‰‡åä¸ºï¼ˆ1ï¼Œ1ï¼Œ1ï¼Œ2ï¼Œ2ï¼Œ2ï¼‰")]),t._v(" "),a("p",[a("strong",[t._v("1ï¼‰ç»Ÿè®¡æ‰€æœ‰äº§å“çš„å”®ä»·æ’å")])]),t._v(" "),a("p",[t._v("å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" product_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("product_type\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   RANK "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v(" \n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" sale_price \n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ranking\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcIbvWotv5dPNPl3nl6pS4ebpQuS1JlicFZoqqfhR6X8apPIMorsNiauB3g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[a("strong",[t._v("2ï¼‰ç»Ÿè®¡å„äº§å“ç±»å‹ä¸‹å„äº§å“çš„å”®ä»·æ’å")])]),t._v(" "),a("p",[t._v("å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" product_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("product_type\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   RANK "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v(" \n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" product_type \n     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" sale_price \n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ranking\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcIGZAscbb93FP0xeicSymgjlbFXqgrjaWLSAibDpyQMK012eu8cGVicO7iag/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[t._v("å¯¹æ¯”ä¸€ä¸‹"),a("strong",[t._v("dense_rankã€row_numberã€ntile")])]),t._v(" "),a("p",[t._v("å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" product_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("product_type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    RANK "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" ranking"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    DENSE_RANK "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" dense_ranking"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ROW_NUMBER "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" row_num"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ntile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" nt1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ntile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" nt2 \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("--åˆ‡ç‰‡å¤§äºæ€»è®°å½•æ•°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcInJSB4rR08GmViaL1E4gaqowE6cGhgBYK9GqSp2uWDO35DfFCAYq6N2g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[t._v("ä»ç»“æœå¯ä»¥å‘ç°ï¼Œ"),a("strong",[t._v("å½“ntile(30)ä¸­çš„åˆ‡ç‰‡å¤§äºäº†æ€»è®°å½•æ•°æ—¶ï¼Œåˆ‡ç‰‡çš„å€¼ä¸ºè®°å½•çš„åºå·")]),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"åºåˆ—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åºåˆ—"}},[t._v("#")]),t._v(" åºåˆ—")]),t._v(" "),a("p",[t._v("åºåˆ—ä¸­çš„ä¸¤ä¸ªçª—å£å‡½æ•°cume_distå’Œpercent_rankï¼Œé€šè¿‡å®ä¾‹æ¥çœ‹çœ‹å®ƒä»¬æ˜¯æ€ä¹ˆä½¿ç”¨çš„ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("1ï¼‰ç»Ÿè®¡å°äºç­‰äºå½“å‰å”®ä»·çš„äº§å“æ•°ï¼Œæ‰€å æ€»äº§å“æ•°çš„æ¯”ä¾‹")])]),t._v(" "),a("p",[t._v("å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" product_type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("product_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nCUME_DIST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" rn1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nCUME_DIST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" product_type \n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" sale_price\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" rn2 \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcIuEjibiaicGfsicbSwIjHTDZ5clDlLz3RBJ37x5hgJxxwMZ7z1aI88mUPiaw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[t._v("rn1: æ²¡æœ‰partition,æ‰€æœ‰æ•°æ®å‡ä¸º1ç»„ï¼Œæ€»è¡Œæ•°ä¸º8ï¼Œ")]),t._v(" "),a("p",[t._v("ç¬¬ä¸€è¡Œï¼šå°äºç­‰äº100çš„è¡Œæ•°ä¸º1ï¼Œå› æ­¤ï¼Œ1/8=0.125")]),t._v(" "),a("p",[t._v("ç¬¬äºŒè¡Œï¼šå°äºç­‰äº500çš„è¡Œæ•°ä¸º3ï¼Œå› æ­¤ï¼Œ3/8=0.375")]),t._v(" "),a("p",[t._v("rn2: æŒ‰ç…§äº§å“ç±»å‹åˆ†ç»„ï¼Œproduct_type=å¨æˆ¿ç”¨å“çš„è¡Œæ•°ä¸º4,")]),t._v(" "),a("p",[t._v("ç¬¬ä¸‰è¡Œï¼šå°äºç­‰äº500çš„è¡Œæ•°ä¸º1ï¼Œå› æ­¤ï¼Œ1/4=0.25")]),t._v(" "),a("p",[a("strong",[t._v("2ï¼‰ç»Ÿè®¡æ¯ä¸ªäº§å“çš„ç™¾åˆ†æ¯”æ’åº")])]),t._v(" "),a("p",[t._v("å½“å‰è¡Œçš„RANKå€¼-1/åˆ†ç»„å†…æ€»è¡Œæ•°-1")]),t._v(" "),a("p",[t._v("å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" product_type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("product_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\npercent_rank"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" sale_price"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" rn1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\npercent_rank"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("OVER")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PARTITION")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" product_type \n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" sale_price\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" rn2 \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" product"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/cge06IdYQydF9cXeWKNTs10PeDAk1ibcIB34GSHuib80LdoHVN0hEMAcAsVV2jZbibtkCEpRbB3qyCr7y2cQF7o2g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"å›¾ç‰‡"}})]),t._v(" "),a("p",[t._v("rn1: æ²¡æœ‰partition,æ‰€æœ‰æ•°æ®å‡ä¸º1ç»„ï¼Œæ€»è¡Œæ•°ä¸º8ï¼Œ")]),t._v(" "),a("p",[t._v("ç¬¬ä¸€è¡Œï¼šæ’åºä¸º1ï¼Œå› æ­¤ï¼Œï¼ˆ1-1ï¼‰/ï¼ˆ8-1ï¼‰= 0")]),t._v(" "),a("p",[t._v("ç¬¬äºŒè¡Œï¼šæ’åºä¸º2ï¼Œå› æ­¤ï¼Œï¼ˆ2-1ï¼‰/ï¼ˆ8-1ï¼‰= 0.14")]),t._v(" "),a("p",[t._v("rn2: æŒ‰ç…§äº§å“ç±»å‹åˆ†ç»„ï¼Œproduct_type=å¨æˆ¿ç”¨å“çš„è¡Œæ•°ä¸º4,")]),t._v(" "),a("p",[t._v("ç¬¬ä¸‰è¡Œï¼šæ’åºä¸º1ï¼Œå› æ­¤ï¼Œï¼ˆ1-1ï¼‰/ï¼ˆ4-1ï¼‰= 0")]),t._v(" "),a("p",[t._v("ç¬¬å››è¡Œï¼šæ’åºä¸º1ï¼Œå› æ­¤ï¼Œï¼ˆ2-1ï¼‰/ï¼ˆ4-1ï¼‰= 0.33")]),t._v(" "),a("p",[a("strong",[t._v("æ€»ç»“")])]),t._v(" "),a("p",[t._v("ä»¥ä¸Šä»‹ç»äº†Hiveä¸­çª—å£å‡½æ•°çš„å‡ ä¹æ‰€æœ‰çš„ä½¿ç”¨åœºæ™¯ï¼Œæ¯ç§å‡½æ•°çš„ç”¨æ³•ä¹Ÿé…åˆä»£ç è¿›è¡Œè®²è§£ã€‚ç›¸ä¿¡å¤§å®¶çœ‹äº†æœ¬æ–‡åï¼Œåœ¨å®é™…æ•°æ®å·¥ä½œä¸­å¯¹äºçª—å£å‡½æ•°çš„ä½¿ç”¨è‚¯å®šä¼šå¾—å¿ƒåº”æ‰‹ã€‚")])])}),[],!1,null,null,null);s.default=n.exports}}]);