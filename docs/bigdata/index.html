<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>《大数据技术原理与应用》阅读笔记 | 大数据技术文档</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="./favicon.ico">
    <meta name="description" content="从入门到入土">
    
    <link rel="preload" href="./assets/css/0.styles.cc3a5495.css" as="style"><link rel="preload" href="./assets/js/app.f579c1a5.js" as="script"><link rel="preload" href="./assets/js/2.9690451e.js" as="script"><link rel="preload" href="./assets/js/8.2ca9dce1.js" as="script"><link rel="prefetch" href="./assets/js/3.a0383da1.js"><link rel="prefetch" href="./assets/js/4.fbcf4621.js"><link rel="prefetch" href="./assets/js/5.b4f5880b.js"><link rel="prefetch" href="./assets/js/6.7a505dc8.js"><link rel="prefetch" href="./assets/js/7.1ebac3c6.js">
    <link rel="stylesheet" href="./assets/css/0.styles.cc3a5495.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><!----> <span class="site-name">大数据技术文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/./bigdata/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  大数据
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./java/" class="nav-link">
  Java基础语法
</a></li><li class="dropdown-subitem"><a href="/./java/" class="nav-link">
  Java基础实战
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./java/" class="nav-link">
  Java并发
</a></li><li class="dropdown-subitem"><a href="/./java/" class="nav-link">
  Java网络编程
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./bigdata/mysql.html" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/hbase.html" class="nav-link">
  HBase
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/clickhouse.html" class="nav-link">
  ClickHouse
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/tidb.html" class="nav-link">
  TiDB
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据框架" class="dropdown-title"><span class="title">大数据框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据框架" class="mobile-dropdown-title"><span class="title">大数据框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./bigdata/hadoop.html" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/spark.html" class="nav-link">
  Spark
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/flink.html" class="nav-link">
  Flink
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据组件" class="dropdown-title"><span class="title">大数据组件</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据组件" class="mobile-dropdown-title"><span class="title">大数据组件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./bigdata/hive.html" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/zookeeper.html" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/tidb.html" class="nav-link">
  kafka
</a></li></ul></div></div><div class="nav-item"><a href="https://www.memorydrive.online" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/./" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/./bigdata/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  大数据
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./java/" class="nav-link">
  Java基础语法
</a></li><li class="dropdown-subitem"><a href="/./java/" class="nav-link">
  Java基础实战
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./java/" class="nav-link">
  Java并发
</a></li><li class="dropdown-subitem"><a href="/./java/" class="nav-link">
  Java网络编程
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./bigdata/mysql.html" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/hbase.html" class="nav-link">
  HBase
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/clickhouse.html" class="nav-link">
  ClickHouse
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/tidb.html" class="nav-link">
  TiDB
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据框架" class="dropdown-title"><span class="title">大数据框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据框架" class="mobile-dropdown-title"><span class="title">大数据框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./bigdata/hadoop.html" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/spark.html" class="nav-link">
  Spark
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/flink.html" class="nav-link">
  Flink
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据组件" class="dropdown-title"><span class="title">大数据组件</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据组件" class="mobile-dropdown-title"><span class="title">大数据组件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./bigdata/hive.html" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/zookeeper.html" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/tidb.html" class="nav-link">
  kafka
</a></li></ul></div></div><div class="nav-item"><a href="https://www.memorydrive.online" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>《大数据技术原理与应用》阅读笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./bigdata/#第1章-大数据概述" class="sidebar-link">第1章 大数据概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./bigdata/#_1-2-大数据的概念" class="sidebar-link">1.2 大数据的概念</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_1-5-大数据关键技术" class="sidebar-link">1.5 大数据关键技术</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_1-6-大数据计算模式" class="sidebar-link">1.6 大数据计算模式</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_1-7-大数据产业" class="sidebar-link">1.7 大数据产业</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_1-8-大数据与云计算、物联网" class="sidebar-link">1.8 大数据与云计算、物联网</a></li></ul></li><li><a href="/./bigdata/#第2章-大数据处理架构hadoop" class="sidebar-link">第2章 大数据处理架构Hadoop</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./bigdata/#_2-1-概述" class="sidebar-link">2.1 概述</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_2-2-hadoop生态系统" class="sidebar-link">2.2 Hadoop生态系统</a></li></ul></li><li><a href="/./bigdata/#第3章-分布式文件系统hdfs" class="sidebar-link">第3章 分布式文件系统HDFS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./bigdata/#_3-1-分布式文件系统" class="sidebar-link">3.1 分布式文件系统</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_3-2-hdfs简介" class="sidebar-link">3.2 HDFS简介</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_3-3-hdfs的相关概念" class="sidebar-link">3.3 HDFS的相关概念</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_3-4-hdfs体系结构" class="sidebar-link">3.4 HDFS体系结构</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_3-5-hdfs的存储原理" class="sidebar-link">3.5 HDFS的存储原理</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_3-6-hdfs读写过程" class="sidebar-link">3.6 HDFS读写过程</a></li></ul></li><li><a href="/./bigdata/#第4章-分布式数据库hbase" class="sidebar-link">第4章 分布式数据库HBase</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./bigdata/#_4-1-概述" class="sidebar-link">4.1 概述</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_4-2-hbase访问" class="sidebar-link">4.2 HBase访问</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_4-3-hbase数据模型" class="sidebar-link">4.3 HBase数据模型</a></li><li class="sidebar-sub-header"><a href="/./bigdata/#_4-4-hbase的实现原理" class="sidebar-link">4.4 HBase的实现原理</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="《大数据技术原理与应用》阅读笔记"><a href="#《大数据技术原理与应用》阅读笔记" class="header-anchor">#</a> 《大数据技术原理与应用》阅读笔记</h1> <h2 id="第1章-大数据概述"><a href="#第1章-大数据概述" class="header-anchor">#</a> 第1章 大数据概述</h2> <h3 id="_1-2-大数据的概念"><a href="#_1-2-大数据的概念" class="header-anchor">#</a> 1.2 大数据的概念</h3> <p>大数据特点概括为4V：数据量大（Volume）、数据类型繁多（Variety）、处理速度快（Velocity）和价值密度低（Value）</p> <h3 id="_1-5-大数据关键技术"><a href="#_1-5-大数据关键技术" class="header-anchor">#</a> 1.5 大数据关键技术</h3> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211111162657.png" alt="大数据技术的不同层面及其功能"></p> <h3 id="_1-6-大数据计算模式"><a href="#_1-6-大数据计算模式" class="header-anchor">#</a> 1.6 大数据计算模式</h3> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211111162748.png" alt="大数据计算模式及其代表产品"></p> <h3 id="_1-7-大数据产业"><a href="#_1-7-大数据产业" class="header-anchor">#</a> 1.7 大数据产业</h3> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211111162837.png" alt="大数据产业链的各个环节"></p> <h3 id="_1-8-大数据与云计算、物联网"><a href="#_1-8-大数据与云计算、物联网" class="header-anchor">#</a> 1.8 大数据与云计算、物联网</h3> <h4 id="_1-8-1-云计算"><a href="#_1-8-1-云计算" class="header-anchor">#</a> 1.8.1 云计算</h4> <p>云计算包括三种典型的服务模式，如图：</p> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211111162950.png" alt=""></p> <ul><li>云计算的关键技术
<ol><li>虚拟化</li> <li>分布式存储</li> <li>分布式计算</li> <li>多租户</li></ol></li></ul> <h4 id="_1-8-2-物联网"><a href="#_1-8-2-物联网" class="header-anchor">#</a> 1.8.2 物联网</h4> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211111163237.png" alt="物联网体系架构"></p> <h2 id="第2章-大数据处理架构hadoop"><a href="#第2章-大数据处理架构hadoop" class="header-anchor">#</a> 第2章 大数据处理架构Hadoop</h2> <h3 id="_2-1-概述"><a href="#_2-1-概述" class="header-anchor">#</a> 2.1 概述</h3> <p>Hadoop的核心是HDFS 和 MapReduce，分别用于存储和计算（Hadoop 2.x版本开始增加了一个叫 yarn 的资源调度器）</p> <ul><li>Hadoop特性：
<ul><li>高可靠性</li> <li>高效性</li> <li>高可扩展性</li> <li>高容错性</li> <li>成本低</li> <li>支持多种编程语言</li></ul></li></ul> <h3 id="_2-2-hadoop生态系统"><a href="#_2-2-hadoop生态系统" class="header-anchor">#</a> 2.2 Hadoop生态系统</h3> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211111163757.png" alt="Hadoop生态系统"></p> <h4 id="_2-2-1-hdfs"><a href="#_2-2-1-hdfs" class="header-anchor">#</a> 2.2.1 HDFS</h4> <p>Hadoop分布式文件系统（Hadoop Distributed File System，HDFS）是Hadoop项目的两大核心之一，HDFS 在设计之初就是要运行在廉价的大型服务器集群上，因而具备高容错性（在保证在部分硬件发生故障的情况下仍然能够保证文件系统的整体可用性和可靠性）</p> <h4 id="_2-2-2-hbase"><a href="#_2-2-2-hbase" class="header-anchor">#</a> 2.2.2 HBase</h4> <p>HBase是一个提供高可靠性、高性能、可伸缩、实时读写、分布式的列式数据库，一般采用HDFS作为其底层数据存储（ HBase 只是一个分布式高并发 k-v 存储系统，通常底层的文件系统用HDFS来支持，类似MySQL需要电脑本地磁盘对其支持）。</p> <h4 id="_2-2-3-mapreduce"><a href="#_2-2-3-mapreduce" class="header-anchor">#</a> 2.2.3 MapReduce</h4> <p>MapReduce是Hadoop项目的两大核心之一，它是一种将数据“分而治之”的编程模型，通常用于大规模数据集（大于1TB）的并行运算。</p> <h4 id="_2-2-4-hive"><a href="#_2-2-4-hive" class="header-anchor">#</a> 2.2.4 Hive</h4> <p>Hive是一个基于Hadoop的数据仓库工具，可以用于对Hadoop文件中的数据集进行数据查询和读写。</p> <p>Hive提供了将类似SQL的语句——Hive SQL转换为MapReduce的接口，所以有了Hive就省得写MapReduce了。</p> <h4 id="_2-2-5-pig"><a href="#_2-2-5-pig" class="header-anchor">#</a> 2.2.5 Pig</h4> <p>类似Hive，已被淘汰</p> <h4 id="_2-2-6-mahout"><a href="#_2-2-6-mahout" class="header-anchor">#</a> 2.2.6 Mahout</h4> <p>已被淘汰，目前较多用Spark ML</p> <h4 id="_2-2-7-zookeeper"><a href="#_2-2-7-zookeeper" class="header-anchor">#</a> 2.2.7 Zookeeper</h4> <p>Zookeeper是一个开源的分布式应用程序协调服务，提供分布式锁之类的基本服务（如统一命名服务、状态同步服务、集群管理、分布式应用配置项的管理等），用于构建分布式应用，减轻分布式应用程序所承担的协调任务。</p> <h4 id="_2-2-8-flume"><a href="#_2-2-8-flume" class="header-anchor">#</a> 2.2.8 Flume</h4> <p>高可用的分布式日志采集系统</p> <h4 id="_2-2-9-sqoop"><a href="#_2-2-9-sqoop" class="header-anchor">#</a> 2.2.9 Sqoop</h4> <p>Sqoop是个数据采集工具（但是跟Flume不一样），它可以将数据从MySQL、Oracle、PostgreSQL等关系型数据库中导入HDFS / HBase / Hive</p> <h2 id="第3章-分布式文件系统hdfs"><a href="#第3章-分布式文件系统hdfs" class="header-anchor">#</a> 第3章 分布式文件系统HDFS</h2> <h3 id="_3-1-分布式文件系统"><a href="#_3-1-分布式文件系统" class="header-anchor">#</a> 3.1 分布式文件系统</h3> <p>分布式文件系统是一种通过<strong>网络</strong>实现文件在多台主机上进行存储文件系统，其设计一般采用“客户端/服务器”（Client/Server）模式，客户端以特定的通信协议通过网络与服务器建立连接，提出文件访问请求，服务器可以通过设置访问权来限制请求方对底层数据存储块的访问。</p> <h4 id="_3-1-1-计算机集群结构"><a href="#_3-1-1-计算机集群结构" class="header-anchor">#</a> 3.1.1 计算机集群结构</h4> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211111165728.png" alt="计算机集群的基本架构"></p> <h4 id="_3-1-2-分布式文件系统的结构"><a href="#_3-1-2-分布式文件系统的结构" class="header-anchor">#</a> 3.1.2 分布式文件系统的结构</h4> <p>分布式文件系统采用了块的概念，文件通常被分层若干个块进行存储（如果一个块就够了那就一个块），Hadoop 1.x版本中HDFS的块默认大小是64MB（Hadoop 2.x版本中HDFS的块默认大小是128MB）。</p> <blockquote><p>注意：如果一个文件小于一个数据块的大小，它并不占用整个数据块的存储空间。（比如一个文件52MB，那这个文件就只占用54MB，而不是占用64MB）</p></blockquote> <p>分布式文件系统在物理结构上是由计算机集群中的多个节点构成的，这些节点分为两类：一类叫<strong>NameNode</strong>（或MasterNode，写成“<code>主节点</code>”或“名称节点”）；另一类叫<strong>DataNode</strong>（或SlaveNode，写成“从节点”或“<code>数据节点</code>”）。</p> <ul><li>NameNode的工作：
<ul><li>文件和目录的创建、删除和重命名</li> <li>管理DataNode和文件块的映射关系（所以客户端拉取文件块得访问DataNode）</li> <li>分配存储关系</li> <li>接收并处理客户端的请求</li></ul></li></ul> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211111170223.png" alt="大规模文件系统的整体结构"></p> <p>分布式文件系统除了HDFS以外，还有其他的，上述讲的是比较经典的分布式文件系统的结构，HDFS也符合上述模式。</p> <h3 id="_3-2-hdfs简介"><a href="#_3-2-hdfs简介" class="header-anchor">#</a> 3.2 HDFS简介</h3> <ul><li><p>HDFS优点：</p> <ul><li>兼容廉价的硬件设备</li> <li>流数据读写（即批量数据处理）</li> <li>大数据集</li> <li>简单的文件模型</li> <li>强大的跨平台兼容性</li></ul></li> <li><p>HDFS缺点：</p> <ul><li>不适合低延迟数据访问（批处理适合处理大数据集，不适合低延迟）</li> <li>无法高校存储大量小文件（每个小文件都会占用NameNode一定的存储空间）</li> <li>不支持多用户写入及任意修改文件（HDFS只允许一个文件有一个写入者，而且只允许对文件执行追加操作，不能执行随机写操作。）</li></ul></li></ul> <h3 id="_3-3-hdfs的相关概念"><a href="#_3-3-hdfs的相关概念" class="header-anchor">#</a> 3.3 HDFS的相关概念</h3> <h4 id="_3-3-1-块"><a href="#_3-3-1-块" class="header-anchor">#</a> 3.3.1 块</h4> <p>传统的文件系统中，为了提高读写效率，一般以<strong>数据块</strong>为单位，而不是以字节为单位。</p> <p>比如机械硬盘包含了磁头和转动部件，数据读取时有个寻道的过程，通过转动盘片和移动磁头的位置，来找数据在机械硬盘中的存储位置，然后才能进行读写。</p> <h4 id="_3-3-2-namenode和datanode"><a href="#_3-3-2-namenode和datanode" class="header-anchor">#</a> 3.3.2 NameNode和DataNode</h4> <p>HDFS负责管理分布式文件系统的命名空间（NameSpace），保留了两个核心的数据结构（FsImage和EditLog），如图：</p> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211111200025.png" width="60%"></p> <blockquote><ul><li>FsImage用于维护文件系统树以及文件树中所有的文件和文件夹的元数据</li> <li>EditLog中记录了所有针对文件的创建、删除、重命名等操作。</li></ul></blockquote> <p><code>第一阶段</code>：NameNode启动</p> <ol><li>第一次启动NameNode格式化后，创建FsImage和EditsLog。如果不是第一次启动，直接加载这两个文件到内存；</li> <li>客户端对元数据进行增删改的请求；</li> <li>NameNode记录操作日志，更新滚动日志；</li> <li>NameNode在内存中对元数据进行增删改。</li></ol> <h4 id="_3-3-3-secondary-namenode"><a href="#_3-3-3-secondary-namenode" class="header-anchor">#</a> 3.3.3 Secondary NameNode</h4> <p>HDFS不断发生更新操作，EditLog会越来越大，此时需有第二阶段，具体过程如下（合并逻辑不复杂，但是流程上文字看着挺多，所以建议直接看图），如图（图中EditLog写成了Edits）：</p> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211111210020.png" alt="NN和2NN的工作机制"></p> <p>上图文字描述如下：</p> <p><code>第二阶段</code>：Secondary NameNode工作</p> <ol><li>Secondary NameNode询问NameNode是否需要CheckPoint（检查点），带回NameNode检查结果；</li> <li>Secondary NameNode请求执行CheckPoint；</li> <li>NameNode滚动正在写的EditLog；</li> <li>将滚动的EditLog和FsImage拷贝到Secondary NameNode；</li> <li>Secondary NameNode加载EditLog到内存合并；</li> <li>生成新的镜像文件FsImage.chkpoint；</li> <li>拷贝FsImage.chkpoint到NameNode；</li> <li>NameNode将FsImage.chkpoint重命名为FsImage</li></ol> <h3 id="_3-4-hdfs体系结构"><a href="#_3-4-hdfs体系结构" class="header-anchor">#</a> 3.4 HDFS体系结构</h3> <p>HDFS采用了主从（Master/Slave）结构模型，一个HDFS集群包括一个NameNode和若干个DataNode，如图：</p> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211111220051.png" alt="HDFS的体系结构"></p> <blockquote><p>每个DataNode会周期性地向NameNode发送“心跳”信息，报告自己的状态，没有按时发送心跳信息的数据节点会被标记为“宕机”，不会再给它分配任何I/O请求。</p></blockquote> <h3 id="_3-5-hdfs的存储原理"><a href="#_3-5-hdfs的存储原理" class="header-anchor">#</a> 3.5 HDFS的存储原理</h3> <h4 id="_3-5-1-数据的冗余存储"><a href="#_3-5-1-数据的冗余存储" class="header-anchor">#</a> 3.5.1 数据的冗余存储</h4> <p>HDFS默认3个副本</p> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211113144146.png" alt="HDFS数据块多副本存储"></p> <p>多副本存储具有以下优点：</p> <ul><li>加快数据的传输速度（客户端从不同的数据块副本中同时读取数据）</li> <li>容易检查数据错误（多个副本容易判断数据传输是否出错）</li> <li>保证数据的可靠性（某个节点出故障不会造成数据丢失）</li></ul> <h4 id="_3-5-2-数据存取策略"><a href="#_3-5-2-数据存取策略" class="header-anchor">#</a> 3.5.2 数据存取策略</h4> <ul><li><p>数据存放</p> <p>两份副本放在同一个机架不同机器上，第三个副本放在不同机架上</p> <p>（两个副本很近保证了数据读写性能，另一个副本在不同机架保证了机架发生异常时的数据恢复）</p></li> <li><p>数据读取</p> <p>HDFS有个API可获得机架ID，客户端也有个自己所属的机架ID。当读取数据时，如果客户端发现有跟自己一致的机架ID，就优先读取那个机架上的副本，如果没有就随机读取一个副本。</p></li> <li><p>数据复制</p> <p>客户端只跟一个节点连接，第二个节点跟第一个节点建立连接，第三个节点跟第二个节点建立连接，完成建立连接后开始读取/写入数据</p></li></ul> <h4 id="_3-5-3-数据错误与恢复"><a href="#_3-5-3-数据错误与恢复" class="header-anchor">#</a> 3.5.3 数据错误与恢复</h4> <ul><li><p>NameNode出错</p> <p>NameNode保存了所有的元数据信息，其核心数据结构是FsImage和EditLog，如果这两个文件发生损坏那么HDFS集群就会出问题。所以会有针对这两个的安全保证和补救措施。</p> <ol><li>NameNode的元数据同步存储到其他文件系统（例如远程挂载的网络文件系统NFS）</li> <li>运行一个Secondary NameNode（但是这个仍然会丢失一部分数据，因为Secondary NameNode比 NameNode迟了一步）</li></ol></li> <li><p>DataNode出错</p> <p>如果NameNode收不到DataNode的“心跳”了，很可能就是DataNode挂了（当然也有DataNode没挂，是别的问题导致NameNode没收到“心跳”）</p> <p>因为有三个副本，所以DataNode挂了一个问题不大</p></li> <li><p>数据出错</p> <p>网络传输和磁盘错误等因素都会造成数据错误，所以客户端读取数据一般要采用md5和sha1对数据块进行校验。</p> <p>如果校验出错，客户端会请求到另外一个DataNode读取该文件块，并向NameNode报告这个文件块有误，NameNode会定期检查并复制这个文件块。</p> <blockquote><p>一个文件块一般包含多个数据块</p></blockquote></li></ul> <h3 id="_3-6-hdfs读写过程"><a href="#_3-6-hdfs读写过程" class="header-anchor">#</a> 3.6 HDFS读写过程</h3> <ul><li><p>HDFS读流程</p> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211113144232.png" alt="HDFS读流程"></p></li> <li><p>HDFS写流程</p> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211113144105.png" alt="HDFS写流程"></p></li></ul> <h2 id="第4章-分布式数据库hbase"><a href="#第4章-分布式数据库hbase" class="header-anchor">#</a> 第4章 分布式数据库HBase</h2> <h3 id="_4-1-概述"><a href="#_4-1-概述" class="header-anchor">#</a> 4.1 概述</h3> <p>HBase是一个高可靠、高性能、面向列、可伸缩的分布式数据库</p> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211113144426.png" alt="Hadoop生态系统中HBase与其他部分的关系"></p> <h3 id="_4-2-hbase访问"><a href="#_4-2-hbase访问" class="header-anchor">#</a> 4.2 HBase访问</h3> <p>HBase提高了好几种接口，一般用 Java 或 Shell 或 Hive</p> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211113144601.png" alt="HBase访问接口"></p> <h3 id="_4-3-hbase数据模型"><a href="#_4-3-hbase数据模型" class="header-anchor">#</a> 4.3 HBase数据模型</h3> <p>HBase是一个<strong>稀疏</strong>、<strong>多维度</strong>、<strong>排序</strong>的映射表，这张表的索引是行键、列族、列限定符和时间戳。</p> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/20211113202039.png" alt="HBase数据模型的一个实例"></p> <h3 id="_4-4-hbase的实现原理"><a href="#_4-4-hbase的实现原理" class="header-anchor">#</a> 4.4 HBase的实现原理</h3> <h4 id="_4-4-1-hbase的功能组件"><a href="#_4-4-1-hbase的功能组件" class="header-anchor">#</a> 4.4.1 HBase的功能组件</h4> <p>HBase的实现包括3个主要的功能组件：<strong>库函数</strong>，链接到每个客户端；<strong>一个Master主服务器</strong>；<strong>许多个Region服务器</strong>。</p> <h4 id="_4-4-2-表和region"><a href="#_4-4-2-表和region" class="header-anchor">#</a> 4.4.2 表和Region</h4> <p>一个HBase存储了很多表，其表中的行是根据<strong>行键</strong>值的字典序进行维护的，表中包含的行数量可能非常庞大，无法存储在一台机器上。因此，需要根据行键的值对表进行分区，如图：</p> <p><img src="https://cdn.jsdelivr.net/gh/ChoiNgai/ImageServer/img/image-20211125134609771.png" alt="HBase中一张表被划分成多个Region"></p> <p>每个行区间构成一个分区，被称为“Region”，包含了位于某个值域区间内的所有数据，它是负载均衡和数据分发的基本单位，这些Region会被分发到不同的Region服务器上。</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="./assets/js/app.f579c1a5.js" defer></script><script src="./assets/js/2.9690451e.js" defer></script><script src="./assets/js/8.2ca9dce1.js" defer></script>
  </body>
</html>
