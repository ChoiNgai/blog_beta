<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>结果 | 大数据技术文档</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="./favicon.ico">
    <meta name="description" content="从入门到入土">
    
    <link rel="preload" href="./assets/css/0.styles.e88c5000.css" as="style"><link rel="preload" href="./assets/js/app.8f846374.js" as="script"><link rel="preload" href="./assets/js/2.47c06342.js" as="script"><link rel="preload" href="./assets/js/79.89cb870d.js" as="script"><link rel="prefetch" href="./assets/js/10.ef98acb1.js"><link rel="prefetch" href="./assets/js/100.441528ba.js"><link rel="prefetch" href="./assets/js/101.e4e38e24.js"><link rel="prefetch" href="./assets/js/102.c7d8d043.js"><link rel="prefetch" href="./assets/js/103.fab94ea6.js"><link rel="prefetch" href="./assets/js/104.68e04f80.js"><link rel="prefetch" href="./assets/js/105.198c6758.js"><link rel="prefetch" href="./assets/js/106.6258b526.js"><link rel="prefetch" href="./assets/js/107.1585c4c3.js"><link rel="prefetch" href="./assets/js/108.6b62e303.js"><link rel="prefetch" href="./assets/js/109.b2d58d90.js"><link rel="prefetch" href="./assets/js/11.24e5d745.js"><link rel="prefetch" href="./assets/js/110.ded9aecf.js"><link rel="prefetch" href="./assets/js/111.6c292e59.js"><link rel="prefetch" href="./assets/js/112.6c99b5d2.js"><link rel="prefetch" href="./assets/js/113.5bd0fb72.js"><link rel="prefetch" href="./assets/js/114.e9fa34e1.js"><link rel="prefetch" href="./assets/js/115.d1c79025.js"><link rel="prefetch" href="./assets/js/116.350c9554.js"><link rel="prefetch" href="./assets/js/117.92917110.js"><link rel="prefetch" href="./assets/js/118.61f93307.js"><link rel="prefetch" href="./assets/js/119.34185e70.js"><link rel="prefetch" href="./assets/js/12.8b71ea83.js"><link rel="prefetch" href="./assets/js/120.7e1b1c7d.js"><link rel="prefetch" href="./assets/js/121.d8c00252.js"><link rel="prefetch" href="./assets/js/122.174db881.js"><link rel="prefetch" href="./assets/js/13.71347b8e.js"><link rel="prefetch" href="./assets/js/14.f053f94e.js"><link rel="prefetch" href="./assets/js/15.a024878c.js"><link rel="prefetch" href="./assets/js/16.81e7c28f.js"><link rel="prefetch" href="./assets/js/17.f11221ce.js"><link rel="prefetch" href="./assets/js/18.fe832c69.js"><link rel="prefetch" href="./assets/js/19.14c224c1.js"><link rel="prefetch" href="./assets/js/20.fcbc42d2.js"><link rel="prefetch" href="./assets/js/21.07886cc2.js"><link rel="prefetch" href="./assets/js/22.ac5835a0.js"><link rel="prefetch" href="./assets/js/23.5fcce455.js"><link rel="prefetch" href="./assets/js/24.6884809e.js"><link rel="prefetch" href="./assets/js/25.81d9ed9d.js"><link rel="prefetch" href="./assets/js/26.4729386e.js"><link rel="prefetch" href="./assets/js/27.8b2ea903.js"><link rel="prefetch" href="./assets/js/28.ffb9e9e1.js"><link rel="prefetch" href="./assets/js/29.4d4e061f.js"><link rel="prefetch" href="./assets/js/3.6d4ee76d.js"><link rel="prefetch" href="./assets/js/30.649421e8.js"><link rel="prefetch" href="./assets/js/31.b1265e4d.js"><link rel="prefetch" href="./assets/js/32.e19607e8.js"><link rel="prefetch" href="./assets/js/33.f7352c75.js"><link rel="prefetch" href="./assets/js/34.ea398359.js"><link rel="prefetch" href="./assets/js/35.60e46ee5.js"><link rel="prefetch" href="./assets/js/36.7ccb9a0c.js"><link rel="prefetch" href="./assets/js/37.47bf640d.js"><link rel="prefetch" href="./assets/js/38.11987f44.js"><link rel="prefetch" href="./assets/js/39.694eb4c0.js"><link rel="prefetch" href="./assets/js/4.6d1a6719.js"><link rel="prefetch" href="./assets/js/40.5db21ed8.js"><link rel="prefetch" href="./assets/js/41.78eb9a93.js"><link rel="prefetch" href="./assets/js/42.8369c775.js"><link rel="prefetch" href="./assets/js/43.19966b90.js"><link rel="prefetch" href="./assets/js/44.40e6834e.js"><link rel="prefetch" href="./assets/js/45.fbcb566b.js"><link rel="prefetch" href="./assets/js/46.1c3578fb.js"><link rel="prefetch" href="./assets/js/47.8287576d.js"><link rel="prefetch" href="./assets/js/48.317886b4.js"><link rel="prefetch" href="./assets/js/49.1be89a8c.js"><link rel="prefetch" href="./assets/js/5.c4786839.js"><link rel="prefetch" href="./assets/js/50.74e50bd1.js"><link rel="prefetch" href="./assets/js/51.6d431141.js"><link rel="prefetch" href="./assets/js/52.f8793ffe.js"><link rel="prefetch" href="./assets/js/53.ef8ac10b.js"><link rel="prefetch" href="./assets/js/54.72c2b12d.js"><link rel="prefetch" href="./assets/js/55.c35687b6.js"><link rel="prefetch" href="./assets/js/56.394b272d.js"><link rel="prefetch" href="./assets/js/57.08adde98.js"><link rel="prefetch" href="./assets/js/58.ae73d05f.js"><link rel="prefetch" href="./assets/js/59.3c851064.js"><link rel="prefetch" href="./assets/js/6.81b9d3e2.js"><link rel="prefetch" href="./assets/js/60.8c9de55a.js"><link rel="prefetch" href="./assets/js/61.140bed1c.js"><link rel="prefetch" href="./assets/js/62.62ad7beb.js"><link rel="prefetch" href="./assets/js/63.a36440f0.js"><link rel="prefetch" href="./assets/js/64.35625546.js"><link rel="prefetch" href="./assets/js/65.42445eda.js"><link rel="prefetch" href="./assets/js/66.47de6720.js"><link rel="prefetch" href="./assets/js/67.55b1a47f.js"><link rel="prefetch" href="./assets/js/68.f669ae1e.js"><link rel="prefetch" href="./assets/js/69.6d2b7f97.js"><link rel="prefetch" href="./assets/js/7.4a7a55b6.js"><link rel="prefetch" href="./assets/js/70.8c200ec3.js"><link rel="prefetch" href="./assets/js/71.ae918c22.js"><link rel="prefetch" href="./assets/js/72.77638b47.js"><link rel="prefetch" href="./assets/js/73.5820126f.js"><link rel="prefetch" href="./assets/js/74.5b03441d.js"><link rel="prefetch" href="./assets/js/75.1db27768.js"><link rel="prefetch" href="./assets/js/76.b5fec7d3.js"><link rel="prefetch" href="./assets/js/77.ddf1963b.js"><link rel="prefetch" href="./assets/js/78.0573ead9.js"><link rel="prefetch" href="./assets/js/8.fde5124b.js"><link rel="prefetch" href="./assets/js/80.04f05126.js"><link rel="prefetch" href="./assets/js/81.033f3b11.js"><link rel="prefetch" href="./assets/js/82.4c05f3e6.js"><link rel="prefetch" href="./assets/js/83.55a565c7.js"><link rel="prefetch" href="./assets/js/84.ec4bbf04.js"><link rel="prefetch" href="./assets/js/85.fbfb2605.js"><link rel="prefetch" href="./assets/js/86.d726556c.js"><link rel="prefetch" href="./assets/js/87.cc22e8af.js"><link rel="prefetch" href="./assets/js/88.1cff7c6b.js"><link rel="prefetch" href="./assets/js/89.6def5b33.js"><link rel="prefetch" href="./assets/js/9.e0237b05.js"><link rel="prefetch" href="./assets/js/90.7146fddb.js"><link rel="prefetch" href="./assets/js/91.737708a2.js"><link rel="prefetch" href="./assets/js/92.c85d8205.js"><link rel="prefetch" href="./assets/js/93.828ef430.js"><link rel="prefetch" href="./assets/js/94.4bc2cf6c.js"><link rel="prefetch" href="./assets/js/95.31860134.js"><link rel="prefetch" href="./assets/js/96.25f4a4ac.js"><link rel="prefetch" href="./assets/js/97.9aa011ad.js"><link rel="prefetch" href="./assets/js/98.53797f3a.js"><link rel="prefetch" href="./assets/js/99.20145e16.js">
    <link rel="stylesheet" href="./assets/css/0.styles.e88c5000.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><!----> <span class="site-name">大数据技术文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程基础" class="dropdown-title"><span class="title">编程基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程基础" class="mobile-dropdown-title"><span class="title">编程基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./coding-base/java基础语法/" class="nav-link">
  Java基础语法
</a></li><li class="dropdown-subitem"><a href="/./coding-base/" class="nav-link">
  Java基础实战
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶(选学)
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./coding-base/java并发编程/java并发编程.html" class="nav-link">
  Java并发编程
</a></li><li class="dropdown-subitem"><a href="/./coding-base/" class="nav-link">
  Java网络编程
</a></li><li class="dropdown-subitem"><a href="/./coding-base/java集合/Java集合（永盛）.html" class="nav-link">
  Java集合
</a></li><li class="dropdown-subitem"><a href="/./coding-base/java虚拟机/" class="nav-link">
  Java虚拟机
</a></li></ul></li><li class="dropdown-item"><h4>
          计算机基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./coding-base/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-subitem"><a href="/./coding-base/数据结构与算法/" class="nav-link">
  数据结构（重要）
</a></li><li class="dropdown-subitem"><a href="/./coding-base/计算机网络/计算机网络（双祥）.html" class="nav-link">
  计算机网络
</a></li><li class="dropdown-subitem"><a href="/./coding-base/操作系统/" class="nav-link">
  操作系统
</a></li></ul></li><li class="dropdown-item"><h4>
          Python（选学）
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./coding-base/Python/python基础/" class="nav-link">
  Python基础语法
</a></li><li class="dropdown-subitem"><a href="/./coding-base/Python/python库/" class="nav-link">
  Python数据科学库
</a></li></ul></li><li class="dropdown-item"><h4>
          框架（选学）
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./coding-base/框架/springboot/springboot.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/./coding-base/框架/flask/falsk.html" class="nav-link">
  Flask
</a></li><li class="dropdown-subitem"><a href="/./coding-base/框架/vue/flask.html" class="nav-link">
  Vue
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./database/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/./database/hbase/" class="nav-link">
  HBase
</a></li><li class="dropdown-item"><!----> <a href="/./database/tidb/" class="nav-link">
  TiDB
</a></li><li class="dropdown-item"><!----> <a href="/./database/clickhouse/" class="nav-link">
  ClickHouse
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据仓库" class="dropdown-title"><span class="title">数据仓库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据仓库" class="mobile-dropdown-title"><span class="title">数据仓库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./datahouse/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/./datahouse/大数据基础/bigdata-base.html" class="nav-link">
  大数据基础
</a></li><li class="dropdown-item"><!----> <a href="/./datahouse/离线数仓/" class="nav-link">
  离线数仓
</a></li><li class="dropdown-item"><!----> <a href="/./datahouse/实时数仓/" class="nav-link">
  实时数仓
</a></li><li class="dropdown-item"><!----> <a href="/./datahouse/广告技术/" class="nav-link">
  广告技术
</a></li><li class="dropdown-item"><!----> <a href="/./datahouse/电商业务/" class="nav-link">
  电商业务
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据框架及组件" class="dropdown-title"><span class="title">大数据框架及组件</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据框架及组件" class="mobile-dropdown-title"><span class="title">大数据框架及组件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./bigdata/hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/hive/" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/zookeeper/" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/kafka/" class="nav-link">
  kafka
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/spark/" class="nav-link">
  Spark
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/flink/" class="nav-link">
  Flink
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./other/面经/" class="nav-link">
  面经
</a></li><li class="dropdown-item"><!----> <a href="/./other/机器学习/" class="nav-link">
  机器学习
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/./" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程基础" class="dropdown-title"><span class="title">编程基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="编程基础" class="mobile-dropdown-title"><span class="title">编程基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Java基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./coding-base/java基础语法/" class="nav-link">
  Java基础语法
</a></li><li class="dropdown-subitem"><a href="/./coding-base/" class="nav-link">
  Java基础实战
</a></li></ul></li><li class="dropdown-item"><h4>
          Java进阶(选学)
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./coding-base/java并发编程/java并发编程.html" class="nav-link">
  Java并发编程
</a></li><li class="dropdown-subitem"><a href="/./coding-base/" class="nav-link">
  Java网络编程
</a></li><li class="dropdown-subitem"><a href="/./coding-base/java集合/Java集合（永盛）.html" class="nav-link">
  Java集合
</a></li><li class="dropdown-subitem"><a href="/./coding-base/java虚拟机/" class="nav-link">
  Java虚拟机
</a></li></ul></li><li class="dropdown-item"><h4>
          计算机基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./coding-base/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-subitem"><a href="/./coding-base/数据结构与算法/" class="nav-link">
  数据结构（重要）
</a></li><li class="dropdown-subitem"><a href="/./coding-base/计算机网络/计算机网络（双祥）.html" class="nav-link">
  计算机网络
</a></li><li class="dropdown-subitem"><a href="/./coding-base/操作系统/" class="nav-link">
  操作系统
</a></li></ul></li><li class="dropdown-item"><h4>
          Python（选学）
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./coding-base/Python/python基础/" class="nav-link">
  Python基础语法
</a></li><li class="dropdown-subitem"><a href="/./coding-base/Python/python库/" class="nav-link">
  Python数据科学库
</a></li></ul></li><li class="dropdown-item"><h4>
          框架（选学）
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/./coding-base/框架/springboot/springboot.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/./coding-base/框架/flask/falsk.html" class="nav-link">
  Flask
</a></li><li class="dropdown-subitem"><a href="/./coding-base/框架/vue/flask.html" class="nav-link">
  Vue
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./database/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/./database/hbase/" class="nav-link">
  HBase
</a></li><li class="dropdown-item"><!----> <a href="/./database/tidb/" class="nav-link">
  TiDB
</a></li><li class="dropdown-item"><!----> <a href="/./database/clickhouse/" class="nav-link">
  ClickHouse
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据仓库" class="dropdown-title"><span class="title">数据仓库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据仓库" class="mobile-dropdown-title"><span class="title">数据仓库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./datahouse/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/./datahouse/大数据基础/bigdata-base.html" class="nav-link">
  大数据基础
</a></li><li class="dropdown-item"><!----> <a href="/./datahouse/离线数仓/" class="nav-link">
  离线数仓
</a></li><li class="dropdown-item"><!----> <a href="/./datahouse/实时数仓/" class="nav-link">
  实时数仓
</a></li><li class="dropdown-item"><!----> <a href="/./datahouse/广告技术/" class="nav-link">
  广告技术
</a></li><li class="dropdown-item"><!----> <a href="/./datahouse/电商业务/" class="nav-link">
  电商业务
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据框架及组件" class="dropdown-title"><span class="title">大数据框架及组件</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据框架及组件" class="mobile-dropdown-title"><span class="title">大数据框架及组件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./bigdata/hadoop/" class="nav-link">
  Hadoop
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/hive/" class="nav-link">
  Hive
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/zookeeper/" class="nav-link">
  Zookeeper
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/kafka/" class="nav-link">
  kafka
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/spark/" class="nav-link">
  Spark
</a></li><li class="dropdown-item"><!----> <a href="/./bigdata/flink/" class="nav-link">
  Flink
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./other/面经/" class="nav-link">
  面经
</a></li><li class="dropdown-item"><!----> <a href="/./other/机器学习/" class="nav-link">
  机器学习
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>实时数仓</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./datahouse/实时数仓/实时数仓.html" class="sidebar-link">实时数仓</a></li><li><a href="/./datahouse/%E5%AE%9E%E6%97%B6%E6%95%B0%E4%BB%93/" aria-current="page" class="sidebar-link">目录</a></li><li><a href="/./datahouse/实时数仓/CK+TIDB实时多维度OLAP场景应用(1).html" class="sidebar-link">实时读方案</a></li><li><a href="/./datahouse/实时数仓/CK+TIDB实时多维度OLAP场景应用(2).html" class="sidebar-link">ck机器配置</a></li><li><a href="/./datahouse/实时数仓/Clickhouse 读并发压测.html" class="active sidebar-link">结果</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./datahouse/实时数仓/Clickhouse 读并发压测.html#一亿表" class="sidebar-link">一亿表：</a></li></ul></li><li><a href="/./datahouse/实时数仓/Clickhouse查询响应测试.html" class="sidebar-link">分区&amp;索引键</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="结果"><a href="#结果" class="header-anchor">#</a> 结果</h1> <p>2021-08-09  Linux表，表数据 = 111623880，月表
PARTITION BY <em>toYYYYMM</em>(orders_create_time)
ORDER BY (store_id, product_sku)
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628493521373-6515fda8-b1f7-43c8-b00e-1ebf1f6a5883.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=115&amp;id=u495bf20e&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=115&amp;originWidth=156&amp;originalType=binary&amp;ratio=1&amp;size=3006&amp;status=done&amp;style=none&amp;taskId=ufb445e83-b710-409b-b5bb-20f7f58efa7&amp;width=156" alt="image.png"></p> <table><thead><tr><th>测试内容</th> <th>表名</th> <th>数据量</th> <th>查询语句</th> <th>线程数</th> <th>QPS</th> <th>单挑查询时间</th> <th>异常率</th> <th>环境</th></tr></thead> <tbody><tr><td>一亿表30天单个sku查询</td> <td>sku_data_all_16</td> <td>10000W</td> <td>SELECT count(1)from sku_data_all_16 where store_id = '${storeId}' and product_sku= '${productSku}' and toDate(orders_create_time) between '2021-07-01' and '2021-07-31';</td> <td>90</td> <td>545/sec</td> <td>376ms</td> <td>​</td> <td></td></tr> <tr><td>Linux</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>一亿表30天单个sku查询（跨月）</td> <td>sku_data_all_16</td> <td>10000W</td> <td>SELECT count(1)from sku_data_all_16 where store_id = '${storeId}' and product_sku= '${productSku}' and toDate(orders_create_time) between '2021-07-05' and '2021-08-05';</td> <td>90</td> <td>390/sec</td> <td>382ms</td> <td>​</td> <td></td></tr> <tr><td>Linux</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>一亿表90天单个sku查询</td> <td>sku_data_all_16</td> <td>10000W</td> <td>SELECT count(1)from sku_data_all_16 where store_id = '${storeId}' and product_sku= '${productSku}' and toDate(orders_create_time) between '2021-05-05' and '2021-08-05';</td> <td>90</td> <td>200/sec</td> <td>433ms</td> <td>​</td> <td></td></tr> <tr><td>Linux</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>一亿表365天单个sku查询</td> <td>sku_data_all_16</td> <td>10000W</td> <td>SELECT count(1)from sku_data_all_16 where store_id = '${storeId}' and product_sku= '${productSku}' and toDate(orders_create_time) between '2020-08-05' and '2021-08-05';</td> <td>90</td> <td>90/sec</td> <td>436ms</td> <td>​</td> <td></td></tr> <tr><td>Linux</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>一亿表30天单个sku去重订单查询</td> <td>sku_data_all_16</td> <td>10000W</td> <td>SELECT count(distinct order_seq)from sku_data_all_16 where store_id = '${storeId}' and product_sku= '${productSku}' and toDate(orders_create_time) between '2021-07-01' and '2021-07-31';</td> <td>90</td> <td>458/sec</td> <td>380ms</td> <td>​</td> <td></td></tr> <tr><td>Linux</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>一亿表30天单个sku去重订单查询（跨月）</td> <td>sku_data_all_16</td> <td>10000W</td> <td>SELECT count(distinct order_seq)from sku_data_all_16 where store_id = '${storeId}' and product_sku= '${productSku}' and toDate(orders_create_time) between '2021-07-05' and '2021-08-05';</td> <td>90</td> <td>350/sec</td> <td>394ms</td> <td>​</td> <td></td></tr> <tr><td>Linux</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>一亿表90天单个sku去重订单查询</td> <td>sku_data_all_16</td> <td>10000W</td> <td>SELECT count(distinct order_seq)from sku_data_all_16 where store_id = '${storeId}' and product_sku= '${productSku}' and toDate(orders_create_time) between '2021-05-05' and '2021-08-05';</td> <td>90</td> <td>210/sec</td> <td>404ms</td> <td>​</td> <td></td></tr> <tr><td>Linux</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>一亿表365天单个sku去重订单查询</td> <td>sku_data_all_16</td> <td>10000W</td> <td>SELECT count(distinct order_seq)from sku_data_all_16 where store_id = '${storeId}' and product_sku= '${productSku}' and toDate(orders_create_time) between '2020-08-05' and '2021-08-05';</td> <td>90</td> <td>90/sec</td> <td>404ms</td> <td>​</td> <td></td></tr> <tr><td>Linux</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>一亿表30天sku分组查询</td> <td>sku_data_all_16</td> <td>10000W</td> <td>SELECT count(1) as order_cnt ,product_skufrom sku_data_all_16 where store_id = '${storeId}' and toDate(orders_create_time) between '2021-07-01' and '2021-07-31' group by product_sku order by order_cnt limit 1;</td> <td>90</td> <td>74/sec</td> <td>558ms</td> <td>​</td> <td></td></tr> <tr><td>Linux</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>一亿表30天sku，store分组查询</td> <td>sku_data_all_16</td> <td>10000W</td> <td>SELECT count(1) as order_cnt ,product_skufrom sku_data_all_16 where store_id = '${storeId}' and toDate(orders_create_time) between '2021-07-01' and '2021-07-31' group by store_id,product_sku order by order_cnt limit 1;</td> <td>90</td> <td>50/sec</td> <td>656ms</td> <td>​</td> <td></td></tr> <tr><td>Linux</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>一亿表30天sku分组嵌套复合查询(查询相同订单相同sku最新一条累计算出商品订单金额)</td> <td>sku_data_all_16</td> <td>10000W</td> <td>select sum(orderAmount) as sku_amt, count(distinct order_seq) as sku_cnt from (</td> <td></td> <td></td> <td></td> <td></td> <td></td></tr></tbody></table> <p>SELECT argMax(orders_order_amount, orders_update_time) as orderAmount, product_sku, order_seq
from sku_data_all_16
where store_id = '${storeId}'
and toDate(orders_create_time) between '2021-07-01' and '2021-07-31'
group by order_seq, product_sku
)group by product_sku order by sku_amt desc limit 10; | 90 | 30/sec | 887ms | ​
| Linux |
| 一亿表30天sku分组嵌套复合查询（按照storeid分表） | sku_data_all_18 | 10000W | select sum(orderAmount) as sku_amt, count(distinct order_seq) as sku_cnt from (
SELECT argMax(orders_order_amount, orders_update_time) as orderAmount, product_sku, order_seq
from sku_data_all_16
prewhere store_id = '${storeId}'
and toDate(orders_create_time) between '2021-07-${dateNo}' and '2021-08-${dateNo}'
group by order_seq, product_sku
)  group by product_sku order by sku_amt desc limit 10; | 150 | 190/sec | 339ms |  | Linux |
| 一亿表365天sku分组嵌套复合查询（按照storeid分表） | sku_data_all_18 | 10000W | select sum(orderAmount) as sku_amt, count(distinct order_seq) as sku_cnt from (
SELECT argMax(orders_order_amount, orders_update_time) as orderAmount, product_sku, order_seq
from sku_data_all_16
prewhere store_id = '${storeId}'
and toDate(orders_create_time) between '2020-08-${dateNo}' and '2021-08-${dateNo}'
group by order_seq, product_sku
)  group by product_sku order by sku_amt desc limit 10; | 150 | 175/sec | 433ms |  | Linux |</p> <p>windows测试</p> <table><thead><tr><th>表名</th> <th>数据量</th> <th>查询语句</th> <th>线程数</th> <th>QPS</th> <th>异常率</th></tr></thead> <tbody><tr><td>sku_data_all_6</td> <td>1000W</td> <td>select count(1) as cnt from sku_data_all_6 where store_id= '${storeId}';</td> <td>20</td> <td>185.2/sec</td> <td></td></tr> <tr><td>sku_data_all_6</td> <td>1000W</td> <td>select count(1) as cnt from sku_data_all_6 where store_id= '${storeId}';</td> <td>30</td> <td>212.0/sec</td> <td></td></tr> <tr><td>sku_data_all_6</td> <td>1000W</td> <td>select count(1) as cnt from sku_data_all_6 where store_id= '${storeId}';</td> <td>50</td> <td>241.7/sec</td> <td></td></tr> <tr><td>sku_data_all_6</td> <td>1000W</td> <td>select count(1) as cnt from sku_data_all_6 where store_id= '${storeId}';</td> <td>90</td> <td>266.2/sec</td> <td></td></tr> <tr><td>sku_data_all_6</td> <td>1000W</td> <td>select count(1) as cnt from sku_data_all_6 where store_id= '${storeId}';</td> <td>100</td> <td>267.5/sec</td> <td>0.12%</td></tr> <tr><td>sku_data_all_7</td> <td>2000W</td> <td>select count(1) as cnt from sku_data_all_7 where store_id= '${storeId}';</td> <td>90</td> <td>199.4/sec</td> <td></td></tr> <tr><td>sku_data_all_7</td> <td>2000W</td> <td>select count(1) as cnt from sku_data_all_7 where store_id= '${storeId}';</td> <td>100</td> <td>226.1/sec</td> <td></td></tr> <tr><td>sku_data_all_8</td> <td>5000W</td> <td>select count(1) as cnt from sku_data_all_8 where store_id= '${storeId}';</td> <td>100</td> <td>181.6/sec</td> <td></td></tr> <tr><td>sku_data_all_8</td> <td>5000W</td> <td>SELECT count(1)from sku_data_all_8 where store_id = '${storeId}' and orders_create_time &gt;= '2021-07-31' and orders_create_time &lt; '2021-08-01' ;</td> <td>90</td> <td>469.3/sec</td> <td></td></tr> <tr><td>sku_data_all_8</td> <td>5000W</td> <td>SELECT count(1)from sku_data_all_8 where store_id = '${storeId}' and orders_create_time &gt;= '2021-07-25' and orders_create_time &lt; '2021-08-01' ;</td> <td>90</td> <td>382.5/sec</td> <td></td></tr> <tr><td>sku_data_all_8</td> <td>5000w</td> <td>SELECT count(1)from sku_data_all_8 where store_id = '${storeId}' and orders_create_time &gt;= '2021-07-01' and orders_create_time &lt; '2021-08-01' ;</td> <td>90</td> <td>174.0/sec</td> <td></td></tr> <tr><td>sku_data_all_8</td> <td>5000w</td> <td>select count(distinct product_sku) as cnt from sku_data_all_8 where store_id= '${storeId}';</td> <td>100</td> <td>171.0/sec</td> <td></td></tr> <tr><td>sku_data_all_8</td> <td>5000w</td> <td>select max(orders_create_time) as max_orders_create_time from sku_data_all_8 where store_id= '1623375144547' group by product_sku limit 1;</td> <td>90</td> <td>247.4/sec</td> <td></td></tr> <tr><td>sku_data_all_8</td> <td>5000w</td> <td>SELECT count(1)from sku_data_all_8 prewhere store_id = '1610017174927' and product_sku ='10226394' and version = '79577846';</td> <td>90</td> <td>178.0/sec</td> <td></td></tr> <tr><td>sku_data_all_8</td> <td>5000w</td> <td>SELECT order_seq from sku_data_all_8 prewhere store_id = '1610017174927' and product_sku ='10226394' and version = '79577846' and orders_create_time&gt;= '2021-07-13' and orders_create_time &lt; '2021-07-14';</td> <td>90</td> <td>463.5/sec</td> <td></td></tr> <tr><td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr></tbody></table> <h1 id="样本数据内容"><a href="#样本数据内容" class="header-anchor">#</a> 样本数据内容</h1> <p>表结构</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> sl_data_center<span class="token punctuation">.</span>sku_data_local_9 <span class="token keyword">on</span> cluster cluster_01
<span class="token punctuation">(</span>
    <span class="token punctuation">`</span>app_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>order_seq<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>product_sku<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>product_seq<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>version<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>product_price<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>barcode<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>images<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>video<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>title<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>volume<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>weight<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>weight_unit<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>attributes<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>product_num<span class="token punctuation">`</span> Int16<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>use_price<span class="token punctuation">`</span> Int8<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>seller_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>store_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>payment_info<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>promotion_info<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>express_info<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>ext_info<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>create_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>update_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>valid<span class="token punctuation">`</span> Int8<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>origin_price<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>item_no<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_item_ts<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_app_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_app_scene<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_order_type<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_order_seq<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_app_order_seq<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_main_order_seq<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_order_status<span class="token punctuation">`</span> Int32<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_app_order_status<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_order_amount<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_pay_amount<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_order_price<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_express_amount<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_discount_amount<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_discount_amount_ext<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_buyer_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_buyer_code<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_buyer_nick<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_buyer_info<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_seller_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_seller_code<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_seller_nick<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_seller_info<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_store_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_store_area<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_create_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_cancel_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_cancel_by<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_pay_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_send_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_sign_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_est_auto_translate_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_est_auto_sign_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_after_sale_end_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_finish_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_update_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_trans_currency<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_language<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_reason_msg<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_refund_max_amount<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_pay_type<span class="token punctuation">`</span> Int32<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_after_sale_type<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_buyer_remark<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_seller_remark<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_settle_duration<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_auto_sign_duration<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_after_sale_duration<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_delivery_type<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_delivery_info<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_unique_key<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_country_code<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_province_code<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_province<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_city_code<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_city<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_area_code<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_area<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_name<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_first_name<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_certificates_type<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_certificates_no<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_mobile<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_address<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_address_add<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_postcode<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_ext_info<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_create_by<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_update_by<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_valid<span class="token punctuation">`</span> Int8<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_pay_status<span class="token punctuation">`</span> Int32<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_delivery_status<span class="token punctuation">`</span> Int32<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_order_from<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_over_time_cancel_duration<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_address_source<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_tax_num<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_store_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_store_name<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_store_code<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_receiver_country<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_hide_mark<span class="token punctuation">`</span> Int8<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_return_goods_flag<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>orders_ts<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_app_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_app_scene<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_seq<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_app_main_order_seq<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_split_type<span class="token punctuation">`</span> Int8<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_order_type<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_from<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_status<span class="token punctuation">`</span> Int32<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_app_main_order_status<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_amount<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_price<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_buyer_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_buyer_code<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_buyer_nick<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_buyer_info<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_client_info<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_trans_currency<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_language<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_rounding_mode<span class="token punctuation">`</span> Int8<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_pay_type<span class="token punctuation">`</span> Int32<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_already_pay_amount<span class="token punctuation">`</span> Int64<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_create_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_cancel_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_cancel_by<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_pay_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_update_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_sub_order_seqs<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_ext_info<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_create_by<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_update_by<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_valid<span class="token punctuation">`</span> Int8<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_store_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_metadata<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_session_id<span class="token punctuation">`</span> String<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_session_create_time<span class="token punctuation">`</span> DateTime64<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Europe/Moscow'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_hide_mark<span class="token punctuation">`</span> Int8<span class="token punctuation">,</span>
    <span class="token punctuation">`</span>main_order_ts<span class="token punctuation">`</span> Int64
<span class="token punctuation">)</span>
<span class="token keyword">ENGINE</span> <span class="token operator">=</span> ReplicatedMergeTree<span class="token punctuation">(</span><span class="token string">'/clickhouse/tables/{layer}-{shard}/sl_data_center_sku_data_9'</span><span class="token punctuation">,</span> <span class="token string">'{replica}'</span><span class="token punctuation">)</span>
<span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span>
<span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>store_id<span class="token punctuation">,</span>product_sku<span class="token punctuation">,</span>version<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> sl_data_center<span class="token punctuation">.</span>sku_data_all_9 <span class="token keyword">ON</span> CLUSTER cluster_01 <span class="token keyword">AS</span> sl_data_center<span class="token punctuation">.</span>sku_data_local_9
<span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">Distributed</span><span class="token punctuation">(</span>cluster_01<span class="token punctuation">,</span> sl_data_center<span class="token punctuation">,</span> sku_data_local_9<span class="token punctuation">,</span> rand<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code> String<span class="token punctuation">[</span><span class="token punctuation">]</span> storeIds <span class="token operator">=</span> {<span class="token string">&quot;1624243911457&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;189&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1610960816048&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1617182131582&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1619441538053&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1615623722666&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1623375144547&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1619142595804&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1610017174927&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1606807455448&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1617698470493&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1617360990730&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1612750032869&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1616739234682&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1619441538060&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1622549990432&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1615879134392&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;219&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1000020&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1626419062125&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1620719244112&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1607670909953&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;SL1001_SUBSCRIPTION&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1615024273244&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1615623722671&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1626421093392&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1619605883188&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1611129156265&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1618210764532&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1623137617321&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1624345481841&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1624086550963&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1626338981776&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1621850400780&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1621071870435&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1620302509225&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1616658704276&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1612282766043&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1615540242447&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1624243911457&quot;</span>}<span class="token punctuation">;</span>
</code></pre></div><h1 id="单表qps查询"><a href="#单表qps查询" class="header-anchor">#</a> 单表QPS查询</h1> <p>1000w表sku_data_all_6</p> <div class="language-sql extra-class"><pre class="language-sql"><code> <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cnt <span class="token keyword">from</span> sku_data_all_6 <span class="token keyword">where</span> store_id  <span class="token operator">=</span> <span class="token string">'${storeId}'</span><span class="token punctuation">;</span>
</code></pre></div><p>10线程, 跑5分钟：
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627974694830-364cd3b1-5c1a-4bc7-b328-d5805c5e358b.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;height=351&amp;id=u1b3d051d&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=351&amp;originWidth=709&amp;originalType=binary&amp;ratio=1&amp;size=15928&amp;status=done&amp;style=none&amp;taskId=u9e2fde0b-2e36-4c94-8a4a-e791c7d3462&amp;width=709" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627977945723-01146059-67e7-49e5-9d4f-b5410a5c7183.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=u2680ccdd&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=402&amp;originWidth=1124&amp;originalType=binary&amp;ratio=1&amp;size=38323&amp;status=done&amp;style=none&amp;taskId=uf13f1fca-1517-48ea-8a12-5fa8ee3eb79" alt="image.png">
20线程， 5分钟：
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627978044406-bc4de89d-7444-4882-89c2-018d31f9f87e.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=ue1439173&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=434&amp;originWidth=1121&amp;originalType=binary&amp;ratio=1&amp;size=23113&amp;status=done&amp;style=none&amp;taskId=u683dc55c-4c56-4164-86f0-7ffbd95fa6e" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627978410402-14e05c8d-29a3-46da-8d9c-3199adfa3b0e.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=uae9b80e5&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=416&amp;originWidth=1166&amp;originalType=binary&amp;ratio=1&amp;size=40906&amp;status=done&amp;style=none&amp;taskId=u4caa4989-0b9c-41a8-ad20-18599db3fb7" alt="image.png">
30线程， 5分钟：
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627978514806-6dc8e10f-3c96-46b1-b31b-b1791747800d.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=u8f5f5444&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=557&amp;originWidth=1117&amp;originalType=binary&amp;ratio=1&amp;size=27359&amp;status=done&amp;style=none&amp;taskId=u10d56367-eb33-4090-891b-e22d83fc0b3" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627978771288-e8c6d326-bae6-4482-9a71-c020943f19bc.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=ufa52c527&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=323&amp;originWidth=1156&amp;originalType=binary&amp;ratio=1&amp;size=32284&amp;status=done&amp;style=none&amp;taskId=u867eed42-d75d-4db7-a0b7-aec25c9f5a0" alt="image.png">
40线程，16分钟
​</p> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627980414626-5a18d102-9585-4b96-baba-cddf97f0c4b8.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=uf0159eab&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=349&amp;originWidth=931&amp;originalType=binary&amp;ratio=1&amp;size=17695&amp;status=done&amp;style=none&amp;taskId=u08a71d2f-1f7b-43ba-8e4f-27af2b58508" alt="image.png"><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627980392104-b30d2f9b-1b79-4e3d-9583-681b1c5fb95b.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=u079ca4f8&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=372&amp;originWidth=1184&amp;originalType=binary&amp;ratio=1&amp;size=39372&amp;status=done&amp;style=none&amp;taskId=uae96bd0d-f706-41ee-a4c3-45c47574f49" alt="image.png">
50线程，5分钟
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627981815627-5c4c3d68-2c3a-45e3-afb5-185459d72185.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;height=205&amp;id=u442afd94&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=410&amp;originWidth=1266&amp;originalType=binary&amp;ratio=1&amp;size=46174&amp;status=done&amp;style=none&amp;taskId=u40fe74f6-a0ff-4489-8dff-48b77253a9d&amp;width=633" alt="image.png">
70线程.5分钟
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627983808773-a21be7bd-6bab-482b-a021-c570781951b9.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;height=158&amp;id=u6529efbf&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=316&amp;originWidth=1211&amp;originalType=binary&amp;ratio=1&amp;size=26909&amp;status=done&amp;style=none&amp;taskId=uffc791ca-58c7-48b3-bb25-bc509f6ffb6&amp;width=605.5" alt="image.png">
80线程7分钟
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627984366507-0001bf2f-f901-4084-b355-6087861540dd.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;height=216&amp;id=ub094600d&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=432&amp;originWidth=1155&amp;originalType=binary&amp;ratio=1&amp;size=42024&amp;status=done&amp;style=none&amp;taskId=uc5f61061-d80f-4779-85c6-77c654a6747&amp;width=577.5" alt="image.png">
90线程。8分钟
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627985014487-020c5400-c84d-4646-92b5-e2ecb37d0989.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;height=185&amp;id=u0896cf29&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=370&amp;originWidth=1180&amp;originalType=binary&amp;ratio=1&amp;size=28439&amp;status=done&amp;style=none&amp;taskId=u918196f5-3241-4d95-b8e8-5fb141f6f27&amp;width=590" alt="image.png"></p> <p>100线程，8分钟，16分钟
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627985642688-5adab0b5-1397-4278-af4a-f64455d2edf9.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;height=221&amp;id=u2ab6512e&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=441&amp;originWidth=1149&amp;originalType=binary&amp;ratio=1&amp;size=41707&amp;status=done&amp;style=none&amp;taskId=ue9af7242-b7e6-4e2d-bfe7-bcef0b81107&amp;width=574.5" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627982884367-64eb75b8-cd8f-4739-a632-da579c0acc0d.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;height=199&amp;id=u9135a435&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=397&amp;originWidth=1196&amp;originalType=binary&amp;ratio=1&amp;size=33650&amp;status=done&amp;style=none&amp;taskId=ud8516821-32e5-4108-b225-cc69f64e868&amp;width=598" alt="image.png">
90线程 （300max）
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627999637101-4f142364-91de-40d9-84c4-50c9d684e867.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=uc6818ae9&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=297&amp;originWidth=1131&amp;originalType=binary&amp;ratio=1&amp;size=23375&amp;status=done&amp;style=none&amp;taskId=ub10c3cae-410b-4213-b2e3-08f7bce8b75" alt="image.png">
100线程（300max）
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627999205106-525b09a6-241c-4304-825c-fc931b653c11.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=uacece2ca&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=298&amp;originWidth=1137&amp;originalType=binary&amp;ratio=1&amp;size=22917&amp;status=done&amp;style=none&amp;taskId=u5d23773f-66c9-4b5c-9879-13811db48f9" alt="image.png"></p> <p>基本最大吞吐量 =260 q/s</p> <h1 id="各个阶梯数据量最大qps"><a href="#各个阶梯数据量最大qps" class="header-anchor">#</a> 各个阶梯数据量最大QPS</h1> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627907476646-c1c350fb-ef90-49fe-9b47-aec2847956cb.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;height=219&amp;id=ubf30bca8&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=437&amp;originWidth=615&amp;originalType=binary&amp;ratio=1&amp;size=17637&amp;status=done&amp;style=none&amp;taskId=u0579dea1-28cc-4fa4-9258-ae1e646ab2c&amp;width=307.5" alt="image.png">
1000w表查询</p> <div class="language-sql extra-class"><pre class="language-sql"><code> <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cnt <span class="token keyword">from</span> sku_data_all_6 <span class="token keyword">where</span> store_id  <span class="token operator">=</span> <span class="token string">'${storeId}'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627985014487-020c5400-c84d-4646-92b5-e2ecb37d0989.png#from=url&amp;id=GXkaY&amp;margin=%5Bobject%20Object%5D&amp;originHeight=370&amp;originWidth=1180&amp;originalType=binary&amp;ratio=1&amp;status=done&amp;style=none" alt="">
2000w表查询</p> <div class="language-sql extra-class"><pre class="language-sql"><code> <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cnt <span class="token keyword">from</span> sku_data_all_7 <span class="token keyword">where</span> store_id  <span class="token operator">=</span> <span class="token string">'${storeId}'</span><span class="token punctuation">;</span>
</code></pre></div><p>90线程：
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627986436264-eb86714b-4cf7-470c-9e16-a54452f0eb59.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=u183ce5fc&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=342&amp;originWidth=1109&amp;originalType=binary&amp;ratio=1&amp;size=24220&amp;status=done&amp;style=none&amp;taskId=ud8c4b3cb-7c03-4a51-a937-4f8a0d9504f" alt="image.png">
100线程
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627990383771-1d8fb21e-7965-49fb-b9df-e0cbc529feb8.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=u7782ff11&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=320&amp;originWidth=1154&amp;originalType=binary&amp;ratio=1&amp;size=35012&amp;status=done&amp;style=none&amp;taskId=u03b513a7-73fe-4208-aede-056df200509" alt="image.png">
最大为200qps</p> <p>5000w表查询</p> <div class="language-sql extra-class"><pre class="language-sql"><code> <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cnt <span class="token keyword">from</span> sku_data_all_8 <span class="token keyword">where</span> store_id  <span class="token operator">=</span> <span class="token string">'${storeId}'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628216851478-44c30b80-b2f0-4d6b-a5fa-349a24dd45f5.png#clientId=uc997bff0-2bf9-4&amp;from=paste&amp;id=u791e4a7c&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=473&amp;originWidth=1084&amp;originalType=binary&amp;ratio=1&amp;size=38130&amp;status=done&amp;style=none&amp;taskId=ue2d69b86-86cf-454c-bd8d-45987bea897" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628165977955-b824fb0a-185a-4972-93ff-6be118dec2b0.png#clientId=uc997bff0-2bf9-4&amp;from=paste&amp;id=u3e6515f0&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=415&amp;originWidth=1122&amp;originalType=binary&amp;ratio=1&amp;size=86959&amp;status=done&amp;style=none&amp;taskId=u90df4d78-9c4c-44f2-a7c1-4198fd15578" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628166110858-60f01d24-354c-47b3-b962-7092b6638de2.png#clientId=uc997bff0-2bf9-4&amp;from=paste&amp;height=125&amp;id=u1d65b979&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=250&amp;originWidth=1935&amp;originalType=binary&amp;ratio=1&amp;size=60299&amp;status=done&amp;style=none&amp;taskId=u7adfec27-9ce4-4b4f-8717-ff8f724bc78&amp;width=967.5" alt="image.png">
1亿表查询</p> <div class="language-sql extra-class"><pre class="language-sql"><code> <span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cnt <span class="token keyword">from</span> sku_data_all_9 <span class="token keyword">where</span> store_id  <span class="token operator">=</span> <span class="token string">'${storeId}'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628218665259-c564573f-9aa6-4010-93d2-100bfdea4c79.png#clientId=uc997bff0-2bf9-4&amp;from=paste&amp;id=ua76c0c85&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=365&amp;originWidth=1140&amp;originalType=binary&amp;ratio=1&amp;size=37673&amp;status=done&amp;style=none&amp;taskId=u5b8f9a87-aae4-4986-ad15-9e80c695e58" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628218774877-f1477a89-46e9-4a6a-b9a2-5d43275e26cb.png#clientId=uc997bff0-2bf9-4&amp;from=paste&amp;id=u2ad4569e&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=372&amp;originWidth=1123&amp;originalType=binary&amp;ratio=1&amp;size=88815&amp;status=done&amp;style=none&amp;taskId=u4ce6ded4-f576-4cb4-a8ea-9cb5a653851" alt="image.png"></p> <h1 id="数据时间跨度qps"><a href="#数据时间跨度qps" class="header-anchor">#</a> 数据时间跨度QPS</h1> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token keyword">from</span> sku_data_all_8 <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span> <span class="token operator">and</span> orders_create_time <span class="token operator">&gt;=</span> <span class="token string">'2021-07-31'</span> <span class="token operator">and</span> orders_create_time <span class="token operator">&lt;</span> <span class="token string">'2021-08-01'</span> <span class="token punctuation">;</span>
</code></pre></div><p>5000W表
一天数据
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627993447079-805cb5bb-a4e1-4d5b-b992-b1d12523727d.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=u7f1fe120&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=388&amp;originWidth=1127&amp;originalType=binary&amp;ratio=1&amp;size=38587&amp;status=done&amp;style=none&amp;taskId=u1aeaee13-f363-4a49-ab1d-68a68695641" alt="image.png">
(linux)
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628172424447-5cd891d5-e320-41d5-95fd-a0c71f2a6ff4.png#clientId=uc997bff0-2bf9-4&amp;from=paste&amp;id=ube2025b1&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=429&amp;originWidth=1139&amp;originalType=binary&amp;ratio=1&amp;size=91209&amp;status=done&amp;style=none&amp;taskId=ufa451e62-b9fc-4251-bf10-4e3b4b730be" alt="image.png">
​</p> <p>七天数据</p> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628063591029-14ca9d86-67b3-49c2-b82b-4716158412bc.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=uac875ac3&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=410&amp;originWidth=1143&amp;originalType=binary&amp;ratio=1&amp;size=40172&amp;status=done&amp;style=none&amp;taskId=u68e3468c-aacd-4378-8523-b4bf3b911bf" alt="image.png"></p> <p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627994970743-099b6ffb-1c52-4261-aa4d-247e1d397b5a.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;height=188&amp;id=u9abced4d&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=375&amp;originWidth=1132&amp;originalType=binary&amp;ratio=1&amp;size=38593&amp;status=done&amp;style=none&amp;taskId=u8186f41a-ebe0-43bd-9b3a-03cd0ff9fd2&amp;width=566" alt="image.png">
30天数据
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628079781182-748cbf98-d843-4f04-9e31-9a7e09aa0473.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=ua8568e17&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=319&amp;originWidth=1143&amp;originalType=binary&amp;ratio=1&amp;size=27885&amp;status=done&amp;style=none&amp;taskId=u929dcbc1-9b09-45de-a42e-0f8527dc495" alt="image.png"></p> <h2 id="一亿表"><a href="#一亿表" class="header-anchor">#</a> 一亿表：</h2> <p>30天
不跨月</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token keyword">from</span> sku_data_all_16 <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span> <span class="token operator">and</span> product_sku  <span class="token operator">=</span> <span class="token string">'${productSku}'</span> <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2021-07-01'</span> <span class="token operator">and</span> <span class="token string">'2021-07-31'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628251937138-918778ab-06b3-419f-857c-dfeb9c25225d.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=348&amp;id=u63df51fa&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=348&amp;originWidth=1156&amp;originalType=binary&amp;ratio=1&amp;size=37727&amp;status=done&amp;style=none&amp;taskId=ua24c54b7-84cb-4060-a894-3ae5a37fed8&amp;width=1156" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628252438751-64912847-8267-4614-9741-4cf9fec1167e.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=464&amp;id=u3104c9c8&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=464&amp;originWidth=1192&amp;originalType=binary&amp;ratio=1&amp;size=94561&amp;status=done&amp;style=none&amp;taskId=u5c283aca-4c4c-4051-9172-b4f11bc9a80&amp;width=1192" alt="image.png">
跨月</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token keyword">from</span> sku_data_all_16 <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span> <span class="token operator">and</span> product_sku  <span class="token operator">=</span> <span class="token string">'${productSku}'</span> <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2021-07-05'</span> <span class="token operator">and</span> <span class="token string">'2021-08-05'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628474474058-d0e10e66-6e7a-48f0-acde-4032eedefb08.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=439&amp;id=ub44c6a64&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=439&amp;originWidth=1177&amp;originalType=binary&amp;ratio=1&amp;size=88888&amp;status=done&amp;style=none&amp;taskId=uc341b9ba-eaaa-45fd-a77b-3be37abb45a&amp;width=1177" alt="image.png">
90天</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token keyword">from</span> sku_data_all_16 <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span> <span class="token operator">and</span> product_sku  <span class="token operator">=</span> <span class="token string">'${productSku}'</span> <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2021-05-05'</span> <span class="token operator">and</span> <span class="token string">'2021-08-05'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628476672867-c2bc734a-f0d6-4c7e-9594-7617448202dc.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=878&amp;id=u79fb110b&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=878&amp;originWidth=1171&amp;originalType=binary&amp;ratio=1&amp;size=189647&amp;status=done&amp;style=none&amp;taskId=u437a5df8-6716-45c2-bde0-da9e17e0c8c&amp;width=1171" alt="image.png">
一年</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token keyword">from</span> sku_data_all_16 <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span> <span class="token operator">and</span> product_sku  <span class="token operator">=</span> <span class="token string">'${productSku}'</span> <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2020-08-05'</span> <span class="token operator">and</span> <span class="token string">'2021-08-05'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628477494742-119e2312-d99e-46fc-8f0d-2316a6ff1dfa.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=657&amp;id=u5cc25741&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=657&amp;originWidth=1198&amp;originalType=binary&amp;ratio=1&amp;size=139935&amp;status=done&amp;style=none&amp;taskId=u1c67a963-3da3-4037-b855-f05fcb9e043&amp;width=1198" alt="image.png"></p> <h1 id="去重查询qps"><a href="#去重查询qps" class="header-anchor">#</a> 去重查询QPS</h1> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> order_seq<span class="token punctuation">)</span>  <span class="token keyword">from</span> sku_data_all_16 <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span> <span class="token operator">and</span> product_sku  <span class="token operator">=</span> <span class="token string">'${productSku}'</span> <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2021-07-01'</span> <span class="token operator">and</span> <span class="token string">'2021-07-31'</span><span class="token punctuation">;</span>
</code></pre></div><p>一亿表：
不跨月
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628478360637-71b07ad3-a587-4147-a653-a5966b36a57d.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=430&amp;id=u6e4b93e2&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=430&amp;originWidth=1177&amp;originalType=binary&amp;ratio=1&amp;size=92366&amp;status=done&amp;style=none&amp;taskId=u4fdd97be-4a8b-419e-9abc-cdf9b7afcab&amp;width=1177" alt="image.png">
跨月：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> order_seq<span class="token punctuation">)</span>  <span class="token keyword">from</span> sku_data_all_16 <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span> <span class="token operator">and</span> product_sku  <span class="token operator">=</span> <span class="token string">'${productSku}'</span> <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2021-07-05'</span> <span class="token operator">and</span> <span class="token string">'2021-08-05'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628478995650-3a5afd4d-85db-4e21-a462-42b81be30bb8.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=428&amp;id=ua76d9f10&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=428&amp;originWidth=1194&amp;originalType=binary&amp;ratio=1&amp;size=92529&amp;status=done&amp;style=none&amp;taskId=udc06bf72-1bdb-4983-82cd-c9a6f94312f&amp;width=1194" alt="image.png">
90天</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> order_seq<span class="token punctuation">)</span>  <span class="token keyword">from</span> sku_data_all_16 <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span> <span class="token operator">and</span> product_sku  <span class="token operator">=</span> <span class="token string">'${productSku}'</span> <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2021-05-05'</span> <span class="token operator">and</span> <span class="token string">'2021-08-05'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628479575517-50172ded-c128-436f-bb06-297b7116c6e9.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=446&amp;id=ub8946898&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=446&amp;originWidth=1171&amp;originalType=binary&amp;ratio=1&amp;size=92405&amp;status=done&amp;style=none&amp;taskId=ud3c32bfd-fb5b-4fc4-b00a-c3c870a36d2&amp;width=1171" alt="image.png">
一年</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> order_seq<span class="token punctuation">)</span>  <span class="token keyword">from</span> sku_data_all_16 <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span> <span class="token operator">and</span> product_sku  <span class="token operator">=</span> <span class="token string">'${productSku}'</span> <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2020-08-05'</span> <span class="token operator">and</span> <span class="token string">'2021-08-05'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628480554291-a26074ff-f08b-45e3-b054-c5b862841dc6.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=777&amp;id=u91aee99a&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=777&amp;originWidth=1120&amp;originalType=binary&amp;ratio=1&amp;size=163446&amp;status=done&amp;style=none&amp;taskId=u33b688f5-6320-4a5d-9462-8a5e66772c7&amp;width=1120" alt="image.png"></p> <h1 id="分组查询qps"><a href="#分组查询qps" class="header-anchor">#</a> 分组查询QPS</h1> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> order_cnt <span class="token punctuation">,</span>product_sku  <span class="token keyword">from</span> sku_data_all_16 <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span> <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2021-07-01'</span> <span class="token operator">and</span> <span class="token string">'2021-07-31'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> product_sku <span class="token keyword">order</span> <span class="token keyword">by</span> order_cnt <span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p>5000W表(300 max)
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1627998168832-dbee35ea-04f9-47ee-84ba-9626c8c0f551.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=u987aecff&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=323&amp;originWidth=1143&amp;originalType=binary&amp;ratio=1&amp;size=24304&amp;status=done&amp;style=none&amp;taskId=ubc425c96-a4d6-4fe1-a1a7-65c73b24714" alt="image.png">
一亿表：
30天:
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628488749266-98483ec7-9f3c-4b19-98dd-01041fb537f4.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=551&amp;id=u1d761d7f&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=551&amp;originWidth=1311&amp;originalType=binary&amp;ratio=1&amp;size=122777&amp;status=done&amp;style=none&amp;taskId=u71e5c133-664c-421c-8137-8052b554829&amp;width=1311" alt="image.png"> <img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628489818474-0fc9263d-d08b-4902-920d-7e6c7cc8717c.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=418&amp;id=ueb7f1e7a&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=418&amp;originWidth=1174&amp;originalType=binary&amp;ratio=1&amp;size=88414&amp;status=done&amp;style=none&amp;taskId=u8789618e-3068-4aab-b505-637ff2842f6&amp;width=1174" alt="image.png"></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">as</span> order_cnt <span class="token punctuation">,</span>product_sku  <span class="token keyword">from</span> sku_data_all_16 <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span> <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2021-07-01'</span> <span class="token operator">and</span> <span class="token string">'2021-07-31'</span> <span class="token keyword">group</span> <span class="token keyword">by</span> store_id<span class="token punctuation">,</span>product_sku <span class="token keyword">order</span> <span class="token keyword">by</span> order_cnt <span class="token keyword">limit</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628491338717-eced5cde-ece0-425d-a5d0-e5794215c7f7.png#clientId=u880f65a2-ddc2-4&amp;from=paste&amp;height=608&amp;id=ud1e5734b&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=608&amp;originWidth=1170&amp;originalType=binary&amp;ratio=1&amp;size=132654&amp;status=done&amp;style=none&amp;taskId=u8f56def7-48a4-4195-9cb7-7a67eee3889&amp;width=1170" alt="image.png">
分组嵌套查询</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>orderAmount<span class="token punctuation">)</span> <span class="token keyword">as</span> sku_amt<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> order_seq<span class="token punctuation">)</span> <span class="token keyword">as</span> sku_cnt <span class="token keyword">from</span> <span class="token punctuation">(</span>
                   <span class="token keyword">SELECT</span> argMax<span class="token punctuation">(</span>orders_order_amount<span class="token punctuation">,</span> orders_update_time<span class="token punctuation">)</span> <span class="token keyword">as</span> orderAmount<span class="token punctuation">,</span> product_sku<span class="token punctuation">,</span> order_seq
                   <span class="token keyword">from</span> sku_data_all_16
                   <span class="token keyword">where</span> store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span>
                     <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2021-07-01'</span> <span class="token operator">and</span> <span class="token string">'2021-07-31'</span>
                   <span class="token keyword">group</span> <span class="token keyword">by</span> order_seq<span class="token punctuation">,</span> product_sku
<span class="token punctuation">)</span>  <span class="token keyword">group</span> <span class="token keyword">by</span> product_sku <span class="token keyword">order</span> <span class="token keyword">by</span> sku_amt <span class="token keyword">desc</span> <span class="token keyword">limit</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628500899536-091d5e25-55c8-4296-ad2c-7cdc19618160.png#clientId=uc086d07e-616b-4&amp;from=paste&amp;height=375&amp;id=ud66fdf84&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=375&amp;originWidth=1186&amp;originalType=binary&amp;ratio=1&amp;size=81440&amp;status=done&amp;style=none&amp;taskId=u1404d539-f5ac-49bd-b942-089a2b32bad&amp;width=1186" alt="image.png">​
跨月查询</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">sum</span><span class="token punctuation">(</span>orderAmount<span class="token punctuation">)</span> <span class="token keyword">as</span> sku_amt<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token keyword">distinct</span> order_seq<span class="token punctuation">)</span> <span class="token keyword">as</span> sku_cnt <span class="token keyword">from</span> <span class="token punctuation">(</span>
                   <span class="token keyword">SELECT</span> argMax<span class="token punctuation">(</span>orders_order_amount<span class="token punctuation">,</span> orders_update_time<span class="token punctuation">)</span> <span class="token keyword">as</span> orderAmount<span class="token punctuation">,</span> product_sku<span class="token punctuation">,</span> order_seq
                   <span class="token keyword">from</span> sku_data_all_16
                   prewhere store_id <span class="token operator">=</span> <span class="token string">'${storeId}'</span>
                     <span class="token operator">and</span> toDate<span class="token punctuation">(</span>orders_create_time<span class="token punctuation">)</span> <span class="token operator">between</span> <span class="token string">'2021-07-${dateNo}'</span> <span class="token operator">and</span> <span class="token string">'2021-08-${dateNo}'</span>
                   <span class="token keyword">group</span> <span class="token keyword">by</span> order_seq<span class="token punctuation">,</span> product_sku
<span class="token punctuation">)</span>  <span class="token keyword">group</span> <span class="token keyword">by</span> product_sku <span class="token keyword">order</span> <span class="token keyword">by</span> sku_amt <span class="token keyword">desc</span> <span class="token keyword">limit</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628516868416-806f0f88-7f64-4026-b8e2-d60a8d1f489d.png#clientId=uaac5496c-4f72-4&amp;from=paste&amp;height=681&amp;id=uad9722ae&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=681&amp;originWidth=1192&amp;originalType=binary&amp;ratio=1&amp;size=148362&amp;status=done&amp;style=none&amp;taskId=ubcb09235-0900-4862-ad4a-f6a7aae0a4b&amp;width=1192" alt="image.png"></p> <h1 id="主键查询qps"><a href="#主键查询qps" class="header-anchor">#</a> 主键查询QPS</h1> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token keyword">from</span> sku_data_all_8 prewhere store_id <span class="token operator">=</span> <span class="token string">'1610017174927'</span> <span class="token operator">and</span> product_sku <span class="token operator">=</span><span class="token string">'10226394'</span> <span class="token operator">and</span> version <span class="token operator">=</span> <span class="token string">'79577846'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628072190012-6c7fb782-fa64-4173-88ba-628cd38fdad4.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=ud945bfdc&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=355&amp;originWidth=1123&amp;originalType=binary&amp;ratio=1&amp;size=36921&amp;status=done&amp;style=none&amp;taskId=ufaf92309-52a9-499a-931c-9d79f050ae9" alt="image.png">
加上对应时间</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> order_seq <span class="token keyword">from</span> sku_data_all_8 prewhere store_id <span class="token operator">=</span> <span class="token string">'1610017174927'</span> <span class="token operator">and</span> product_sku <span class="token operator">=</span><span class="token string">'10226394'</span> <span class="token operator">and</span> version <span class="token operator">=</span> <span class="token string">'79577846'</span> <span class="token operator">and</span> orders_create_time<span class="token operator">&gt;=</span> <span class="token string">'2021-07-13'</span> <span class="token operator">and</span> orders_create_time <span class="token operator">&lt;</span> <span class="token string">'2021-07-14'</span><span class="token punctuation">;</span>
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628072795719-b005e392-36e8-4ad2-9493-58d71f027756.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;id=u7d54a539&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=407&amp;originWidth=1151&amp;originalType=binary&amp;ratio=1&amp;size=41123&amp;status=done&amp;style=none&amp;taskId=u698bd8db-a9f5-4752-8236-bcb7b51d44b" alt="image.png">
可以看出命中分区比命中索引更加重要。
稳定性测试
<img src="https://cdn.nlark.com/yuque/0/2021/png/1313196/1628128257867-84d68fca-6aa4-498b-bfd8-0eca60a29de2.png#clientId=u55a2ac33-6aa4-4&amp;from=paste&amp;height=177&amp;id=ueadeb377&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=354&amp;originWidth=1143&amp;originalType=binary&amp;ratio=1&amp;size=38285&amp;status=done&amp;style=none&amp;taskId=u9764267c-d5e8-4122-837f-8fefed0e14d&amp;width=571.5" alt="image.png">
​</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/./datahouse/实时数仓/CK+TIDB实时多维度OLAP场景应用(2).html" class="prev">
        ck机器配置
      </a></span> <span class="next"><a href="/./datahouse/实时数仓/Clickhouse查询响应测试.html">
        分区&amp;索引键
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="./assets/js/app.8f846374.js" defer></script><script src="./assets/js/2.47c06342.js" defer></script><script src="./assets/js/79.89cb870d.js" defer></script>
  </body>
</html>
